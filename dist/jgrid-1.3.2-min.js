(function(){goog.addDependency("../CheckManager.js.externs.js", [], ["jx.grid.CheckManager"]);
goog.addDependency("../Collapser.js", ["jx.grid.Collapser"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.ColumnManager", "jx.grid.CheckManager", "jx.data.DataManager", "jx.data.Tree", "jx.data.TreeNode"]);
goog.addDependency("../bootstrap.js.externs.js", [], ["jx.grid"]);
goog.addDependency("../Tracer.js", ["Tracer"], ["jx.util"]);
goog.addDependency("../bootstrap.js", ["jx.grid", "JGM"], ["jx.util", "jx.util$"]);
goog.addDependency("../SearchManager.js.externs.js", [], []);
goog.addDependency("../deps.js", [], []);
goog.addDependency("../DataManager.js", ["jx.data.DataManager"], ["jx.util", "jx.events.EventDispatcher", "jx.grid", "jx.grid.BaseModule"]);
goog.addDependency("../EditManager.js.externs.js", [], ["jx.grid.EditManager", "jx.grid.Editor", "jx.grid.Cell"]);
goog.addDependency("../PrintManager.js.externs.js", [], []);
goog.addDependency("../EventManager.js", ["jx.grid.EventManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule"]);
goog.addDependency("../ColumnGroup.js", ["jx.grid.ColumnGroup"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.ColumnManager", "jx.grid.CheckManager", "jx.grid.Collapser", "jx.data.DataManager", "jx.data.Tree", "jx.data.TreeNode"]);
goog.addDependency("../SelectionManager.js.externs.js", [], []);
goog.addDependency("../SelectionManager.js", ["jx.grid.SelectionManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.data.DataManager", "jx.grid.Cell"]);
goog.addDependency("../MenuBar.js", ["jx.grid.MenuBar"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.ColumnManager"]);
goog.addDependency("../EditManager.js", ["jx.grid.EditManager", "jx.grid.Editor"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.Cell"]);
goog.addDependency("../ViewportManager.js.externs.js", [], []);
goog.addDependency("../ColumnManager.js.externs.js", [], ["jx.grid.ColumnManager"]);
goog.addDependency("../engine_extension.js", [], []);
goog.addDependency("../ColumnManager.js", ["jx.grid.ColumnManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Column"]);
goog.addDependency("../DataManager.js.externs.js", [], []);
goog.addDependency("../TooltipManager.js", ["jx.grid.TooltipManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.data.DataManager"]);
goog.addDependency("../Footer.js", ["jx.grid.Footer"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.ColumnManager", "jx.data.DataManager"]);
goog.addDependency("../DataCreator.js.externs.js", [], ["jx.grid.DataCreator"]);
goog.addDependency("../Cell.js", ["jx.grid.Cell"], ["jx.util", "jx.grid", "jx.grid.Grid", "jx.grid.ColumnManager", "jx.data.DataManager"]);
goog.addDependency("../Grid.js.externs.js", [], []);
goog.addDependency("../Column.js.externs.js", [], ["jx.grid.Column"]);
goog.addDependency("../EventDispatcher.js.externs.js", [], []);
goog.addDependency("../PrintManager.js", ["jx.grid.PrintManager"], ["jx.util", "jx.util$", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid"]);
goog.addDependency("../ColumnHeader.js", ["jx.grid.ColumnHeader"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.ColumnManager"]);
goog.addDependency("../CheckManager.js", ["jx.grid.CheckManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.ColumnManager", "jx.data.DataManager"]);
goog.addDependency("../array_extension.js.externs.js", [], []);
goog.addDependency("../Cell.js.externs.js", [], ["jx.grid.Cell"]);
goog.addDependency("../Disposable.js.externs.js", [], []);
goog.addDependency("../Footer.js.externs.js", [], []);
goog.addDependency("../renderer.js", ["jx.grid.renderer"], ["jx.util", "jx.util$", "jx.grid"]);
goog.addDependency("../TooltipManager.js.externs.js", [], []);
goog.addDependency("../EventManager.js.externs.js", [], []);
goog.addDependency("../MenuBar.js.externs.js", [], []);
goog.addDependency("../Column.js", ["jx.grid.Column"], ["jx.grid", "jx.events.EventDispatcher"]);
goog.addDependency("../Tree.js.externs.js", [], []);
goog.addDependency("../array_extension.js", [], []);
goog.addDependency("../BaseModule.js", ["jx.grid.BaseModule"], ["jx.lang.Disposable", "jx.events.EventDispatcher", "jx.grid"]);
goog.addDependency("../Collapser.js.externs.js", [], ["jx.grid.Collapser"]);
goog.addDependency("../ViewportManager.js", ["jx.grid.ViewportManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.grid.Cell", "jx.grid.ColumnManager", "jx.data.DataManager"]);
goog.addDependency("../ColumnGroup.js.externs.js", [], ["jx.grid.ColumnGroup"]);
goog.addDependency("../util.js.externs.js", [], []);
goog.addDependency("../engine_extension.js.externs.js", [], []);
goog.addDependency("../EventDispatcher.js", ["jx.events.EventDispatcher"], ["jx.lang.Disposable"]);
goog.addDependency("../BaseModule.js.externs.js", [], ["jx.grid.BaseModule"]);
goog.addDependency("../Tracer.js.externs.js", [], []);
goog.addDependency("../utiljquery.js", ["jx.util$", "Util$"], ["jx.util"]);
goog.addDependency("../renderer.js.externs.js", [], []);
goog.addDependency("../utiljquery.js.externs.js", [], []);
goog.addDependency("../util.js", ["jx.util", "Util", "echo"], []);
goog.addDependency("../DataCreator.js", ["jx.grid.DataCreator"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid"]);
goog.addDependency("../Disposable.js", ["jx.lang.Disposable"], ["jx.util"]);
goog.addDependency("../Tree.js", ["jx.data.TreeNode", "jx.data.Tree", "TreeNode", "Tree"], ["jx.util", "jx.events.EventDispatcher"]);
goog.addDependency("../SearchManager.js", ["jx.grid.SearchManager"], ["jx.util", "jx.grid", "jx.grid.BaseModule", "jx.grid.Grid", "jx.data.DataManager"]);
goog.addDependency("../Grid.js", ["jx.grid.Grid"], ["jx.util", "jx.util$", "jx.lang.Disposable", "jx.events.EventDispatcher", "jx.grid", "jx.grid.BaseModule", "jx.grid.EventManager"]);
goog.addDependency("../ColumnHeader.js.externs.js", [], ["jx.grid.ColumnHeader"]);
goog.addDependency("base.js", [], []);
(function() {
  var nProto = Number.prototype, sProto = String.prototype, aProto = Array.prototype;
  if(!nProto.toFixedFloat) {
    nProto.toFixedFloat = function(n) {
      return parseFloat(this.toFixed(n))
    }
  }
  if(!sProto.toInt) {
    sProto.toInt = function() {
      var a;
      if((a = this.replace(/[^\d\.\-]/g, "")).length === 0) {
        return NaN
      }
      var c, dot = 0, sign = 0, len = a.length, i = 0, r = false;
      for(;i < len;i++) {
        c = a.charAt(i);
        if(c === ".") {
          if(++dot === 2) {
            r = true;
            break
          }
        }else {
          if(c === "-") {
            if(++sign === 2) {
              r = true;
              break
            }
          }
        }
      }
      if(r === true && (a = a.replace(/[\.\-]/g, "")).length === 0) {
        return NaN
      }
      if(/^-*0*\./.test(a) || (a = a.replace(/^-0+/, "-")).length === 0 || (a = a.replace(/^0+/, "")).length === 0) {
        return 0
      }
      return parseInt(a, 10)
    }
  }
  if(!sProto.toFloat) {
    sProto.toFloat = function() {
      var a;
      if((a = this.replace(/[^-\d\.]/g, "")).length === 0) {
        return NaN
      }
      var i = 0, len = a.length, ch, c = 0, d = 0;
      for(;i < len;i++) {
        ch = a.charAt(i);
        if(ch === ".") {
          if(c !== 0) {
            return NaN
          }else {
            c++
          }
        }else {
          if(ch === "-") {
            if(d !== 0) {
              return NaN
            }else {
              d++
            }
          }
        }
      }
      return parseFloat(a)
    }
  }
  if(!aProto.remove) {
    aProto.remove = function(el) {
      if(this.length === 0) {
        return-1
      }
      var index = this.indexOf(el);
      if(index !== -1) {
        this.splice(index, 1)
      }
      return index
    }
  }
  if(!aProto.removeAll) {
    aProto.removeAll = function(el) {
      if(this.length === 0) {
        return this
      }
      var index = this.length;
      while((index = this.lastIndexOf(el, index - 1)) !== -1) {
        this.splice(index, 1);
        if(index === 0) {
          return this
        }
      }
      return this
    }
  }
  if(!aProto.removeList) {
    aProto.removeList = function(array) {
      if(this.length === 0 || array.length === 0) {
        return this
      }
      var arrlen = array.length, i = 0, index;
      for(;i < arrlen;i++) {
        if((index = this.indexOf(array[i])) !== -1) {
          this.splice(index, 1)
        }
      }
      return this
    }
  }
  if(!aProto.removeAt) {
    aProto.removeAt = function(i) {
      if(this.length === 0) {
        return
      }
      if(i < 0) {
        i = this.length + i
      }
      if(i < 0) {
        i = 0
      }
      if(this.hasOwnProperty(i) && i < this.length) {
        return this.splice(i, 1)[0]
      }
    }
  }
  if(!aProto.addAt) {
    aProto.addAt = function(index, el) {
      this.splice(index, 0, el);
      return el
    }
  }
  if(!aProto.pushList) {
    aProto.pushList = function(array) {
      if(array.length === 0) {
        return this.length
      }
      return aProto.push.apply(this, array)
    }
  }
  if(!aProto.pushListAt) {
    aProto.pushListAt = function(index, array) {
      if(array.length === 0) {
        return this.length
      }
      var param = [index, 0];
      aProto.push.apply(param, array);
      aProto.splice.apply(this, param);
      return this.length
    }
  }
})();
(function() {
  var proto = Array.prototype;
  if(!proto.indexOf) {
    proto.indexOf = function(searchElement) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(len === 0) {
        return-1
      }
      var n = 0;
      if(arguments.length > 0) {
        n = Number(arguments[1]);
        if(n !== n) {
          n = 0
        }else {
          if(n !== 0 && n !== 1 / 0 && n !== -(1 / 0)) {
            n = (n > 0 || -1) * Math.floor(Math.abs(n))
          }
        }
      }
      if(n >= len) {
        return-1
      }
      var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
      for(;k < len;k++) {
        if(k in t && t[k] === searchElement) {
          return k
        }
      }
      return-1
    }
  }
  if(!proto.lastIndexOf) {
    proto.lastIndexOf = function(searchElement) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(len === 0) {
        return-1
      }
      var n = len;
      if(arguments.length > 1) {
        n = Number(arguments[1]);
        if(n !== n) {
          n = 0
        }else {
          if(n !== 0 && n !== 1 / 0 && n !== -(1 / 0)) {
            n = (n > 0 || -1) * Math.floor(Math.abs(n))
          }
        }
      }
      var k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);
      for(;k >= 0;k--) {
        if(k in t && t[k] === searchElement) {
          return k
        }
      }
      return-1
    }
  }
  if(!proto.filter) {
    proto.filter = function(fun) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(typeof fun !== "function") {
        throw new TypeError;
      }
      var res = [];
      var thisp = arguments[1];
      for(var i = 0;i < len;i++) {
        if(i in t) {
          var val = t[i];
          if(fun.call(thisp, val, i, t)) {
            res.push(val)
          }
        }
      }
      return res
    }
  }
  if(!proto.forEach) {
    proto.forEach = function(callbackfn, thisArg) {
      var T, O = Object(this), len = O.length >>> 0, k = 0;
      if(!callbackfn || !callbackfn.call) {
        throw new TypeError;
      }
      if(thisArg) {
        T = thisArg
      }
      while(k < len) {
        var Pk = String(k), kPresent = O.hasOwnProperty(Pk), kValue;
        if(kPresent) {
          kValue = O[Pk];
          callbackfn.call(T, kValue, k, O)
        }
        k++
      }
    }
  }
  if(!proto.every) {
    proto.every = function(fun) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(typeof fun !== "function") {
        throw new TypeError;
      }
      var thisp = arguments[1];
      for(var i = 0;i < len;i++) {
        if(i in t && !fun.call(thisp, t[i], i, t)) {
          return false
        }
      }
      return true
    }
  }
  if(!proto.map) {
    proto.map = function(fun) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(typeof fun !== "function") {
        throw new TypeError;
      }
      var res = new Array(len);
      var thisp = arguments[1];
      for(var i = 0;i < len;i++) {
        if(i in t) {
          res[i] = fun.call(thisp, t[i], i, t)
        }
      }
      return res
    }
  }
  if(!proto.some) {
    proto.some = function(fun) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(typeof fun !== "function") {
        throw new TypeError;
      }
      var thisp = arguments[1];
      for(var i = 0;i < len;i++) {
        if(i in t && fun.call(thisp, t[i], i, t)) {
          return true
        }
      }
      return false
    }
  }
  if(!proto.reduce) {
    proto.reduce = function reduce(accumlator) {
      var i, l = this.length, curr;
      if(typeof accumlator !== "function") {
        throw new TypeError("First argument is not callable");
      }
      if((l == 0 || l === null) && arguments.length <= 1) {
        throw new TypeError("Array length is 0 and no second argument");
      }
      if(arguments.length <= 1) {
        curr = this[0];
        i = 1
      }else {
        curr = arguments[1]
      }
      for(i = i || 0;i < l;++i) {
        if(i in this) {
          curr = accumlator.call(undefined, curr, this[i], i, this)
        }
      }
      return curr
    }
  }
  if(!proto.reduceRight) {
    proto.reduceRight = function(callbackfn) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(typeof callbackfn !== "function") {
        throw new TypeError;
      }
      if(len === 0 && arguments.length === 1) {
        throw new TypeError;
      }
      var k = len - 1;
      var accumulator;
      if(arguments.length >= 2) {
        accumulator = arguments[1]
      }else {
        do {
          if(k in this) {
            accumulator = this[k--];
            break
          }
          if(--k < 0) {
            throw new TypeError;
          }
        }while(true)
      }
      while(k >= 0) {
        if(k in t) {
          accumulator = callbackfn.call(undefined, accumulator, t[k], k, t)
        }
        k--
      }
      return accumulator
    }
  }
})();
var COMPILED = false;
var goog = goog || {};
goog.global = window;
window.goog = goog;
goog.DEBUG = true;
goog.LOCALE = "en";
goog.provide = function(name) {
  if(!COMPILED) {
    if(goog.isProvided_(name)) {
      throw Error('Namespace "' + name + '" already declared.');
    }
    delete goog.implicitNamespaces_[name];
    var namespace = name;
    while(namespace = namespace.substring(0, namespace.lastIndexOf("."))) {
      if(goog.getObjectByName(namespace)) {
        break
      }
      goog.implicitNamespaces_[namespace] = true
    }
  }
  goog.exportSymbol_(name)
};
goog.setTestOnly = function(opt_message) {
  if(COMPILED && !goog.DEBUG) {
    opt_message = opt_message || "";
    throw Error("Importing test-only code into non-debug environment" + opt_message ? ": " + opt_message : ".");
  }
};
if(!COMPILED) {
  goog.isProvided_ = function(name) {
    return!goog.implicitNamespaces_[name] && !!goog.getObjectByName(name)
  };
  goog.implicitNamespaces_ = {}
}
goog.exportSymbol_ = function(name, opt_object, opt_objectToExportTo) {
  var parts = name.split(".");
  var cur = opt_objectToExportTo || goog.global;
  if(!(parts[0] in cur) && cur.execScript) {
    cur.execScript("var " + parts[0])
  }
  for(var part;parts.length && (part = parts.shift());) {
    if(!parts.length && goog.isDef(opt_object)) {
      cur[part] = opt_object
    }else {
      if(cur[part]) {
        cur = cur[part]
      }else {
        cur = cur[part] = {}
      }
    }
  }
};
goog.getObjectByName = function(name, opt_obj) {
  var parts = name.split(".");
  var cur = opt_obj || goog.global;
  for(var part;part = parts.shift();) {
    if(goog.isDefAndNotNull(cur[part])) {
      cur = cur[part]
    }else {
      return null
    }
  }
  return cur
};
goog.globalize = function(obj, opt_global) {
  var global = opt_global || goog.global;
  for(var x in obj) {
    global[x] = obj[x]
  }
};
goog.addDependency = function(relPath, provides, requires) {
  if(!COMPILED) {
    var provide, require;
    var path = relPath.replace(/\\/g, "/");
    var deps = goog.dependencies_;
    for(var i = 0;provide = provides[i];i++) {
      deps.nameToPath[provide] = path;
      if(!(path in deps.pathToNames)) {
        deps.pathToNames[path] = {}
      }
      deps.pathToNames[path][provide] = true
    }
    for(var j = 0;require = requires[j];j++) {
      if(!(path in deps.requires)) {
        deps.requires[path] = {}
      }
      deps.requires[path][require] = true
    }
  }
};
goog.ENABLE_DEBUG_LOADER = true;
goog.require = function(name) {
  if(!COMPILED) {
    if(goog.isProvided_(name)) {
      return
    }
    if(goog.ENABLE_DEBUG_LOADER) {
      var path = goog.getPathFromDeps_(name);
      if(path) {
        goog.included_[path] = true;
        goog.writeScripts_();
        return
      }
    }
    var errorMessage = "goog.require could not find: " + name;
    if(goog.global.console) {
      goog.global.console["error"](errorMessage)
    }
    throw Error(errorMessage);
  }
};
goog.basePath = "";
goog.global.CLOSURE_BASE_PATH;
goog.global.CLOSURE_NO_DEPS;
goog.global.CLOSURE_IMPORT_SCRIPT;
goog.nullFunction = function() {
};
goog.identityFunction = function(var_args) {
  return arguments[0]
};
goog.abstractMethod = function() {
  throw Error("unimplemented abstract method");
};
goog.addSingletonGetter = function(ctor) {
  ctor.getInstance = function() {
    return ctor.instance_ || (ctor.instance_ = new ctor)
  }
};
if(!COMPILED && goog.ENABLE_DEBUG_LOADER) {
  goog.included_ = {};
  goog.dependencies_ = {pathToNames:{}, nameToPath:{}, requires:{}, visited:{}, written:{}};
  goog.inHtmlDocument_ = function() {
    var doc = goog.global.document;
    return typeof doc != "undefined" && "write" in doc
  };
  goog.findBasePath_ = function() {
    if(goog.global.CLOSURE_BASE_PATH) {
      goog.basePath = goog.global.CLOSURE_BASE_PATH;
      return
    }else {
      if(!goog.inHtmlDocument_()) {
        return
      }
    }
    var doc = goog.global.document;
    var scripts = doc.getElementsByTagName("script");
    for(var i = scripts.length - 1;i >= 0;--i) {
      var src = scripts[i].src;
      var qmark = src.lastIndexOf("?");
      var l = qmark == -1 ? src.length : qmark;
      if(src.substr(l - 7, 7) == "base.js") {
        goog.basePath = src.substr(0, l - 7);
        return
      }
    }
  };
  goog.importScript_ = function(src) {
    var importScript = goog.global.CLOSURE_IMPORT_SCRIPT || goog.writeScriptTag_;
    if(!goog.dependencies_.written[src] && importScript(src)) {
      goog.dependencies_.written[src] = true
    }
  };
  goog.writeScriptTag_ = function(src) {
    if(goog.inHtmlDocument_()) {
      var doc = goog.global.document;
      doc.write('<script type="text/javascript" src="' + src + '"></' + "script>");
      return true
    }else {
      return false
    }
  };
  goog.writeScripts_ = function() {
    var scripts = [];
    var seenScript = {};
    var deps = goog.dependencies_;
    function visitNode(path) {
      if(path in deps.written) {
        return
      }
      if(path in deps.visited) {
        if(!(path in seenScript)) {
          seenScript[path] = true;
          scripts.push(path)
        }
        return
      }
      deps.visited[path] = true;
      if(path in deps.requires) {
        for(var requireName in deps.requires[path]) {
          if(!goog.isProvided_(requireName)) {
            if(requireName in deps.nameToPath) {
              visitNode(deps.nameToPath[requireName])
            }else {
              throw Error("Undefined nameToPath for " + requireName);
            }
          }
        }
      }
      if(!(path in seenScript)) {
        seenScript[path] = true;
        scripts.push(path)
      }
    }
    for(var path in goog.included_) {
      if(!deps.written[path]) {
        visitNode(path)
      }
    }
    for(var i = 0;i < scripts.length;i++) {
      if(scripts[i]) {
        goog.importScript_(goog.basePath + scripts[i])
      }else {
        throw Error("Undefined script input");
      }
    }
  };
  goog.getPathFromDeps_ = function(rule) {
    if(rule in goog.dependencies_.nameToPath) {
      return goog.dependencies_.nameToPath[rule]
    }else {
      return null
    }
  };
  goog.findBasePath_();
  if(!goog.global.CLOSURE_NO_DEPS) {
  }
}
goog.typeOf = function(value) {
  var s = typeof value;
  if(s == "object") {
    if(value) {
      if(value instanceof Array) {
        return"array"
      }else {
        if(value instanceof Object) {
          return s
        }
      }
      var className = Object.prototype.toString.call(value);
      if(className == "[object Window]") {
        return"object"
      }
      if(className == "[object Array]" || typeof value.length == "number" && typeof value.splice != "undefined" && typeof value.propertyIsEnumerable != "undefined" && !value.propertyIsEnumerable("splice")) {
        return"array"
      }
      if(className == "[object Function]" || typeof value.call != "undefined" && typeof value.propertyIsEnumerable != "undefined" && !value.propertyIsEnumerable("call")) {
        return"function"
      }
    }else {
      return"null"
    }
  }else {
    if(s == "function" && typeof value.call == "undefined") {
      return"object"
    }
  }
  return s
};
goog.propertyIsEnumerableCustom_ = function(object, propName) {
  if(propName in object) {
    for(var key in object) {
      if(key == propName && Object.prototype.hasOwnProperty.call(object, propName)) {
        return true
      }
    }
  }
  return false
};
goog.propertyIsEnumerable_ = function(object, propName) {
  if(object instanceof Object) {
    return Object.prototype.propertyIsEnumerable.call(object, propName)
  }else {
    return goog.propertyIsEnumerableCustom_(object, propName)
  }
};
goog.isDef = function(val) {
  return val !== undefined
};
goog.isNull = function(val) {
  return val === null
};
goog.isDefAndNotNull = function(val) {
  return val != null
};
goog.isArray = function(val) {
  return goog.typeOf(val) == "array"
};
goog.isArrayLike = function(val) {
  var type = goog.typeOf(val);
  return type == "array" || type == "object" && typeof val.length == "number"
};
goog.isDateLike = function(val) {
  return goog.isObject(val) && typeof val.getFullYear == "function"
};
goog.isString = function(val) {
  return typeof val == "string"
};
goog.isBoolean = function(val) {
  return typeof val == "boolean"
};
goog.isNumber = function(val) {
  return typeof val == "number"
};
goog.isFunction = function(val) {
  return goog.typeOf(val) == "function"
};
goog.isObject = function(val) {
  var type = goog.typeOf(val);
  return type == "object" || type == "array" || type == "function"
};
goog.getUid = function(obj) {
  return obj[goog.UID_PROPERTY_] || (obj[goog.UID_PROPERTY_] = ++goog.uidCounter_)
};
goog.removeUid = function(obj) {
  if("removeAttribute" in obj) {
    obj.removeAttribute(goog.UID_PROPERTY_)
  }
  try {
    delete obj[goog.UID_PROPERTY_]
  }catch(ex) {
  }
};
goog.UID_PROPERTY_ = "closure_uid_" + Math.floor(Math.random() * 2147483648).toString(36);
goog.uidCounter_ = 0;
goog.getHashCode = goog.getUid;
goog.removeHashCode = goog.removeUid;
goog.cloneObject = function(obj) {
  var type = goog.typeOf(obj);
  if(type == "object" || type == "array") {
    if(obj.clone) {
      return obj.clone()
    }
    var clone = type == "array" ? [] : {};
    for(var key in obj) {
      clone[key] = goog.cloneObject(obj[key])
    }
    return clone
  }
  return obj
};
Object.prototype.clone;
goog.bindNative_ = function(fn, selfObj, var_args) {
  return fn.call.apply(fn.bind, arguments)
};
goog.bindJs_ = function(fn, selfObj, var_args) {
  if(!fn) {
    throw new Error;
  }
  if(arguments.length > 2) {
    var boundArgs = Array.prototype.slice.call(arguments, 2);
    return function() {
      var newArgs = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(newArgs, boundArgs);
      return fn.apply(selfObj, newArgs)
    }
  }else {
    return function() {
      return fn.apply(selfObj, arguments)
    }
  }
};
goog.bind = function(fn, selfObj, var_args) {
  if(Function.prototype.bind && Function.prototype.bind.toString().indexOf("native code") != -1) {
    goog.bind = goog.bindNative_
  }else {
    goog.bind = goog.bindJs_
  }
  return goog.bind.apply(null, arguments)
};
goog.partial = function(fn, var_args) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var newArgs = Array.prototype.slice.call(arguments);
    newArgs.unshift.apply(newArgs, args);
    return fn.apply(this, newArgs)
  }
};
goog.mixin = function(target, source) {
  for(var x in source) {
    target[x] = source[x]
  }
};
goog.now = Date.now || function() {
  return+new Date
};
goog.globalEval = function(script) {
  if(goog.global.execScript) {
    goog.global.execScript(script, "JavaScript")
  }else {
    if(goog.global.eval) {
      if(goog.evalWorksForGlobals_ == null) {
        goog.global.eval("var _et_ = 1;");
        if(typeof goog.global["_et_"] != "undefined") {
          delete goog.global["_et_"];
          goog.evalWorksForGlobals_ = true
        }else {
          goog.evalWorksForGlobals_ = false
        }
      }
      if(goog.evalWorksForGlobals_) {
        goog.global.eval(script)
      }else {
        var doc = goog.global.document;
        var scriptElt = doc.createElement("script");
        scriptElt.type = "text/javascript";
        scriptElt.defer = false;
        scriptElt.appendChild(doc.createTextNode(script));
        doc.body.appendChild(scriptElt);
        doc.body.removeChild(scriptElt)
      }
    }else {
      throw Error("goog.globalEval not available");
    }
  }
};
goog.evalWorksForGlobals_ = null;
goog.cssNameMapping_;
goog.cssNameMappingStyle_;
goog.getCssName = function(className, opt_modifier) {
  var getMapping = function(cssName) {
    return goog.cssNameMapping_[cssName] || cssName
  };
  var renameByParts = function(cssName) {
    var parts = cssName.split("-");
    var mapped = [];
    for(var i = 0;i < parts.length;i++) {
      mapped.push(getMapping(parts[i]))
    }
    return mapped.join("-")
  };
  var rename;
  if(goog.cssNameMapping_) {
    rename = goog.cssNameMappingStyle_ == "BY_WHOLE" ? getMapping : renameByParts
  }else {
    rename = function(a) {
      return a
    }
  }
  if(opt_modifier) {
    return className + "-" + rename(opt_modifier)
  }else {
    return rename(className)
  }
};
goog.setCssNameMapping = function(mapping, style) {
  goog.cssNameMapping_ = mapping;
  goog.cssNameMappingStyle_ = style
};
goog.getMsg = function(str, opt_values) {
  var values = opt_values || {};
  for(var key in values) {
    var value = ("" + values[key]).replace(/\$/g, "$$$$");
    str = str.replace(new RegExp("\\{\\$" + key + "\\}", "gi"), value)
  }
  return str
};
goog.exportSymbol = function(publicPath, object, opt_objectToExportTo) {
  goog.exportSymbol_(publicPath, object, opt_objectToExportTo)
};
goog.exportProperty = function(object, publicName, symbol) {
  object[publicName] = symbol
};
goog.inherits = function(childCtor, parentCtor) {
  function tempCtor() {
  }
  tempCtor.prototype = parentCtor.prototype;
  childCtor.superClass_ = parentCtor.prototype;
  childCtor.prototype = new tempCtor;
  childCtor.prototype.constructor = childCtor
};
goog.base = function(me, opt_methodName, var_args) {
  var caller = arguments.callee.caller;
  if(caller.superClass_) {
    return caller.superClass_.constructor.apply(me, Array.prototype.slice.call(arguments, 1))
  }
  var args = Array.prototype.slice.call(arguments, 2);
  var foundCaller = false;
  for(var ctor = me.constructor;ctor;ctor = ctor.superClass_ && ctor.superClass_.constructor) {
    if(ctor.prototype[opt_methodName] === caller) {
      foundCaller = true
    }else {
      if(foundCaller) {
        return ctor.prototype[opt_methodName].apply(me, args)
      }
    }
  }
  if(me[opt_methodName] === caller) {
    return me.constructor.prototype[opt_methodName].apply(me, args)
  }else {
    throw Error("goog.base called from a method of one name " + "to a method of a different name");
  }
};
goog.scope = function(fn) {
  fn.call(goog.global)
};
goog.provide("jx.util");
goog.provide("Util");
goog.provide("echo");
(function() {
  var undefined = function() {
  }(), console = window.console, CONSOLE_LOGS = [], echo;
  if(console && console.log) {
    echo = function(var_args) {
      console.log.apply(console, arguments)
    }
  }else {
    echo = function(var_args) {
      CONSOLE_LOGS.push.apply(CONSOLE_LOGS, arguments)
    }
  }
  goog.exportSymbol("jx.util", Util);
  goog.exportSymbol("echo", echo);
  Util.isNull = function(val) {
    return val == null
  };
  Util.isNotNull = function(val) {
    return val != null
  };
  Util.isNullAnd = function() {
    var i = 0, len = arguments.length;
    for(;i < len;i++) {
      if(arguments[i] != null) {
        return false
      }
    }
    return true
  };
  Util.isNullOr = function() {
    var i = 0, len = arguments.length;
    for(;i < len;i++) {
      if(arguments[i] == null) {
        return true
      }
    }
    return false
  };
  Util.isNotNullAnd = function() {
    var i = 0, len = arguments.length;
    for(;i < len;i++) {
      if(arguments[i] == null) {
        return false
      }
    }
    return true
  };
  Util.isNotNullOr = function() {
    var i = 0, len = arguments.length;
    for(;i < len;i++) {
      if(arguments[i] != null) {
        return true
      }
    }
    return false
  };
  Util.ifNull = function(toCheck, ifNull, ifNotNull) {
    if(toCheck == null) {
      return ifNull
    }
    return ifNotNull === undefined ? toCheck : ifNotNull
  };
  Util.ifTrue = function(toCheck, ifTrue, ifNotTrue) {
    if(toCheck === true) {
      return ifTrue
    }
    return ifNotTrue === undefined ? toCheck : ifNotTrue
  };
  Util.isFunction = function(val) {
    return typeof val == "function"
  };
  Util.isString = function(val) {
    return typeof val == "string"
  };
  Util.isNumber = function(val) {
    return typeof val == "number"
  };
  Util.isObject = function(val) {
    return typeof val == "object"
  };
  Util.isArray = function(val) {
    var isArray = Array.isArray;
    return val && typeof val == "object" && (isArray && isArray(val) || typeof val.length == "number" && val.hasOwnProperty("length") && !val.propertyIsEnumerable("length"))
  };
  Util.split = function(str, regex, filter, map) {
    if(typeof str !== "string") {
      return[]
    }
    regex = regex === undefined ? /\s+/ : regex;
    filter = filter === undefined ? function(s) {
      return!!s
    } : filter;
    map = map === undefined ? function(s) {
      return $.trim(s)
    } : map;
    var res = str.split(regex);
    if(map) {
      res = res.map(map)
    }
    if(filter) {
      res = res.filter(filter)
    }
    return res
  };
  Util.isEmpty = function(obj) {
    if(!obj) {
      return true
    }
    if(typeof obj != "object") {
      return false
    }
    var i;
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        return false
      }
    }
    return true
  };
  Util.isEmptyObj = function(obj) {
    if(obj == null) {
      return true
    }
    if(typeof obj != "object") {
      return false
    }
    var i;
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        return false
      }
    }
    return true
  };
  Util.isNotEmptyObj = function(obj) {
    if(obj == null || typeof obj != "object") {
      return false
    }
    var i;
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        return true
      }
    }
    return false
  };
  Util.isEmptyString = function(obj) {
    return obj == null || obj === ""
  };
  Util.isEmptyArray = function(obj) {
    if(obj == null) {
      return true
    }
    if(!Util.isArray(obj)) {
      return false
    }
    var i = 0, len = obj.length;
    for(;i < len;i++) {
      if(obj.hasOwnProperty(i)) {
        return false
      }
    }
    return true
  };
  Util.emptyObject = function(map) {
    if(!map || typeof map != "object") {
      return map
    }
    if(Util.isArray(map)) {
      map.length = 0;
      return map
    }
    var i;
    for(i in map) {
      if(map.hasOwnProperty(i)) {
        delete map[i]
      }
    }
    return map
  };
  Util.deleteUndefined = function(map) {
    if(!map || typeof map != "object") {
      return map
    }
    var i;
    if(Util.isArray(map)) {
      var len = map.length;
      for(i = len - 1;i > -1;i--) {
        if(map.hasOwnProperty(i) && map[i] === undefined) {
          map.splice(i, 1)
        }
      }
      return map
    }
    for(i in map) {
      if(map.hasOwnProperty(i) && map[i] === undefined) {
        delete map[i]
      }
    }
    return map
  };
  Util.deepClone = function(obj) {
    if(!obj) {
      return obj
    }
    switch(typeof obj) {
      case "boolean":
      ;
      case "number":
      ;
      case "string":
      ;
      case "function":
        return obj
    }
    if(Util.isArray(obj)) {
      var clone = [], i = 0, len = obj.length;
      for(;i < len;i++) {
        if(i in obj) {
          clone[i] = Util.deepClone(obj[i])
        }
      }
      return clone
    }
    var clone = {}, i;
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        clone[i] = Util.deepClone(obj[i])
      }
    }
    return clone
  };
  Util.clone = function(obj, attr, deep) {
    if(!obj) {
      return obj
    }
    switch(typeof obj) {
      case "boolean":
      ;
      case "number":
      ;
      case "string":
      ;
      case "function":
        return obj
    }
    if(Util.isArray(obj)) {
      if(deep === 1) {
        return Array.prototype.slice.call(obj)
      }
      var clone = [], len = obj.length, i = 0, nd = deep !== undefined ? deep - 1 : undefined;
      for(;i < len;i++) {
        if(i in obj) {
          clone[i] = Util.clone(obj[i], attr, nd)
        }
      }
      return clone
    }
    var clone = {}, i, noattr = Util.isEmptyObj(attr);
    if(deep === 1) {
      if(noattr) {
        for(i in obj) {
          if(obj.hasOwnProperty(i)) {
            clone[i] = obj[i]
          }
        }
      }else {
        for(i in attr) {
          if(attr.hasOwnProperty(i) && obj.hasOwnProperty(i)) {
            clone[i] = obj[i]
          }
        }
      }
    }else {
      var nd = deep !== undefined ? deep - 1 : undefined;
      if(noattr) {
        for(i in obj) {
          if(obj.hasOwnProperty(i)) {
            clone[i] = Util.clone(obj[i], undefined, nd)
          }
        }
      }else {
        for(i in attr) {
          if(attr.hasOwnProperty(i) && obj.hasOwnProperty(i)) {
            clone[i] = Util.clone(obj[i], undefined, nd)
          }
        }
      }
    }
    return clone
  };
  Util.toArray = function(obj) {
    var arr = [], i;
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        arr.push(obj[i])
      }
    }
    return arr
  };
  Util.toArrayWithKey = function(obj) {
    var arr = [], i;
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        arr.push({key:i, val:obj[i]})
      }
    }
    return arr
  };
  Util.random = function(num) {
    return Math.floor(num * Math.random())
  };
  Util.bound = function(x, min, max) {
    if(!isNaN(max)) {
      x = Math.min(x, max)
    }
    if(!isNaN(min)) {
      x = Math.max(x, min)
    }
    return x
  };
  Util.callFn = function() {
    if(arguments.length <= 3) {
      return arguments[1].call(arguments[0], arguments[2])
    }
    return arguments[1].apply(arguments[0], Array.prototype.slice.call(arguments, 2))
  };
  Util.formatNumber = function(num, precision, currency, decimal, comma) {
    currency = currency === undefined ? "&#8361; " : currency;
    precision = isNaN(precision) ? 0 : precision;
    decimal = decimal === undefined ? "." : decimal;
    comma = comma === undefined ? "," : comma;
    var s = num < 0 ? "-" : "", i = parseInt(num = Math.abs(+num || 0).toFixed(precision), 10) + "", j = i.length;
    j = j > 3 ? j % 3 : 0;
    return currency + s + (j ? i.substr(0, j) + comma : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + comma) + (precision ? decimal + Math.abs(num - i).toFixed(precision).slice(2) : "")
  };
  Util.getBodyScroll = function() {
    var left = 0, top = 0;
    if(typeof window.pageYOffset === "number") {
      top = window.pageYOffset;
      left = window.pageXOffset
    }else {
      if(document.body && (document.body.scrollLeft || document.body.scrollTop)) {
        top = document.body.scrollTop;
        left = document.body.scrollLeft
      }else {
        if(document.documentElement && (document.documentElement.scrollLeft || document.documentElement.scrollTop)) {
          top = document.documentElement.scrollTop;
          left = document.documentElement.scrollLeft
        }
      }
    }
    return[left, top]
  };
  Util.hasClass = function(node, className) {
    if(node == null || className == null) {
      return false
    }
    if(node.className === className) {
      return true
    }
    if(node.className) {
      var cl = node.classList ? node.classList : Util.split(node.className), i = 0, len = cl.length;
      for(;i < len;i++) {
        if(cl[i] === className) {
          return true
        }
      }
    }
    return false
  };
  Util.hasTagAndClass = function(node, tag, className) {
    if(node == null || tag == null || className == null) {
      return false
    }
    if(node.tagName === tag) {
      if(node.className === className) {
        return true
      }
      if(node.className && node.className.length >= className.length) {
        var cl = node.classList ? node.classList : Util.split(node.className), i = 0, len = cl.length;
        for(;i < len;i++) {
          if(cl[i] === className) {
            return true
          }
        }
      }
    }
    return false
  };
  Util.closest = function(node, className, end) {
    if(Util.hasClass(node, className)) {
      return node
    }
    var found;
    for(node = node.parentNode;Util.isNotNull(node) && node !== end;node = node.parentNode) {
      if(Util.hasClass(node, className)) {
        return node
      }
    }
  };
  Util.closestWithTag = function(node, tag, className, end) {
    if(Util.hasTagAndClass(node, tag, className)) {
      return node
    }
    var found;
    for(node = node.parentNode;Util.isNotNull(node) && node !== end;node = node.parentNode) {
      if(Util.hasTagAndClass(node, tag, className)) {
        return node
      }
    }
  };
  Util.findFirstByClass = function(node, className) {
    if(node == null) {
      return
    }
    if(Util.hasClass(node, className)) {
      return node
    }
    var i = 0, c = node.childNodes, clen = c.length, found;
    for(;i < clen;i++) {
      if(Util.isNotNull(c[i]) && (found = Util.findFirstByClass(c[i], className)) !== undefined) {
        return found
      }
    }
  };
  Util.findFirstByTagAndClass = function(node, tag, className) {
    if(node == null) {
      return
    }
    if(Util.hasTagAndClass(node, tag, className)) {
      return node
    }
    var i = 0, c = node.childNodes, clen = c.length, found;
    for(;i < clen;i++) {
      if(Util.isNotNull(c[i]) && (found = Util.findFirstByTagAndClass(c[i], tag, className)) !== undefined) {
        return found
      }
    }
  };
  Util.findByClass = function(node, className, list) {
    if(list === undefined) {
      list = []
    }
    if(node == null) {
      return list
    }
    if(Util.hasClass(node, className)) {
      list.push(node)
    }
    var i = 0, c = node.childNodes, clen = c.length;
    for(;i < clen;i++) {
      if(Util.isNotNull(c[i])) {
        Util.findByClass(c[i], className, list)
      }
    }
    return list
  };
  Util.findByTagAndClass = function(node, tag, className, list) {
    if(list === undefined) {
      list = []
    }
    if(node == null) {
      return list
    }
    if(Util.hasTagAndClass(node, tag, className)) {
      list.push(node)
    }
    var i = 0, c = node.childNodes, clen = c.length;
    for(;i < clen;i++) {
      if(Util.isNotNull(c[i])) {
        Util.findByTagAndClass(c[i], tag, className, list)
      }
    }
    return list
  };
  Util.getHead = function() {
    if(document.head) {
      return document.head
    }
    return document.getElementsByTagName("head")[0]
  };
  Util.appendTag = function(node, tag) {
    return node.appendChild(document.createElement(tag))
  };
  Util.appendHTML = function(node, html) {
    var temp = document.createElement("div"), len, i = 0, res = [];
    temp.innerHTML = html;
    len = temp.childNodes.length;
    for(;i < len;i++) {
      res.push(node.appendChild(temp.firstChild))
    }
    return res
  };
  Util.createStyle = function(code) {
    if(code == null) {
      code = ""
    }
    var css = document.createElement("style");
    css.type = "text/css";
    css.rel = "stylesheet";
    if(css.styleSheet) {
      css.styleSheet.cssText = code
    }else {
      css.appendChild(document.createTextNode(code))
    }
    Util.getHead().appendChild(css);
    return css
  };
  Util.removeStyle = function(css) {
    if(css != null && css.parentNode != null) {
      Util.getHead().removeChild(css)
    }
  };
  Util.setStyle = function(css, code) {
    if(css == null) {
      return""
    }
    if(css.styleSheet) {
      return css.styleSheet.cssText = code
    }
    return css.childNodes[0].nodeValue = code
  };
  Util.appendStyle = function(css, code) {
    if(css == null) {
      return""
    }
    if(css.styleSheet) {
      return css.styleSheet.cssText += code
    }
    return css.childNodes[0].nodeValue += code
  };
  Util.getStyle = function(css) {
    if(css == null) {
      return""
    }
    if(css.styleSheet) {
      return css.styleSheet.cssText
    }
    return css.childNodes[0].nodeValue
  };
  Util.appendScript = function(code) {
    var script = document.createElement("script");
    script.type = "text/javascript";
    if(script.text) {
      script.text = code
    }else {
      script.innerHTML = code
    }
    Util.getHead().appendChild(script);
    return script
  };
  Util.appendScriptFile = function(filename) {
    document.write('<script type="text/javascript" src="' + filename + '"></' + "script>")
  };
  Util.outerHTML = function(node) {
    if(node.outerHTML === undefined) {
      var div = document.createElement("div");
      div.appendChild(node.cloneNode(true));
      return div.innerHTML
    }
    return node.outerHTML
  };
  Util.index = function(node) {
    var i = 0, el = node;
    while((el = el.previousSibling) != null) {
      ++i
    }
    return i
  };
  Util.contains = function(node, target, scope) {
    var el = target;
    while(el != null) {
      if(el === node) {
        return true
      }
      if(el === scope) {
        return false
      }
      el = el.parentNode
    }
    return false
  };
  Util.areEqualArrays = function(ar, br) {
    if(ar == null || br == null) {
      return false
    }
    if(ar === br) {
      return true
    }
    if(ar.length !== br.length) {
      return false
    }
    var i = 0, len = ar.length;
    for(;i < len;i++) {
      if(ar.hasOwnProperty(i) && !br.hasOwnProperty(i) || br.hasOwnProperty(i) && !ar.hasOwnProperty(i) || ar[i] !== br[i]) {
        return false
      }
    }
    return true
  };
  Util.areEqualObjects = function(ar, br) {
    if(ar == null || br == null) {
      return false
    }
    if(ar === br) {
      return true
    }
    if(typeof ar !== "object" || typeof br !== "object") {
      return false
    }
    var i;
    for(i in ar) {
      if(ar.hasOwnProperty(i)) {
        if(!br.hasOwnProperty(i) || ar[i] !== br[i]) {
          return false
        }
      }
    }
    for(i in br) {
      if(br.hasOwnProperty(i)) {
        if(!ar.hasOwnProperty(i) || ar[i] !== br[i]) {
          return false
        }
      }
    }
    return true
  };
  Util.areEqualComplex = function(ar, br, arch) {
    if(ar == null || br == null) {
      return false
    }
    if(ar === br) {
      return true
    }
    var len = arch.length, type = arch[0];
    if(len === 1) {
      if(type === "array") {
        return Util.areEqualArrays(ar, br)
      }
      return Util.areEqualObjects(ar, br)
    }
    if(len > 1) {
      var subArch = arch.slice(1), i = 0;
      if(type === "array") {
        if(ar.length !== br.length) {
          return false
        }
        var alen = ar.length;
        for(;i < alen;i++) {
          if(!br.hasOwnProperty(i) || !Util.areEqualComplex(ar[i], br[i], subArch)) {
            return false
          }
        }
        return true
      }else {
        for(i in ar) {
          if(ar.hasOwnProperty(i)) {
            if(!br.hasOwnProperty(i) || !Util.areEqualComplex(ar[i], br[i], subArch)) {
              return false
            }
          }
        }
        for(i in br) {
          if(br.hasOwnProperty(i)) {
            if(!ar.hasOwnProperty(i) || !Util.areEqualComplex(ar[i], br[i], subArch)) {
              return false
            }
          }
        }
        return true
      }
    }
  };
  Util.typeCheck = function(type, obj, allowUndefined, allowNull, noThrow) {
    if(allowUndefined && obj === undefined || allowNull && obj === null) {
      return true
    }
    switch(typeof type) {
      case "string":
        if(typeof obj === type) {
          return true
        }
        break;
      case "function":
        if(obj instanceof type) {
          return true
        }
        break
    }
    if(noThrow) {
      return false
    }
    throw new TypeError("object is not a " + type + ", but is a " + typeof obj);
  };
  Util.sprint = function(str, obj, prefix, suffix) {
    Util.typeCheck("string", str);
    Util.typeCheck("object", obj);
    Util.typeCheck("string", prefix, true);
    Util.typeCheck("string", suffix, true);
    var prefixLength, suffixLength, i;
    if(prefix === undefined) {
      prefix = "%"
    }
    if(suffix === undefined) {
      suffix = "%"
    }
    for(i in obj) {
      if(obj.hasOwnProperty(i)) {
        str = str.replace(new RegExp(prefix + i + suffix, "gm"), obj[i])
      }
    }
    return str
  };
  Util.tagReplaces = {"&":"&amp;", "<":"&lt;", ">":"&gt;"};
  Util.replaceTag = function(tag) {
    return Util.tagReplaces[tag] || tag
  };
  Util.escapeHtmlTags = function(str) {
    return str.replace(/[&<>]/g, Util.replaceTag)
  };
  Util.escapeRegExp = function(str) {
    return str.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
  };
  Util.strReplace = function(str, replaceMap) {
    var i, search = [];
    for(i in replaceMap) {
      if(replaceMap.hasOwnProperty(i)) {
        search.push(Util.escapeRegExp(i))
      }
    }
    return str.replace(new RegExp("(" + search.join("|") + ")", "gm"), function(match) {
      return replaceMap[match]
    })
  };
  Util.calCheckSize = function() {
    var res = {}, div = document.createElement("div");
    document.body.appendChild(div);
    div.innerHTML = "<input type='checkbox' style='margin:0;padding:0;overflow:hidden'/>";
    res.checkboxW = div.childNodes[0].offsetWidth;
    res.checkboxH = div.childNodes[0].offsetHeight;
    div.innerHTML = "<input type='radio' style='margin:0;padding:0;overflow:hidden'/>";
    res.radioW = div.childNodes[0].offsetWidth;
    res.radioH = div.childNodes[0].offsetHeight;
    document.body.removeChild(div);
    return res
  };
  Util.which = function(keys) {
    var keyMap = {}, i = 0, str, j;
    for(;i < keys.length;i++) {
      str = keys[i].toLowerCase();
      if(str === "number") {
        for(j = 48;j <= 57;j++) {
          keyMap[j] = true
        }
        for(j = 96;j <= 105;j++) {
          keyMap[j] = true
        }
        continue
      }else {
        if(str === "alphabet") {
          for(j = 65;j <= 90;j++) {
            keyMap[j] = true
          }
          continue
        }else {
          if(str === "arrow") {
            for(j = 37;j <= 40;j++) {
              keyMap[j] = true
            }
            continue
          }
        }
      }
      if(str.length > 1) {
        str = str.replace(/\s/g, "")
      }
      if(str.length >= 3) {
        str = str.replace(/numpad|num/g, "n").replace(/korean|kor/g, "kr")
      }
      keyMap[Util.keyMapKeydown[str]] = true
    }
    return keyMap
  };
  Util.keyMapKeydown = {"backspace":8, "tab":9, "enter":13, "shift":16, "control":17, "ctrl":17, "alt":18, "pause":19, "break":19, "capslock":20, "escape":27, "esc":27, "space":32, " ":32, "pageup":33, "pgup":33, "pagedown":34, "pgdown":34, "pgdn":34, "end":35, "home":36, "leftarrow":37, "left":37, "uparrow":38, "up":38, "rightarrow":39, "right":39, "downarrow":40, "down":40, "insert":45, "ins":45, "delete":46, "del":46, 0:48, ")":48, 1:49, "!":49, 2:50, "@":50, 3:51, "#":51, 4:52, "$":52, 5:53, 
  "%":53, 6:54, "^":54, 7:55, "&":55, 8:56, "*":56, 9:57, "(":57, "a":65, "b":66, "c":67, "d":68, "e":69, "f":70, "g":71, "h":72, "i":73, "j":74, "k":75, "l":76, "m":77, "n":78, "o":79, "p":80, "q":81, "r":82, "s":83, "t":84, "u":85, "v":86, "w":87, "x":88, "y":89, "z":90, "n0":96, "n1":97, "n2":98, "n3":99, "n4":100, "n5":101, "n6":102, "n7":103, "n8":104, "n9":105, "n*":106, "n+":107, "n-":109, "n.":110, "n/":111, "f1":112, "f2":113, "f3":114, "f4":115, "f5":116, "f6":117, "f7":118, "f8":119, "f9":120, 
  "f10":121, "f11":122, "f12":123, "numlock":144, "scrolllock":145, "mute":173, "volumedown":174, "volumeup":175, ":":186, ";":186, "=":187, "+":187, ",":188, "<":188, "-":189, "_":189, ".":190, ">":190, "/":191, "?":191, "`":192, "~":192, "[":219, "{":219, "\\":220, "|":220, "]":221, "}":221, "'":222, '"':222, "kr":229};
  Util.printEventPos = function(e) {
    Util.print("client: (" + e.clientX + ", " + e.clientY + "), " + "layer: (" + e.layerX + ", " + e.layerY + "), " + "offset: (" + e.offsetX + ", " + e.offsetY + "), " + "page: (" + e.pageX + ", " + e.pageY + "), " + "screen: (" + e.screenX + ", " + e.screenY + "), " + "xy: (" + e.x + ", " + e.y + ")")
  };
  Util.print = function(var_args) {
    if(!echo) {
      return
    }
    if(arguments.length === 1) {
      echo(arguments[0])
    }else {
      var i = 0, len = arguments.length;
      for(;i < len;i++) {
        echo(arguments[i])
      }
    }
  };
  Util.open = function(options) {
    var ops = {url:"about:blank", name:"_blank", channelmode:"no", directories:"yes", fullscreen:"no", height:undefined, left:undefined, location:"yes", menubar:"yes", resizable:"yes", scrollbars:"yes", status:"yes", titlebar:"yes", toolbar:"yes", top:undefined, width:undefined, replace:undefined}, opt, specs;
    if(Util.isNotNull(options)) {
      for(opt in ops) {
        if(ops.hasOwnProperty(opt)) {
          ops[opt] = options[opt]
        }
      }
    }
    specs = Util.ifNull(ops.height, "", "height=" + ops.height + ", ") + Util.ifNull(ops.left, "", "left=" + ops.left + ", ") + Util.ifNull(ops.top, "", "top=" + ops.top + ", ") + Util.ifNull(ops.width, "", "width=" + ops.width + ", ") + "channelmode=" + ops.channelmode + ", " + "directories=" + ops.directories + ", " + "fullscreen=" + ops.fullscreen + ", " + "location=" + ops.location + ", " + "menubar=" + ops.menubar + ", " + "resizable=" + ops.resizable + ", " + "scrollbars=" + ops.scrollbars + 
    ", " + "status=" + ops.status + ", " + "titlebar=" + ops.titlebar + ", " + "toolbar=" + ops.toolbar;
    if(Util.isNull(ops.replace)) {
      return window.open(ops.url, ops.name, specs)
    }
    return window.open(ops.url, ops.name, specs, ops.replace)
  }
})();
goog.require("jx.util");
goog.provide("Tracer");
(function() {
  goog.exportSymbol("Tracer", Tracer);
  Tracer = function() {
    this.stack = "";
    this.timers = {}
  };
  var prototype = Tracer.prototype;
  prototype.print = function(str, timer, update) {
    if(str === undefined) {
      str = ""
    }
    if(timer === undefined) {
      timer = "timer"
    }
    if(update === undefined) {
      update = true
    }
    var old = this.timers[timer], now = (new Date).getTime(), diff = Util.isNull(old) ? 0 : now - old;
    Util.print((this.stack.length > 0 ? this.stack + " :: " : "") + str + ", Time elapsed since last update: " + diff + "ms");
    if(update) {
      this.timers[timer] = now
    }
  };
  prototype.addStack = function(str) {
    this.stack = this.stack + " > " + str
  };
  prototype.removeStack = function() {
    this.stack = this.stack.substring(0, this.stack.lastIndexOf(" > "))
  };
  prototype.clearStack = function() {
    this.stack = ""
  }
})();
goog.require("jx.util");
goog.provide("jx.util$");
goog.provide("Util$");
(function() {
  goog.exportSymbol("jx.util$", Util$);
  Util$.is$ = function(val) {
    return val instanceof jQuery ? true : false
  };
  Util$.safe$ = function(val) {
    return val instanceof jQuery ? val : $(val)
  };
  Util$.unbindRemove = function(obj) {
    obj.unbind().remove()
  };
  jQuery.fn.getBoundingRect = function() {
    var off = this.offset();
    return{left:off.left, top:off.top, width:this.outerWidth(), height:this.outerHeight()}
  };
  jQuery.fn.containsEvent = function(e) {
    if(this.length === 0) {
      return false
    }
    var box, contains, x, y;
    if(this.length <= 1) {
      box = this.getBoundingRect();
      x = e.pageX;
      y = e.pageY;
      return x >= box.left && x <= box.left + box.width && y >= box.top && y <= box.top + box.height
    }
    contains = false;
    this.each(function(i, v) {
      box = $(this).getBoundingRect();
      x = e.pageX;
      y = e.pageY;
      if(x >= box.left && x <= box.left + box.width && y >= box.top && y <= box.top + box.height) {
        contains = true;
        return false
      }
    });
    return contains
  };
  Util$.baseurlOfHeadScript = function(filename) {
    var url = $(document.getElementsByTagName("head")[0]).find("script[src$='" + filename + "']").attr("src");
    return url.substring(0, url.indexOf(filename))
  };
  Util$.calScrollbarDims = function(container) {
    if(Util.isNotNull(window.__SCROLLBAR_DIM__)) {
      return window.__SCROLLBAR_DIM__
    }
    if(Util.isNotNull(window.opener) && Util.isNotNull(window.opener.__SCROLLBAR_DIM__)) {
      return window.opener.__SCROLLBAR_DIM__
    }
    var cont = Util$.safe$(container), dim, tmp;
    cont[0].innerHTML = "<div id='scrollbardim' style='position:absolute;top:-10000px;left:-10000px;width:100px;height:100px;overflow:scroll;'></div>";
    tmp = $(document.getElementById("scrollbardim"));
    dim = {w:tmp.width() - tmp[0].clientWidth, h:tmp.height() - tmp[0].clientHeight};
    cont[0].innerHTML = "";
    window.__SCROLLBAR_DIM__ = dim;
    return dim
  }
})();
goog.require("jx.util");
goog.require("jx.util$");
goog.provide("jx.grid");
goog.provide("JGM");
(function() {
  goog.exportSymbol("JGM", JGM);
  goog.exportSymbol("jx.grid", JGM);
  JGM.version = "1.2.3";
  JGM.__map_a__ = {ArrayExtIE:{filename:"array_ext_ie.js", readyState:"notloaded", required:false, cacheModule:false}, Cache:{filename:"jgrid_cache.js", readyState:"notloaded", required:true, cacheModule:true}, Cell:{filename:"jgrid_cell.js", readyState:"notloaded", required:true, cacheModule:false}, CheckManager:{filename:"jgrid_checkmanager.js", readyState:"notloaded", required:false, cacheModule:true}, ColDefManager:{filename:"jgrid_coldefmanager.js", readyState:"notloaded", required:true, cacheModule:true}, 
  ColGroup:{filename:"jgrid_colgroup.js", readyState:"notloaded", required:false, cacheModule:true}, ColHeader:{filename:"jgrid_colheader.js", readyState:"notloaded", required:true, cacheModule:true}, Collapser:{filename:"jgrid_collapser.js", readyState:"notloaded", required:false, cacheModule:true}, DataManager:{filename:"jgrid_datamanager.js", readyState:"notloaded", required:true, cacheModule:true}, DataCreator:{filename:"jgrid_datacreator.js", readyState:"notloaded", required:false, cacheModule:true}, 
  EditManager:{filename:"jgrid_editmanager.js", readyState:"notloaded", required:true, cacheModule:true}, Editor:{filename:"jgrid_editmanager.js", readyState:"notloaded", required:true, cacheModule:true}, EngineExt:{filename:"engine_ext.js", readyState:"notloaded", required:true, cacheModule:false}, EventManager:{filename:"jgrid_eventmanager.js", readyState:"notloaded", required:true, cacheModule:true}, Footer:{filename:"jgrid_footer.js", readyState:"notloaded", required:false, cacheModule:true}, 
  HeaderTree:{filename:"jgrid_headertree.js", readyState:"notloaded", required:false, cacheModule:true}, Grid:{filename:"jgrid_grid.js", readyState:"notloaded", required:true, cacheModule:true}, GridManager:{filename:"jgrid_manager.js", readyState:"loaded", required:true, cacheModule:false}, MenuBar:{filename:"jgrid_menubar.js", readyState:"notloaded", required:true, cacheModule:true}, ViewportManager:{filename:"jgrid_viewportmanager.js", readyState:"notloaded", required:true, cacheModule:true}, 
  SelectionManager:{filename:"jgrid_selectionmanager.js", readyState:"notloaded", required:false, cacheModule:true}, SearchManager:{filename:"jgrid_searchmanager.js", readyState:"notloaded", required:false, cacheModule:true}, TooltipManager:{filename:"jgrid_tooltipmanager.js", readyState:"notloaded", required:false, cacheModule:true}, Tracer:{filename:"tracer.js", readyState:"notloaded", required:false, cacheModule:false}, Tree:{filename:"tree.js", readyState:"notloaded", required:false, cacheModule:true}, 
  TreeNode:{filename:"tree.js", readyState:"notloaded", required:false, cacheModule:false}, Util:{filename:"util.js", readyState:"notloaded", required:true, cacheModule:false}, "Util$":{filename:"util_jquery.js", readyState:"notloaded", required:true, cacheModule:false}};
  JGM.create = function(name, args) {
    if(Util.isNull(args)) {
      args = {}
    }
    if(this.__map_a__[name].cacheModule) {
      args.mid = "JGM" + this.m.length++;
      var module = this[name].getInstance(args);
      if(!this.m.hasOwnProperty(name)) {
        this.m[name] = {}
      }
      this.m[name][module.mid] = module;
      if(name === "Grid" && Util.isNotNull(module.name)) {
        this.gridMap[module.name] = module
      }
      return module
    }else {
      return this[name].getInstance(args)
    }
  };
  JGM._destroy = function(obj, args) {
    var cur, arr, i, j, len;
    for(i in args) {
      if(args.hasOwnProperty(i)) {
        switch(i) {
          case "map":
            cur = args[i];
            if(Util.isString(cur)) {
              arr = Util.split(cur);
              len = arr.length;
              for(j = 0;j < len;j++) {
                JGM.__deleteMap_l__(obj, arr[j])
              }
            }else {
              if(cur instanceof Array) {
                len = cur.length;
                for(j = 0;j < len;j++) {
                  Util.emptyObject(cur[j])
                }
              }else {
                Util.emptyObject(cur)
              }
            }
            break;
          case "array":
            cur = args[i];
            if(Util.isString(cur)) {
              arr = Util.split(cur);
              len = arr.length;
              for(j = 0;j < len;j++) {
                JGM.__deleteArray_r__(obj, arr[j])
              }
            }else {
              cur.length = 0
            }
            break;
          case "$":
            cur = args[i];
            if(Util.isString(cur)) {
              arr = Util.split(cur);
              len = arr.length;
              for(j = 0;j < len;j++) {
                JGM.__delete$_n__(obj, arr[j])
              }
            }else {
              if(cur instanceof Array) {
                len = cur.length;
                for(j = 0;j < len;j++) {
                  Util$.unbindRemove(cur[j])
                }
              }else {
                Util$.unbindRemove(cur)
              }
            }
            break;
          case "style":
            cur = args[i];
            if(Util.isString(cur)) {
              arr = Util.split(cur);
              len = arr.length;
              for(j = 0;j < len;j++) {
                JGM.__deleteStyle_o__(obj, arr[j])
              }
            }else {
              if(cur instanceof Array) {
                len = cur.length;
                for(j = 0;j < len;j++) {
                  Util.removeStyle(cur[j])
                }
              }else {
                Util.removeStyle(cur)
              }
            }
            break;
          case "property":
            cur = args[i];
            if(Util.isString(cur)) {
              arr = Util.split(cur);
              len = arr.length;
              for(j = 0;j < len;j++) {
                delete obj[arr[j]]
              }
            }else {
              if(cur instanceof Array) {
                len = cur.length;
                for(j = 0;j < len;j++) {
                  delete obj[cur[j]]
                }
              }
            }
            break;
          case "module":
            cur = args[i];
            if(Util.isString(cur)) {
              arr = Util.split(cur);
              len = arr.length;
              for(j = 0;j < len;j++) {
                JGM.__deleteModule_p__(obj, arr[j])
              }
            }else {
              if(cur instanceof Array) {
                len = cur.length;
                for(j = 0;j < len;j++) {
                  cur[j].destroy()
                }
              }else {
                cur.destroy()
              }
            }
            break;
          case "name":
            if(obj.hasOwnProperty("mid")) {
              JGM.__remove_f__(args[i], obj.mid);
              delete obj.mid
            }
            break;
          case "path":
            if(obj.hasOwnProperty("grid") && obj.grid.hasOwnProperty(args[i])) {
              delete obj.grid[args[i]];
              delete obj.grid
            }
            break
        }
      }
    }
    Util.emptyObject(obj)
  };
  JGM.__deleteMap_l__ = function(obj, name) {
    if(obj.hasOwnProperty(name)) {
      Util.emptyObject(obj[name]);
      delete obj[name]
    }
  };
  JGM.__deleteArray_r__ = function(obj, name) {
    if(obj.hasOwnProperty(name)) {
      obj[name].length = 0;
      delete obj[name]
    }
  };
  JGM.__delete$_n__ = function(obj, name) {
    if(obj.hasOwnProperty(name)) {
      Util$.unbindRemove(obj[name]);
      delete obj[name]
    }
  };
  JGM.__deleteStyle_o__ = function(obj, name) {
    if(obj.hasOwnProperty(name)) {
      Util.removeStyle(obj[name]);
      delete obj[name]
    }
  };
  JGM.__deleteModule_p__ = function(obj, name) {
    if(obj.hasOwnProperty(name)) {
      obj[name].destroy();
      delete obj[name]
    }
  };
  JGM.__remove_f__ = function(name, mid) {
    delete this.m[name][mid]
  };
  JGM.grid = function(args) {
    return this.create("Grid", args)
  };
  JGM.gridMap = {};
  JGM.getGrid = function(name) {
    if(this.gridMap.hasOwnProperty(name)) {
      return this.gridMap[name]
    }
  };
  JGM._add = function(name, module) {
    if(Util.isNotNull(module)) {
      this[name] = module
    }
    this.__map_a__[name].readyState = "loaded";
    $("body").trigger({type:"moduleload.Grid", modulename:name, readyState:"loaded"})
  };
  JGM.__extend_e__ = function(defaults, options, map) {
    var opt = Util.ifNull(options, {}), i;
    if(Util.isNotNull(map)) {
      for(i in map) {
        if(map.hasOwnProperty(i)) {
          if(opt.hasOwnProperty(i)) {
            opt[map[i]] = opt[i];
            delete opt[i]
          }
        }
      }
    }
    $.extend(true, defaults, opt);
    $.extend(true, opt, defaults);
    return opt
  };
  JGM.m = {length:0};
  JGM.__CONST_g__ = {__cssUnselectable_a__:"-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;user-select:none;", __cssUnselectable_b__:"-webkit-user-drag:none;-moz-user-drag:none;user-drag:none;", __checkboxWidth_c__:undefined, __checkboxHeight_d__:undefined, __radioWidth_e__:undefined, __radioHeight_f__:undefined};
  JGM.__globalEventsBound_h__ = false;
  JGM.__globalEvents_i__ = {__mousemove_a__:function(e) {
    var i, g = JGM.m.Grid;
    for(i in g) {
      if(g.hasOwnProperty(i)) {
        g[i]._mousemove(e)
      }
    }
  }, __mouseup_b__:function(e) {
    var i, g = JGM.m.Grid;
    for(i in g) {
      if(g.hasOwnProperty(i)) {
        g[i]._mouseup(e)
      }
    }
  }, __resize_c__:function(e) {
    var i, g = JGM.m.Grid;
    for(i in g) {
      if(g.hasOwnProperty(i)) {
        g[i]._resize(e)
      }
    }
  }};
  JGM._bindGlobalEvents = function() {
    if(!this.__globalEventsBound_h__) {
      $(document).bind({mousemove:this.__globalEvents_i__.__mousemove_a__, mouseup:this.__globalEvents_i__.__mouseup_b__});
      $(window).resize(this.__globalEvents_i__.__resize_c__);
      this.__globalEventsBound_h__ = true
    }
  };
  JGM._unbindGlobalEvents = function() {
    if(this.__globalEventsBound_h__) {
      $(document).unbind({mousemove:this.__globalEvents_i__.__mousemove_a__, mouseup:this.__globalEvents_i__.__mouseup_b__});
      $(window).unbind("resize", this.__globalEvents_i__.__resize_c__);
      this.__globalEventsBound_h__ = false
    }
  };
  JGM.error = {LENGTH_NOT_EQUAL:"Lengths are not equal", NOT_MODIFIABLE:"Cannot modify value for '%0'.", KEY_UNDEFINED:"Column '%0' is undefined.", BAD_NULL:"Column '%0' cannot be null.", DUP_KEY:"Duplicate column key '%0'.", DUP_ENTRY:"Duplicate entry '%0' for '%1'.", KEY_NOT_FOUND:"'%0' for '%1' doesn't exist in table.", PARSE_ERROR:"Cannot parse '%0' for '%1'.", INVALID_DEFAULT:"Invalid default value '%0' for '%1'.", MULTIPLE_PRI_KEY:"Multiple primary key defined.", DATA_TOO_LONG:"Data '%0' too long for column '%1'. Maximum is %2.", 
  DATA_TOO_SHORT:"Data '%0' too short for column '%1'. Minimum is %2.", WRONG_LENGTH:"Length of data '%0' is not '%1' characters long for column '%2'.", BIGGER_THAN:"Data '%0' too big for column '%1'. Maximum is %2.", SMALLER_THAN:"Data '%0' too small for column '%1'. Minimum is %2.", WRONG_VALUE:"Incorrect value: '%0' for '%1'."}
})();
goog.require("jx.util");
goog.require("jx.util$");
goog.require("jx.grid");
goog.provide("jx.grid.renderer");
(function() {
  goog.exportSymbol("jx.grid.renderer", renderer);
  var renderer = JGM.renderer = jx.grid.renderer;
  renderer.selectBox = function(args) {
    var mappings = args.mapping, attr = args.attr, defaultVal = args["default"], style = args.style, callback = args.callback, label, defaultIdx, val, tag, len = 0, labels = [], values = [], attrStr = "<select";
    if(attr) {
      for(tag in attr) {
        if(attr.hasOwnProperty(tag)) {
          attrStr += " " + tag + '="' + attr[tag] + '"'
        }
      }
    }
    if(style) {
      attrStr += ' style="';
      for(tag in style) {
        if(style.hasOwnProperty(tag)) {
          attrStr += tag + ":" + style[tag] + ";"
        }
      }
      attrStr += '"'
    }
    attrStr += ">";
    for(label in mappings) {
      if(mappings.hasOwnProperty(label)) {
        val = mappings[label];
        labels.push(label);
        values.push(val);
        if(defaultVal == val) {
          defaultIdx = len
        }
        len++
      }
    }
    return function(value) {
      var toselect, i, html = attrStr;
      for(i = 0;i < len;i++) {
        if(value == values[i]) {
          toselect = i;
          break
        }
      }
      if(toselect === undefined) {
        toselect = defaultIdx
      }
      for(i = 0;i < len;i++) {
        html += '<option value="' + values[i] + '"';
        if(i === toselect) {
          html += ' selected="selected"'
        }
        html += ">" + labels[i] + "</option>"
      }
      html += "</select>";
      if(callback) {
        var args = [];
        args.push(html);
        Array.prototype.push.apply(args, arguments);
        html = callback.apply(this, args)
      }
      return html
    }
  }
})();
goog.require("jx.util");
goog.provide("jx.lang.Disposable");
(function() {
  goog.exportSymbol("jx.lang.Disposable", Disposable);
  goog.exportProperty(Disposable.prototype, "dispose", dispose);
  function Disposable(args) {
  }
  var proto = Disposable.prototype, isArray = Util.isArray;
  function dispose(level, others) {
    level = level || 0;
    var i, val;
    if(level !== 0) {
      for(i in this) {
        if(this.hasOwnProperty(i)) {
          val = this[i];
          if(val) {
            if(val.dispose) {
              val.dispose(level - 1, others)
            }else {
              if(others && typeof val == "object") {
                if(isArray(val)) {
                  val.length = 0
                }else {
                  dispose.call(val, level - 1, others)
                }
              }
            }
          }
          delete this[i]
        }
      }
    }else {
      for(i in this) {
        if(this.hasOwnProperty(i)) {
          delete this[i]
        }
      }
    }
  }
})();
goog.require("jx.lang.Disposable");
goog.provide("jx.events.EventDispatcher");
(function() {
  goog.exportSymbol("jx.events.EventDispatcher", EventDispatcher);
  function EventDispatcher(args) {
  }
  goog.inherits(EventDispatcher, JGM.lang.Disposable);
  var proto = EventDispatcher.prototype, sdispose = proto.dispose;
  proto.dispose = function() {
    sdispose.call(this, -1, true)
  };
  proto.addEventListener = function(type, listener) {
    if(!type) {
      throw new Error("Invalid event type: " + type);
    }
    if(typeof listener != "function") {
      throw new Error("Event listener must be a function");
    }
    if(!this._handlers) {
      this._handlers = {}
    }
    var map = this._handlers, listeners;
    type = (type + "").toLowerCase();
    if(!map.hasOwnProperty(type)) {
      map[type] = []
    }
    listeners = map[type];
    if(listeners.indexOf(listener) === -1) {
      listeners.push(listener)
    }
  };
  proto.removeEventListener = function(type, listener) {
    if(!this._handlers) {
      return
    }
    type = (type + "").toLowerCase();
    var map = this._handlers;
    if(!map.hasOwnProperty(type)) {
      return
    }
    var listeners = map[type], index = -1;
    while((index = listeners.indexOf(listener, index + 1)) !== -1) {
      listeners.splice(index, 1)
    }
    if(listeners.length === 0) {
      delete map[type]
    }
  };
  proto.dispatchEvent = function(event) {
    if(!event || !event.type) {
      throw new Error("Invalid event");
    }
    if(!this._handlers) {
      if(event.cancelable && event.defaultPrevented) {
        return false
      }
      if(event.defaultAction) {
        event.defaultAction(this)
      }
      return true
    }
    var map = this._handlers, type = (event.type + "").toLowerCase(), listeners;
    event.target = this;
    if(map.hasOwnProperty(type)) {
      listeners = map[type];
      var i = 0, l = listeners.length, listener;
      for(;i < l && !event.stopPropagation;i++) {
        listener = listeners[i];
        if(listener.handleEvent) {
          listener.handleEvent(event)
        }else {
          listener.call(this, event)
        }
      }
    }
    if(event.cancelable && event.defaultPrevented) {
      return false
    }
    if(event.defaultAction) {
      event.defaultAction(this)
    }
    return true
  }
})();
goog.require("jx.grid");
goog.require("jx.events.EventDispatcher");
goog.provide("jx.grid.Column");
(function() {
  goog.exportSymbol("jx.grid.Column", Column);
  function Column(args) {
    if(!(args.manager && typeof args.manager == "object")) {
      throw new Error("Column needs a valid manager!");
    }
    this.manager = args.manager;
    this.key = args.key + "";
    if(!this.key) {
      throw new Error("Column needs a non-empty key!");
    }
    var error = "column key=" + this.key;
    if(this.manager.hasKey(this.key)) {
      throw new Error("Duplicate column key!" + error);
    }
    this.name = args.name ? args.name + "" : "";
    this.title = args.title ? args.title + "" : "";
    this.noName = !!args.noName;
    this.noTitle = !!args.noTitle;
    this.type = args.type + "" || null;
    this.defaultValue = args.defaultValue;
    this.inputOnCreate = !!args.inputOnCreate;
    this.width = Number(args.width);
    this.width = this.width || 90;
    this.minW = Number(args.minW);
    this.minW = this.minW || 30;
    this.maxW = Number(args.maxW) || null;
    this.resizable = !!args.resizable;
    this.hidden = !!args.hidden;
    this.noSearch = !!args.noSearch;
    this.tooltipEnabled = !!args.tooltipEnabled;
    this.colClass = args.colClass + "" || null;
    this.style = args.style + "" || null;
    this.headerStyle = args.headerStyle + "" || null;
    if(args.parser && typeof args.parser != "function") {
      throw new Error("Invalid parser!" + error);
    }
    this.parser = args.parser || null;
    if(args.validator && typeof args.validator != "function") {
      throw new Error("Invalid validator!" + error);
    }
    this.validator = args.validator || null;
    if(args.renderer && typeof args.renderer != "function") {
      throw new Error("Invalid renderer!" + error);
    }
    this.renderer = args.renderer || null;
    if(args.sumRenderer && typeof args.sumRenderer != "function") {
      throw new Error("Invalid sum renderer!" + error);
    }
    this.sumRenderer = args.sumRenderer || null;
    if(args.editor && typeof args.editor != "object") {
      throw new Error("Invalid editor!" + error);
    }
    this.editor = args.editor || null;
    this.sorter = args.sorter || null;
    this.filter = args.filter || null
  }
  goog.inherits(Column, jx.events.EventDispatcher);
  var proto = Column.prototype;
  proto.show = function() {
    if(this.hidden) {
      this.hidden = false;
      this.dispatchEvent({type:"hidden", value:false});
      return true
    }
    return false
  };
  proto.hide = function() {
    if(!this.hidden) {
      this.hidden = true;
      this.dispatchEvent({type:"hidden", value:true});
      return true
    }
    return false
  };
  proto.setHidden = function(hidden) {
    return hidden ? this.hide() : this.show()
  };
  proto.setWidth = function(w) {
    w = Number(w);
    if(w && this.width !== w) {
      this.width = w;
      this.dispatchEvent({type:"width", value:w});
      return w
    }
    return false
  };
  proto.setRenderer = function(renderer) {
    if(this.renderer !== renderer) {
      if(renderer && typeof renderer != "function") {
        var error = "column key=" + this.key;
        throw new Error("Invalid renderer!" + error);
      }
      this.renderer = renderer || null;
      this.dispatchEvent({type:"renderer", value:renderer})
    }
  }
})();
goog.require("jx.lang.Disposable");
goog.require("jx.events.EventDispatcher");
goog.require("jx.grid");
goog.provide("jx.grid.BaseModule");
(function() {
  goog.exportSymbol("jx.grid.BaseModule", BaseModule);
  function BaseModule(args) {
    if(args) {
      if(args.mid != null) {
        this.mid = args.mid
      }
      if(args.grid) {
        this.grid = args.grid
      }
    }
    var defaults = this._defaultOptions && this._defaultOptions(), opts = args && args.options;
    if(opts || defaults) {
      if(!defaults) {
        defaults = {}
      }
      if(opts) {
        $.extend(true, defaults, opts)
      }
      this._options = defaults
    }
    if(this._init) {
      this.dispatchEvent({type:"beforeinit"});
      this._init(args);
      this.dispatchEvent({type:"afterinit"})
    }
    var that = this, grid = this.grid;
    if(grid) {
      ["dispose", "createcss", "createdynamiccss", "render", "keydown", "keyup", "keypress", "mousein", "mouseout", "mouseenter", "mouseleave", "mousemove", "mouseover", "mousedown", "mouseup", "click", "dblclick", "resize", "resizewidth", "resizeheight", "scroll", "scrollh", "scrollv"].forEach(function(name) {
        var before = "_before" + name, after = "_after" + name;
        if(that[before]) {
          grid.addEventListener(before, function(event) {
            return that[before](event)
          })
        }
        if(that[after]) {
          grid.addEventListener(after, function(event) {
            return that[after](event)
          })
        }
      })
    }
    if(this._bindEvents) {
      this.dispatchEvent({type:"beforebindevents"});
      this._bindEvents(args);
      this.dispatchEvent({type:"afterbindevents"})
    }
    this.dispatchEvent({type:"complete"})
  }
  goog.inherits(BaseModule, EventDispatcher);
  var proto = BaseModule.prototype, superdispose = proto.dispose;
  proto._beforedispose = function() {
    this.dispose()
  };
  proto.dispose = function() {
    delete this.grid;
    this.dispatchEvent({type:"beforedispose"});
    superdispose.call(this);
    this.dispatchEvent({type:"afterdispose"})
  }
})();
goog.require("jx.util");
goog.require("jx.events.EventDispatcher");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.provide("jx.data.DataManager");
(function() {
  goog.exportSymbol("jx.data.DataManager", DataManager);
  JGM._add("DataManager", DataManager);
  function DataManager(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.dataMgr = this;
    this.all = [];
    this.datalist = [];
    this.failed = [];
    var options = {__idKey_a__:undefined, __idColKeys_c__:[], uniqueKeys:[]};
    this._options = JGM.__extend_e__(options, args.options, {idKey:"__idKey_a__", idColKeys:"__idColKeys_c__"});
    this.__consts_n__ = {__auto_a__:0, __given_b__:1, __composite_c__:2, __notReal_d__:this.mid + "@NR" + Util.random(1E4), __add_e__:0, __addList_f__:1, __update_g__:2, __updateList_h__:3, __remove_i__:4, __removeList_j__:5, unknown:0, number:1, string:2, "boolean":3, date:4, "enum":5};
    if(Util.isNotNull(this._options.__idKey_a__)) {
      this.__idMode_m__ = this.__consts_n__.__given_b__;
      this.idKey = this._options.__idKey_a__
    }else {
      if(this._options.__idColKeys_c__.length !== 0) {
        this.__idMode_m__ = this.__consts_n__.__composite_c__;
        this.idKey = "J@I" + this.mid + "@" + Util.random(1E4)
      }else {
        this.__idMode_m__ = this.__consts_n__.__auto_a__;
        this.idKey = "J@I" + this.mid + "@" + Util.random(1E4)
      }
    }
    this.__increment_l__ = 0;
    this.keyToType = {};
    this.__idToIdx_b__ = {};
    this.__idToData_a__ = {};
    this.__sorter_h__;
    this.__filters_r__ = [];
    this.__history_e__ = [];
    this.__redoHistory_q__ = [];
    this.uniqueMap = {};
    this.__init(args)
  }
  DataManager.getInstance = function(args) {
    return new DataManager(args)
  };
  var prototype = DataManager.prototype;
  prototype.__init = function(args) {
    var i = 0, ukeys = this._options.uniqueKeys, ukey, umap = this.uniqueMap, len = ukeys.length, tmap = this.keyToType, colDefs = this.grid.colDefMgr.getAll(), colDef, key;
    for(;i < len;i++) {
      ukey = ukeys[i];
      if(typeof ukey === "string") {
        umap[ukey] = {}
      }
    }
    len = colDefs.length;
    for(i = 0;i < len;i++) {
      colDef = colDefs[i];
      key = colDef.key;
      if(colDef.hasOwnProperty("unique") && colDef.unique === true && !umap.hasOwnProperty(key)) {
        umap[key] = {}
      }
      tmap[key] = this.mapDatatype(colDef.type)
    }
    Util.ifNull(args.datalist, []);
    this.bindEvents();
    this.set(args.datalist)
  };
  prototype.mapDatatype = function(type) {
    if(typeof type === "string") {
      type = type.toLowerCase();
      switch(type) {
        case "number":
          return this.__consts_n__.number;
        case "string":
          return this.__consts_n__.string;
        case "boolean":
          return this.__consts_n__["boolean"];
        case "date":
          return this.__consts_n__.date;
        case "enum":
          return this.__consts_n__["enum"];
        default:
          return this.__consts_n__.unknown
      }
    }
    return this.__consts_n__.unknown
  };
  prototype.bindEvents = function() {
    this.grid.event.bind({onDestroy:this.__destroy_aA__, keydownCanvas:this.__keydownCanvas_ba__}, this)
  };
  prototype.__destroy_aA__ = function() {
    this.cleanList(this.all);
    JGM._destroy(this, {name:"DataManager", path:"dataMgr", property:"all __idMode_m__ __increment_l__ idKey __sorter_h__", map:"__consts_n__ __idToIdx_b__ __idToData_a__ _options", array:"datalist failed __history_e__ __redoHistory_q__ __filters_r__"})
  };
  prototype.addUniqueIndex = function(map, key, data, safe) {
    if(safe !== true) {
      if(Util.isNull(map) || Util.isEmptyString(key) || Util.isNull(data)) {
        return false
      }
    }
    if(data.hasOwnProperty(key) === false) {
      return this.grid.error("KEY_UNDEFINED", key)
    }
    var val;
    if(Util.isEmptyString(val = data[key])) {
      return this.grid.error("BAD_NULL", key)
    }
    if(map.hasOwnProperty(val)) {
      if(map[val] === data) {
        return false
      }
      return this.grid.error("DUP_ENTRY", val, key)
    }
    map[val] = data;
    return true
  };
  prototype.addUniqueIndices = function(map, key, list, safe) {
    if(safe !== true) {
      if(Util.isNull(map) || Util.isEmptyString(key) || Util.isEmptyArray(list)) {
        return false
      }
    }
    var i, len = list.length, success = [], val, data;
    for(i = 0;i < len;i++) {
      if(Util.isNull(data = list[i])) {
        continue
      }
      if(data.hasOwnProperty(key) === false) {
        this.removeUniqueIndices(map, key, success);
        return this.grid.error("KEY_UNDEFINED", key)
      }
      if(Util.isEmptyString(val = data[key])) {
        this.removeUniqueIndices(map, key, success);
        return this.grid.error("BAD_NULL", key)
      }
      if(map.hasOwnProperty(val)) {
        if(map[val] === data) {
          continue
        }
        this.removeUniqueIndices(map, key, success);
        return this.grid.error("DUP_ENTRY", val, key)
      }
      success.push(map[val] = data)
    }
    return success.length > 0
  };
  prototype.updateUniqueIndex = function(map, key, data, change, before, safe) {
    if(safe !== true) {
      if(Util.isEmptyObj(map) || Util.isEmptyString(key) || Util.isNullOr(data, before) || Util.isEmptyObj(change)) {
        return false
      }
    }
    if(change.hasOwnProperty(key) === false) {
      return false
    }
    var oldKey, newKey;
    if(before.hasOwnProperty(key) === false || data.hasOwnProperty(key) === false) {
      return this.grid.error("KEY_UNDEFINED", key)
    }
    if(map.hasOwnProperty(oldKey = before[key]) === false) {
      return this.grid.error("KEY_NOT_FOUND", oldKey, key)
    }
    if(Util.isEmptyString(newKey = change[key])) {
      return this.grid.error("BAD_NULL", key)
    }
    if(map.hasOwnProperty(newKey)) {
      if(map[newKey] === data) {
        return false
      }
      return this.grid.error("DUP_ENTRY", newKey, key)
    }
    map[newKey] = data;
    delete map[oldKey];
    return oldKey
  };
  prototype.updateUniqueIndices = function(map, key, list, changes, befores, safe) {
    if(safe !== true) {
      if(Util.isEmptyObj(map) || Util.isEmptyString(key) || Util.isEmptyArray(list) || Util.isEmptyArray(changes) || Util.isEmptyArray(befores)) {
        return false
      }
      if(list.length !== changes.length || list.length !== befores.length) {
        return this.grid.error("LENGTH_NOT_EQUAL")
      }
    }
    var i = 0, len = list.length, data, before, change, slist = [], schanges = [], sbefores = [], newKey, oldKey;
    for(;i < len;i++) {
      if(Util.isNull(data = list[i])) {
        continue
      }
      if((change = changes[i]).hasOwnProperty(key) === false) {
        continue
      }
      before = befores[i];
      if(before.hasOwnProperty(key) === false || data.hasOwnProperty(key) === false) {
        this.updateUniqueIndices(map, key, slist, sbefores, schanges);
        return this.grid.error("KEY_UNDEFINED", key)
      }
      if(map.hasOwnProperty(oldKey = before[key]) === false) {
        this.updateUniqueIndices(map, key, slist, sbefores, schanges);
        return this.grid.error("KEY_NOT_FOUND", oldKey, key)
      }
      if(Util.isEmptyString(newKey = change[key])) {
        this.updateUniqueIndices(map, key, slist, sbefores, schanges);
        return this.grid.error("BAD_NULL", key)
      }
      if(map.hasOwnProperty(newKey)) {
        if(map[newKey] === data) {
          continue
        }
        this.updateUniqueIndices(map, key, slist, sbefores, schanges);
        return this.grid.error("DUP_ENTRY", newKey, key)
      }
      map[newKey] = data;
      delete map[oldKey];
      slist.push(data);
      schanges.push(change);
      sbefores.push(before)
    }
    if(slist.length === 0) {
      return false
    }
    return{datalist:slist, changes:schanges, befores:sbefores}
  };
  prototype.removeUniqueIndex = function(map, key, data, safe) {
    if(safe !== true) {
      if(Util.isEmptyObj(map) || Util.isEmptyString(key) || Util.isEmptyObj(data)) {
        return
      }
    }
    var val;
    if(data.hasOwnProperty(key) && map.hasOwnProperty(val = data[key])) {
      delete map[val]
    }
  };
  prototype.removeUniqueIndices = function(map, key, list, safe) {
    if(safe !== true) {
      if(Util.isEmptyObj(map) || Util.isEmptyString(key) || Util.isEmptyArray(list)) {
        return
      }
    }
    var i, len = list.length, val, data;
    for(i = 0;i < len;i++) {
      data = list[i];
      if(data.hasOwnProperty(key) && map.hasOwnProperty(val = data[key])) {
        delete map[val]
      }
    }
  };
  prototype.addToUniqueMap = function(datarow) {
    if(Util.isEmptyObj(datarow) || Util.isEmptyObj(this.uniqueMap)) {
      return false
    }
    var added = [], key, umap = this.uniqueMap, res;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        res = this.addUniqueIndex(umap[key], key, datarow);
        if(res === true) {
          added.push(key)
        }else {
          if(res instanceof Error) {
            var i = 0, len = added.length;
            for(;i < len;i++) {
              this.removeUniqueIndex(umap[added[i]], added[i], datarow)
            }
            return res
          }
        }
      }
    }
    return added.length > 0
  };
  prototype.addListToUniqueMap = function(datalist) {
    if(Util.isEmptyArray(datalist) || Util.isEmptyObj(this.uniqueMap)) {
      return false
    }
    var umap = this.uniqueMap, success = [], key, res;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        res = this.addUniqueIndices(umap[key], key, datalist);
        if(res === true) {
          success.push(key)
        }else {
          if(res instanceof Error) {
            var i = 0, len = success.length;
            for(;i < len;i++) {
              this.removeUniqueIndices(umap[success[i]], success[i], datalist)
            }
            return res
          }
        }
      }
    }
    return success.length > 0
  };
  prototype.updateUniqueMap = function(datarow, change, before) {
    if(Util.isNullOr(datarow, change, before) || Util.isEmptyObj(this.uniqueMap)) {
      return false
    }
    var key, umap = this.uniqueMap, changed = [], res;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        res = this.updateUniqueIndex(umap[key], key, datarow, change, before);
        if(res instanceof Error) {
          var i = 0, len = changed.length;
          for(;i < len;i++) {
            this.updateUniqueIndex(umap[changed[i]], changed[i], datarow, before, change)
          }
          return res
        }
        if(res !== false) {
          changed.push(key)
        }
      }
    }
    return changed.length > 0
  };
  prototype.updateListUniqueMap = function(datalist, changes, befores) {
    if(Util.isEmptyArray(datalist) || Util.isEmptyArray(changes) || Util.isEmptyArray(befores) || Util.isEmptyObj(this.uniqueMap)) {
      return false
    }
    if(datalist.length !== changes.length || datalist.length !== befores.length) {
      return this.grid.error("LENGTH_NOT_EQUAL")
    }
    var key, umap = this.uniqueMap, changed = [], res;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        res = this.updateUniqueIndices(umap[key], key, datalist, changes, befores);
        if(res instanceof Error) {
          var i = 0, len = changed.length;
          for(;i < len;i++) {
            this.updateUniqueIndices(umap[changed[i]], changed[i], datalist, befores, changes)
          }
          return res
        }
        if(res !== false) {
          changed.push(key)
        }
      }
    }
    return changed.length > 0
  };
  prototype.removeFromUniqueMap = function(added) {
    if(Util.isEmptyObj(added) || Util.isEmptyObj(this.uniqueMap)) {
      return
    }
    var key, umap = this.uniqueMap;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        this.removeUniqueIndex(umap[key], key, added)
      }
    }
  };
  prototype.removeListFromUniqueMap = function(addedList) {
    if(Util.isEmptyArray(addedList) || Util.isEmptyObj(this.uniqueMap)) {
      return
    }
    var key, umap = this.uniqueMap;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        this.removeUniqueIndices(umap[key], key, addedList)
      }
    }
  };
  prototype.addToIdMap = function(datarow) {
    if(Util.isNull(datarow)) {
      return false
    }
    var idKey = this.idKey;
    switch(this.__idMode_m__) {
      case this.__consts_n__.__auto_a__:
        if(datarow.hasOwnProperty(idKey) === false) {
          datarow[idKey] = this.__increment_l__++
        }
      ;
      case this.__consts_n__.__given_b__:
      ;
      case this.__consts_n__.__composite_c__:
        return this.addUniqueIndex(this.__idToData_a__, idKey, datarow)
    }
    return false
  };
  prototype.addListToIdMap = function(datalist) {
    if(Util.isEmptyArray(datalist)) {
      return false
    }
    var idKey = this.idKey;
    switch(this.__idMode_m__) {
      case this.__consts_n__.__auto_a__:
        var i = 0, datarow, len = datalist.length;
        for(;i < len;i++) {
          if((datarow = datalist[i]).hasOwnProperty(idKey) === false) {
            datarow[idKey] = this.__increment_l__++
          }
        }
      ;
      case this.__consts_n__.__given_b__:
      ;
      case this.__consts_n__.__composite_c__:
        return this.addUniqueIndices(this.__idToData_a__, idKey, datalist)
    }
    return false
  };
  prototype.updateIdMap = function(datarow, change, before) {
    if(Util.isNullOr(datarow, before) || Util.isEmptyObj(change)) {
      return false
    }
    var idKey = this.idKey;
    switch(this.__idMode_m__) {
      case this.__consts_n__.__auto_a__:
        if(change.hasOwnProperty(idKey)) {
          return this.grid.error("NOT_MODIFIABLE", idKey)
        }
      ;
      case this.__consts_n__.__given_b__:
        return this.updateUniqueIndex(this.__idToData_a__, idKey, datarow, change, before);
      case this.__consts_n__.__composite_c__:
        if(change.hasOwnProperty(idKey)) {
          return this.grid.error("NOT_MODIFIABLE", idKey)
        }
        var idKeys = this._options.__idColKeys_c__, keylen = idKeys.length, i = 0;
        for(;i < keylen;i++) {
          if(change.hasOwnProperty(idKeys[i])) {
            var newId = "", oldId, j = 0, res, curIdKey, val, idChange = {}, idBefore = {};
            oldId = idBefore[idKey] = datarow[idKey];
            for(;j < keylen;j++) {
              curIdKey = idKeys[j];
              if(change.hasOwnProperty(curIdKey)) {
                if(Util.isEmptyString(val = change[curIdKey])) {
                  return this.grid.error("BAD_NULL", curIdKey)
                }
                newId += "&" + val
              }else {
                newId += "&" + datarow[curIdKey]
              }
            }
            datarow[idKey] = idChange[idKey] = newId;
            if(oldId === newId) {
              return false
            }
            res = this.updateUniqueIndex(this.__idToData_a__, idKey, datarow, idChange, idBefore);
            if(res instanceof Error) {
              datarow[idKey] = oldId
            }
            return res
          }
        }
        break
    }
    return false
  };
  prototype.updateListIdMap = function(datalist, changes, befores) {
    if(Util.isEmptyArray(datalist) || Util.isEmptyArray(changes) || Util.isEmptyArray(befores)) {
      return false
    }
    var idKey = this.idKey, len = datalist.length, i = 0;
    switch(this.__idMode_m__) {
      case this.__consts_n__.__auto_a__:
        for(;i < len;i++) {
          if(changes[i].hasOwnProperty(idKey)) {
            return this.grid.error("NOT_MODIFIABLE", idKey)
          }
        }
      ;
      case this.__consts_n__.__given_b__:
        return this.updateUniqueIndices(this.__idToData_a__, idKey, datalist, changes, befores);
      case this.__consts_n__.__composite_c__:
        var idMap = this.__idToData_a__, datarow, change, idKeys = this._options.__idColKeys_c__, keylen = idKeys.length, newId, oldIds = [], idChange, idBefore, list = [], idChanges = [], idBefores = [], j, k, curIdKey, val, res;
        for(;i < len;i++) {
          datarow = datalist[i];
          change = changes[i];
          if(change.hasOwnProperty(idKey)) {
            for(j = 0, len = oldIds.length;j < len;j++) {
              list[j][idKey] = oldIds[j]
            }
            return this.grid.error("NOT_MODIFIABLE", idKey)
          }
          for(j = 0;j < keylen;j++) {
            if(change.hasOwnProperty(idKeys[j])) {
              newId = "";
              for(k = 0;k < keylen;k++) {
                curIdKey = idKeys[k];
                if(change.hasOwnProperty(curIdKey)) {
                  if(Util.isEmptyString(val = change[curIdKey])) {
                    for(j = 0, len = oldIds.length;j < len;j++) {
                      list[j][idKey] = oldIds[j]
                    }
                    return this.grid.error("BAD_NULL", curIdKey)
                  }
                  newId += "&" + val
                }else {
                  newId += "&" + datarow[curIdKey]
                }
              }
              if(datarow[idKey] === newId) {
                continue
              }
              list.push(datarow);
              idChanges.push(idChange = {});
              idBefores.push(idBefore = {});
              oldIds.push(idBefore[idKey] = datarow[idKey]);
              datarow[idKey] = idChange[idKey] = newId
            }
          }
        }
        if(list.length === 0) {
          return false
        }
        res = this.updateUniqueIndices(idMap, idKey, list, idChanges, idBefores);
        if(res instanceof Error) {
          for(j = 0, len = oldIds.length;j < len;j++) {
            list[j][idKey] = oldIds[j]
          }
        }
        return res
    }
    return false
  };
  prototype.removeFromIdMap = function(datarow) {
    var idKey = this.idKey, idMap = this.__idToData_a__, val;
    if(Util.isNotNull(datarow) && datarow.hasOwnProperty(idKey) && idMap.hasOwnProperty(val = datarow[idKey])) {
      delete idMap[val]
    }
  };
  prototype.removeListFromIdMap = function(datalist) {
    if(Util.isEmptyArray(datalist)) {
      return
    }
    var idKey = this.idKey, datalen = datalist.length, idMap = this.__idToData_a__, val, datarow, i = 0;
    for(;i < datalen;i++) {
      datarow = datalist[i];
      if(datarow.hasOwnProperty(idKey) && idMap.hasOwnProperty(val = datarow[idKey])) {
        delete idMap[val]
      }
    }
  };
  prototype.fillTemp = function(datarow, args) {
    if(Util.isNull(datarow)) {
      return
    }
    var colDefs = this.grid.colDefMgr.getAll(), clen = colDefs.length, key, isNew = args !== undefined && args.isNew, colDef, i = 0;
    if(isNew) {
      for(;i < clen;i++) {
        colDef = colDefs[i];
        key = colDef.key;
        if(colDef.nullOnCreate && Util.isNull(datarow[key])) {
          datarow[key] = "J@H" + this.__increment_l__++
        }
      }
    }
  };
  prototype.fillTempList = function(datalist, args) {
    if(Util.isEmptyArray(datalist)) {
      return
    }
    var colDefs = this.grid.colDefMgr.getAll(), clen = colDefs.length, len = datalist.length, key, isNew = args !== undefined && args.isNew, colDef, i = 0, j;
    if(isNew) {
      for(;i < clen;i++) {
        colDef = colDefs[i];
        key = colDef.key;
        if(colDef.nullOnCreate) {
          for(j = 0;len;j++) {
            datalist[j][key] = "J@H" + this.__increment_l__++
          }
        }
      }
    }
  };
  prototype.query = function(query) {
    if(typeof query !== "string") {
      return
    }
    query = $.trim(query);
    if(query.length === 0) {
      return
    }
    var lquery, opIndex, op, stmt, whereIndex, hasWhere, where;
    lquery = query.toLowerCase();
    opIndex = query.indexOf(" ");
    if(opIndex === -1) {
      return
    }
    op = lquery.substring(0, opIndex);
    whereIndex = lquery.indexOf(" where ");
    hasWhere = whereIndex > -1;
    stmt = $.trim(hasWhere ? query.substring(opIndex + 1, whereIndex) : query.substring(opIndex + 1));
    if(stmt.length === 0) {
      return
    }
    if(hasWhere) {
      where = $.trim(query.substring(whereIndex + 7))
    }
    switch(op) {
      case "select":
        return this.executeSelect(stmt, where);
      case "insert":
        return this.executeInsert(stmt, where);
      case "update":
        return this.executeUpdate(stmt, where);
      case "delete":
        return this.executeDelete(stmt, where)
    }
  };
  prototype.parseWhere = function(where) {
    if(typeof where !== "string") {
      return
    }
    where = $.trim(where);
    if(where.length === 0) {
      return
    }
  };
  prototype.executeSelect = function(select, condition) {
    var temp = Util.split(select, /[\s,]+/), len = temp.length, i = 0, attr = {}, list = this.all, res = [], all = false;
    if(len === 0) {
      return res
    }
    for(;i < len;i++) {
      if(temp[i] === "*") {
        all = true;
        break
      }
      attr[temp[i]] = true
    }
    i = 0;
    len = list.length;
    for(;i < len;i++) {
      res.push(Util.clone(list[i], attr))
    }
    return res
  };
  prototype.parse = function(datarow, args) {
    if(Util.isNull(datarow)) {
      return false
    }
    var colDefs = this.grid.colDefMgr.getAll(), clen = colDefs.length, parser, key, isNew = args !== undefined && args.isNew, colDef, i = 0;
    for(;i < clen;i++) {
      colDef = colDefs[i];
      if(isNew && colDef.nullOnCreate) {
        continue
      }
      if(Util.isFunction(parser = colDef.parser)) {
        key = colDef.key;
        if(datarow.hasOwnProperty(key)) {
          try {
            datarow[key] = parser(datarow[key], datarow)
          }catch(e) {
            if(Util.isNull(datarow)) {
              return this.grid.error("PARSE_ERROR", datarow, key)
            }else {
              return this.grid.error("PARSE_ERROR", datarow[key], key)
            }
          }
        }
      }
    }
    return true
  };
  prototype.parseList = function(list, args) {
    if(Util.isNull(list)) {
      return false
    }
    if(list.length === 0) {
      return true
    }
    var colDefs = this.grid.colDefMgr.getAll(), clen = colDefs.length, len = list.length, parser, key, i = 0, j, isNew = args !== undefined && args.isNew, colDef, datarow;
    for(;i < clen;i++) {
      colDef = colDefs[i];
      if(isNew && colDef.nullOnCreate) {
        continue
      }
      if(Util.isFunction(parser = colDef.parser)) {
        key = colDef.key;
        try {
          for(j = 0;j < len;j++) {
            datarow = list[j];
            if(datarow.hasOwnProperty(key)) {
              datarow[key] = parser(datarow[key], datarow)
            }
          }
        }catch(e) {
          if(Util.isNull(datarow)) {
            return this.grid.error("PARSE_ERROR", datarow, key)
          }else {
            return this.grid.error("PARSE_ERROR", datarow[key], key)
          }
        }
      }
    }
    return true
  };
  prototype.validate = function(datarow, args) {
    if(Util.isNull(datarow)) {
      return false
    }
    var colDefs = this.grid.colDefMgr.getAll(), clen = colDefs.length, validator, colDef, key, isnull, emptystr, val, stringval, test, isNew = args !== undefined && args.isNew, i = 0;
    for(;i < clen;i++) {
      colDef = colDefs[i];
      key = colDef.key;
      val = undefined;
      isnull = false;
      emptystr = false;
      if(isNew && colDef.nullOnCreate) {
        continue
      }
      if(colDef.notNull === true) {
        if(datarow.hasOwnProperty(key) === false || Util.isEmptyString(val = datarow[key])) {
          return this.grid.error("BAD_NULL", key)
        }
        stringval = val.toString()
      }else {
        if(datarow.hasOwnProperty(key) === false || Util.isNull(val = datarow[key])) {
          isnull = true;
          emptystr = true
        }else {
          if(val === "") {
            emptystr = true
          }
        }
        if(isnull === false) {
          stringval = val.toString()
        }else {
          stringval = ""
        }
      }
      if(isnull === false) {
        if(Util.isNotNull(test = colDef.max)) {
          if(emptystr === false && val > test) {
            return this.grid.error("BIGGER_THAN", val, key, test)
          }
        }
        if(Util.isNotNull(test = colDef.min)) {
          if(emptystr === false && val < test) {
            return this.grid.error("SMALLER_THAN", val, key, test)
          }
        }
        if(Util.isNotNull(test = colDef.length)) {
          if(emptystr === true || stringval.length !== test) {
            return this.grid.error("WRONG_LENGTH", stringval, test, key)
          }
        }else {
          if(Util.isNotNull(test = colDef.maxlength)) {
            if(emptystr === false && stringval.length > test) {
              return this.grid.error("DATA_TOO_LONG", stringval, key, test)
            }
          }
          if(Util.isNotNull(test = colDef.minlength)) {
            if(emptystr === true || stringval.length < test) {
              return this.grid.error("DATA_TOO_SHORT", stringval, key, test)
            }
          }
        }
      }
      if(Util.isFunction(validator = colDef.validator)) {
        try {
          if(validator(val, datarow, stringval, isnull, emptystr) !== true) {
            return this.grid.error("WRONG_VALUE", stringval, key)
          }
        }catch(e) {
          return this.grid.error("WRONG_VALUE", stringval, key)
        }
      }
    }
    return true
  };
  prototype.validateList = function(list, args) {
    if(Util.isNull(list)) {
      return false
    }
    if(list.length === 0) {
      return true
    }
    var colDefs = this.grid.colDefMgr.getAll(), clen = colDefs.length, len = list.length, validator, colDef, key, i = 0, j, nulls, emptystrs, val, test, isNew = args !== undefined && args.isNew, vals = [], stringvals = [];
    for(;i < clen;i++) {
      colDef = colDefs[i];
      key = colDef.key;
      nulls = {};
      emptystrs = {};
      vals.length = 0;
      stringvals.length = 0;
      if(isNew && colDef.nullOnCreate) {
        continue
      }
      if(colDef.notNull === true) {
        for(j = 0;j < len;j++) {
          if(list[j].hasOwnProperty(key) === false || Util.isEmptyString(val = list[j][key])) {
            return this.grid.error("BAD_NULL", key)
          }
          vals.push(val);
          stringvals.push(val.toString())
        }
      }else {
        for(j = 0;j < len;j++) {
          val = undefined;
          if(list[j].hasOwnProperty(key) === false || Util.isNull(val = list[j][key])) {
            nulls[j] = true;
            emptystrs[j] = true
          }else {
            if(val === "") {
              emptystrs[j] = true
            }
          }
          vals.push(val);
          if(nulls.hasOwnProperty(j)) {
            stringvals.push("")
          }else {
            stringvals.push(val.toString())
          }
        }
      }
      if(Util.isNotNull(test = colDef.max)) {
        for(j = 0;j < len;j++) {
          if(emptystrs.hasOwnProperty(j) === false && vals[j] > test) {
            return this.grid.error("BIGGER_THAN", vals[j], key, test)
          }
        }
      }
      if(Util.isNotNull(test = colDef.min)) {
        for(j = 0;j < len;j++) {
          if(emptystrs.hasOwnProperty(j) === false && vals[j] < test) {
            return this.grid.error("SMALLER_THAN", vals[j], key, test)
          }
        }
      }
      if(Util.isNotNull(test = colDef.length)) {
        for(j = 0;j < len;j++) {
          if(nulls.hasOwnProperty(j) === false && (emptystrs.hasOwnProperty(j) || stringvals[j].length !== test)) {
            return this.grid.error("WRONG_LENGTH", stringvals[j], test, key)
          }
        }
      }else {
        if(Util.isNotNull(test = colDef.maxlength)) {
          for(j = 0;j < len;j++) {
            if(emptystrs.hasOwnProperty(j) === false && stringvals[j].length > test) {
              return this.grid.error("DATA_TOO_LONG", stringvals[j], key, test)
            }
          }
        }
        if(Util.isNotNull(test = colDef.minlength)) {
          for(j = 0;j < len;j++) {
            if(nulls.hasOwnProperty(j) === false && (emptystrs.hasOwnProperty(j) || stringvals[j].length < test)) {
              return this.grid.error("DATA_TOO_SHORT", stringvals[j], key, test)
            }
          }
        }
      }
      if(Util.isFunction(validator = colDef.validator)) {
        try {
          for(j = 0;j < len;j++) {
            if(validator(vals[j], list[j], stringvals[j], nulls.hasOwnProperty(j), emptystrs.hasOwnProperty(j)) !== true) {
              return this.grid.error("WRONG_VALUE", stringvals[j], key)
            }
          }
        }catch(e) {
          return this.grid.error("WRONG_VALUE", stringvals[j], key)
        }
      }
    }
    return true
  };
  prototype.makeCompositeKey = function(datarow, update) {
    if(this.__idMode_m__ !== this.__consts_n__.__composite_c__ || Util.isNull(datarow)) {
      return
    }
    if(update === true || datarow.hasOwnProperty(this.idKey) === false) {
      var idColKeys = this._options.__idColKeys_c__, keylen = idColKeys.length, i = 0, id = "";
      for(;i < keylen;i++) {
        id += "&" + datarow[idColKeys[i]]
      }
      datarow[this.idKey] = id
    }
  };
  prototype.makeCompositeKeyList = function(datalist, update) {
    if(this.__idMode_m__ !== this.__consts_n__.__composite_c__ || datalist.length === 0) {
      return
    }
    var idKey = this.idKey, datalen = datalist.length, idColKeys = this._options.__idColKeys_c__, keylen = idColKeys.length, data, i = 0, j, id;
    if(update === true) {
      for(;i < datalen;i++) {
        data = datalist[i];
        id = "";
        j = 0;
        for(;j < keylen;j++) {
          id += "&" + data[idColKeys[j]]
        }
        data[idKey] = id
      }
    }else {
      for(;i < datalen;i++) {
        if((data = datalist[i]).hasOwnProperty(idKey) === false) {
          id = "";
          j = 0;
          for(;j < keylen;j++) {
            id += "&" + data[idColKeys[j]]
          }
          data[idKey] = id
        }
      }
    }
  };
  prototype.map = function(datarow) {
    if(Util.isNull(datarow)) {
      return
    }
    var idMap = this.__idToData_a__, idKey = this.idKey, id;
    this.makeCompositeKey(datarow);
    if(datarow.hasOwnProperty(idKey) && idMap.hasOwnProperty(id = datarow[idKey])) {
      return idMap[id]
    }
  };
  prototype.mapList = function(list) {
    if(Util.isEmptyArray(list)) {
      return{mapped:[], unmapped:[]}
    }
    this.makeCompositeKeyList(list);
    var mapped = [], unmapped = [], idKey = this.idKey, idMap = this.__idToData_a__, len = list.length, i = 0, datarow, id;
    for(;i < len;i++) {
      if((datarow = list[i]).hasOwnProperty(idKey) && idMap.hasOwnProperty(id = datarow[idKey])) {
        mapped.push(idMap[id])
      }else {
        unmapped.push(datarow)
      }
    }
    return{mapped:mapped, unmapped:unmapped}
  };
  prototype.getById = function(id) {
    if(Util.isNotNull(id) && this.__idToData_a__.hasOwnProperty(id)) {
      return this.__idToData_a__[id]
    }
  };
  prototype.getByIdx = function(i) {
    if(Util.isNotNull(i) && this.datalist.hasOwnProperty(i)) {
      return this.datalist[i]
    }
  };
  prototype.getByNode = function(node) {
    return this.getById(this.getIdByNode(node))
  };
  prototype.getIdx = function(datarow) {
    return this.getIdxById(this.getId(datarow))
  };
  prototype.getIdxById = function(id) {
    if(Util.isNotNull(id) && this.__idToIdx_b__.hasOwnProperty(id)) {
      return this.__idToIdx_b__[id]
    }
    return-1
  };
  prototype.getIdxByNode = function(node) {
    return this.getIdxById(this.getIdByNode(node))
  };
  prototype.getId = function(datarow) {
    if(Util.isNotNull(datarow) && datarow.hasOwnProperty(this.idKey)) {
      return datarow[this.idKey]
    }
  };
  prototype.getIdByIdx = function(i) {
    return this.getId(this.getByIdx(i))
  };
  prototype.getIdByNode = function(node) {
    if(Util.isNotNull(node)) {
      return node.getAttribute("i")
    }
  };
  prototype.__reidxFrom_f__ = function(from) {
    if(Util.isNull(from)) {
      from = 0
    }
    var datalist = this.datalist, datalen = datalist.length, idKey = this.idKey, idxMap = this.__idToIdx_b__, i = from;
    for(;i < datalen;i++) {
      idxMap[datalist[i][idKey]] = i
    }
  };
  prototype.__reidx_g__ = function(from) {
    this.__idToIdx_b__ = {};
    this.__reidxFrom_f__()
  };
  prototype.has = function(datarow) {
    return this.hasById(this.getId(datarow))
  };
  prototype.hasById = function(id) {
    if(Util.isNotNull(id)) {
      return this.__idToIdx_b__.hasOwnProperty(id)
    }
    return false
  };
  prototype.contains = function(datarow) {
    return this.containsById(this.getId(datarow))
  };
  prototype.containsById = function(id) {
    if(Util.isNotNull(id)) {
      return this.__idToData_a__.hasOwnProperty(id)
    }
    return false
  };
  prototype.set = function(datalist) {
    if(this.all === datalist || Util.isEmptyArray(datalist) && this.all === 0) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.grid.event.trigger("onBeforeSetDatalist", [this.all, datalist]);
    this.cleanList(this.all);
    var key, umap = this.uniqueMap;
    for(key in umap) {
      if(umap.hasOwnProperty(key)) {
        umap[key] = {}
      }
    }
    this.__idToData_a__ = {};
    this.all = [];
    this.__history_e__.length = 0;
    this.__redoHistory_q__.length = 0;
    if(Util.isNull(datalist)) {
      datalist = []
    }
    var res;
    if((res = this.parseList(datalist)) instanceof Error) {
      return res
    }
    if((res = this.validateList(datalist)) instanceof Error) {
      return res
    }
    if((res = this.addListToUniqueMap(datalist)) instanceof Error) {
      return res
    }
    this.makeCompositeKeyList(datalist, true);
    if((res = this.addListToIdMap(datalist)) instanceof Error) {
      return res
    }
    this.all = datalist;
    this.grid.event.trigger("onAfterSetDatalist", [datalist]);
    this.grid.event.trigger("onDataChange");
    this.refresh();
    return true
  };
  prototype.add = function(datarow, args) {
    if(Util.isNull(datarow) || Util.isNotNull(this.map(datarow))) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.fillTemp(datarow, args);
    var res;
    if((res = this.parse(datarow, args)) instanceof Error) {
      return res
    }
    if((res = this.validate(datarow, args)) instanceof Error) {
      return res
    }
    if((res = this.addToUniqueMap(datarow)) instanceof Error) {
      return res
    }
    if((res = this.addToIdMap(datarow)) instanceof Error) {
      return res
    }
    this.all.push(datarow);
    if(Util.isNull(args) || args.undo !== true) {
      this.__history_e__.push({__action_a__:this.__consts_n__.__add_e__, __target_b__:datarow});
      this.__redoHistory_q__.length = 0
    }
    this.grid.event.trigger("onAddDatarow", [datarow, args]);
    this.grid.event.trigger("onDataChange");
    if(args === undefined || args.noRefresh !== true) {
      this.refresh(args)
    }
    return true
  };
  prototype.addList = function(datalist, args) {
    if(Util.isEmptyArray(datalist)) {
      return false
    }
    var toAdd = this.mapList(datalist).unmapped;
    if(toAdd.length === 0) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.fillTempList(datalist, args);
    var res;
    if((res = this.parseList(toAdd, args)) instanceof Error) {
      return res
    }
    if((res = this.validateList(toAdd, args)) instanceof Error) {
      return res
    }
    if((res = this.addListToUniqueMap(toAdd)) instanceof Error) {
      return res
    }
    if((res = this.addListToIdMap(toAdd)) instanceof Error) {
      return res
    }
    this.all.pushList(toAdd);
    if(Util.isNull(args) || args.undo !== true) {
      this.__history_e__.push({__action_a__:this.__consts_n__.__addList_f__, __target_b__:toAdd});
      this.__redoHistory_q__.length = 0
    }
    this.grid.event.trigger("onAddDatalist", [toAdd, args]);
    this.grid.event.trigger("onDataChange");
    if(args === undefined || args.noRefresh !== true) {
      this.refresh(args)
    }
    return true
  };
  prototype.updateByKey = function(datarow, key, value, args) {
    var change = {};
    change[key] = value;
    return this.update(datarow, change, args)
  };
  prototype.update = function(datarow, change, args) {
    if(Util.isNullOr(datarow, change)) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.grid.event.trigger("onBeforeUpdateDatarow", [datarow, change]);
    var before = {}, i;
    for(i in change) {
      if(change.hasOwnProperty(i)) {
        if(datarow[i] === change[i]) {
          delete change[i]
        }else {
          before[i] = datarow[i];
          datarow[i] = change[i]
        }
      }
    }
    if(Util.isEmptyObj(before)) {
      return false
    }
    var res;
    if((res = this.parse(datarow, args)) instanceof Error) {
      this.__rollback_o__(datarow, before);
      return res
    }
    if((res = this.validate(datarow, args)) instanceof Error) {
      this.__rollback_o__(datarow, before);
      return res
    }
    if((res = this.updateUniqueMap(datarow, change, before)) instanceof Error) {
      this.__rollback_o__(datarow, before);
      return res
    }
    if((res = this.updateIdMap(datarow, change, before)) instanceof Error) {
      this.__rollback_o__(datarow, before);
      return res
    }
    if(res !== false) {
      this.grid.event.trigger("onIdChange", [datarow, res, datarow[this.idKey]])
    }
    if(Util.isNull(args) || args.undo !== true) {
      this.__history_e__.push({__action_a__:this.__consts_n__.__update_g__, __target_b__:datarow, __before_c__:before, __change_d__:change});
      this.__redoHistory_q__.length = 0
    }
    this.grid.event.trigger("onUpdateDatarow", [datarow, change, before, args]);
    this.grid.event.trigger("onDataChange");
    if(args === undefined || args.noRefresh !== true) {
      this.refresh(args)
    }
    return true
  };
  prototype.updateList = function(list, args) {
    if(Util.isEmptyArray(list)) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.grid.event.trigger("onBeforeUpdateDatalist", [list]);
    var datalist = [], befores = [], changes = [], datarow, before, change, listlen = list.length, i = 0, key;
    for(;i < listlen;i++) {
      before = {};
      datarow = list[i].datarow;
      change = list[i].change;
      for(key in change) {
        if(change.hasOwnProperty(key)) {
          if(datarow[key] === change[key]) {
            delete change[key]
          }else {
            before[key] = datarow[key];
            datarow[key] = change[key]
          }
        }
      }
      if(Util.isNotEmptyObj(before)) {
        datalist.push(datarow);
        befores.push(before);
        changes.push(change)
      }
    }
    if(datalist.length === 0) {
      return false
    }
    var res;
    if((res = this.parseList(datalist, args)) instanceof Error) {
      this.__rollbackList_p__(datalist, befores);
      return res
    }
    if((res = this.validateList(datalist, args)) instanceof Error) {
      this.__rollbackList_p__(datalist, befores);
      return res
    }
    if((res = this.updateListUniqueMap(datalist, changes, befores)) instanceof Error) {
      this.__rollbackList_p__(datalist, befores);
      return res
    }
    if((res = this.updateListIdMap(datalist, changes, befores)) instanceof Error) {
      this.__rollbackList_p__(datalist, befores);
      return res
    }
    if(res !== false) {
      this.grid.event.trigger("onIdListChange", [res.list, res.befores, this.idKey])
    }
    if(Util.isNull(args) || args.undo !== true) {
      this.__history_e__.push({__action_a__:this.__consts_n__.__updateList_h__, __target_b__:datalist, __before_c__:befores, __change_d__:changes});
      this.__redoHistory_q__.length = 0
    }
    this.grid.event.trigger("onUpdateDatalist", [datalist, changes, befores, args]);
    this.grid.event.trigger("onDataChange");
    if(args === undefined || args.noRefresh !== true) {
      this.refresh(args)
    }
    return true
  };
  prototype.__rollback_o__ = function(datarow, before) {
    var i;
    for(i in before) {
      if(before.hasOwnProperty(i)) {
        datarow[i] = before[i]
      }
    }
  };
  prototype.__rollbackList_p__ = function(datalist, befores) {
    var len = datalist.length, i = 0, datarow, before, j;
    for(;i < len;i++) {
      datarow = datalist[i];
      before = befores[i];
      for(j in before) {
        if(before.hasOwnProperty(j)) {
          datarow[j] = before[j]
        }
      }
    }
  };
  prototype.remove = function(datarow, args) {
    if(Util.isNull(datarow)) {
      return false
    }
    var mapped = this.map(datarow);
    if(Util.isNull(mapped)) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.removeFromIdMap(mapped);
    this.removeFromUniqueMap(mapped);
    this.all.remove(mapped);
    this.removeId(mapped);
    if(Util.isNull(args) || args.undo !== true) {
      this.__history_e__.push({__action_a__:this.__consts_n__.__remove_i__, __target_b__:mapped});
      this.__redoHistory_q__.length = 0
    }
    this.grid.event.trigger("onRemoveDatarow", [mapped, args]);
    this.grid.event.trigger("onDataChange");
    if(args === undefined || args.noRefresh !== true) {
      this.refresh(args)
    }
    return true
  };
  prototype.removeList = function(datalist, args) {
    if(Util.isEmptyArray(datalist)) {
      return false
    }
    var map = this.mapList(datalist), mapped = map.mapped;
    if(mapped.length === 0) {
      return false
    }
    this.grid.event.trigger("onBeforeDataChange");
    this.removeListFromIdMap(mapped);
    this.removeListFromUniqueMap(mapped);
    this.all.removeList(mapped);
    this.cleanList(mapped);
    if(Util.isNull(args) || args.undo !== true) {
      this.__history_e__.push({__action_a__:this.__consts_n__.__removeList_j__, __target_b__:mapped});
      this.__redoHistory_q__.length = 0
    }
    this.grid.event.trigger("onRemoveDatalist", [mapped, args]);
    this.grid.event.trigger("onDataChange");
    if(args === undefined || args.noRefresh !== true) {
      this.refresh(args)
    }
    return true
  };
  prototype.__keydownCanvas_ba__ = function(e) {
    if(e.ctrlKey) {
      switch(e.which) {
        case "Z".charCodeAt(0):
          this.undo();
          break;
        case "Y".charCodeAt(0):
          this.redo();
          break
      }
    }
  };
  prototype.undo = function() {
    if(this.__history_e__.length === 0) {
      return false
    }
    var hist = this.__history_e__.pop();
    this.__redoHistory_q__.push(hist);
    var tar = hist.__target_b__, bef = hist.__before_c__;
    switch(hist.__action_a__) {
      case this.__consts_n__.__add_e__:
        return this.remove(tar, {undo:true});
      case this.__consts_n__.__addList_f__:
        return this.removeList(tar, {undo:true});
      case this.__consts_n__.__update_g__:
        return this.update(tar, bef, {undo:true});
      case this.__consts_n__.__updateList_h__:
        var list = [], i = 0, len = tar.length;
        for(;i < len;i++) {
          list.push({datarow:tar[i], change:bef[i]})
        }
        return this.updateList(list, {undo:true});
      case this.__consts_n__.__remove_i__:
        return this.add(tar, {undo:true});
      case this.__consts_n__.__removeList_j__:
        return this.addList(tar, {undo:true})
    }
  };
  prototype.redo = function() {
    if(this.__redoHistory_q__.length === 0) {
      return false
    }
    var hist = this.__redoHistory_q__.pop();
    this.__history_e__.push(hist);
    var tar = hist.__target_b__;
    var cha = hist.__change_d__;
    switch(hist.__action_a__) {
      case this.__consts_n__.__add_e__:
        return this.add(tar, {undo:true});
      case this.__consts_n__.__addList_f__:
        return this.addList(tar, {undo:true});
      case this.__consts_n__.__update_g__:
        return this.update(tar, cha, {undo:true});
      case this.__consts_n__.__updateList_h__:
        var list = [], i = 0, len = tar.length;
        for(;i < len;i++) {
          list.push({datarow:tar[i], change:cha[i]})
        }
        return this.updateList(list, {undo:true});
      case this.__consts_n__.__remove_i__:
        return this.remove(tar, {undo:true});
      case this.__consts_n__.__removeList_j__:
        return this.removeList(tar, {undo:true})
    }
  };
  prototype.equals = function(a, b) {
    if(Util.isNullOr(a, b)) {
      return false
    }
    if(a === b) {
      return true
    }
    if(this.__idMode_m__ === this.__consts_n__.__composite_c__) {
      this.makeCompositeKey(a);
      this.makeCompositeKey(b)
    }
    var idKey = this.idKey;
    if(Util.isNull(a[idKey]) || Util.isNull(b[idKey])) {
      return false
    }
    return a[idKey] === b[idKey]
  };
  prototype.getReal = function() {
    var notReal = this.__consts_n__.__notReal_d__;
    return this.all.filter(function(datarow) {
      return datarow.hasOwnProperty(notReal) === false
    })
  };
  prototype.filterReal = function(list) {
    var notReal = this.__consts_n__.__notReal_d__;
    return list.filter(function(datarow) {
      return datarow.hasOwnProperty(notReal) === false
    })
  };
  prototype.isReal = function(datarow) {
    return Util.isNotNull(datarow) && datarow.hasOwnProperty(this.__consts_n__.__notReal_d__) === false
  };
  prototype.dropNonReal = function(datalist) {
    if(Util.isEmptyArray(datalist)) {
      return
    }
    var notReal = this.__consts_n__.__notReal_d__, len = datalist.length, i = len - 1;
    for(;i >= 0;i--) {
      if(datalist[i].hasOwnProperty(notReal)) {
        delete datalist[i][notReal];
        datalist.removeAt(i)
      }
    }
  };
  prototype.removeIdCol = function(datalist) {
    if(this.__idMode_m__ === this.__consts_n__.__given_b__ || Util.isEmptyArray(datalist)) {
      return
    }
    var idKey = this.idKey, i = 0, len = datalist.length;
    for(;i < len;i++) {
      if(datalist[i].hasOwnProperty(idKey)) {
        delete datalist[i][idKey]
      }
    }
  };
  prototype.removeId = function(datarow) {
    if(Util.isNotNull(datarow) && this.__idMode_m__ !== this.__consts_n__.__given_b__ && datarow.hasOwnProperty(this.idKey)) {
      delete datarow[this.idKey]
    }
  };
  prototype.cleanList = function(datalist) {
    if(!Util.isEmptyArray(datalist)) {
      this.removeIdCol(datalist);
      this.dropNonReal(datalist)
    }
  };
  prototype.purify = function(datalist) {
    if(datalist !== undefined) {
      datalist = this.all
    }
    if(Util.isEmptyArray(datalist)) {
      return[]
    }
    var list = [], len = datalist.length, i = 0, j, data, clone, notReal = this.__consts_n__.__notReal_d__;
    for(;i < len;i++) {
      if((data = datalist[i]).hasOwnProperty(notReal) === false) {
        list.push(clone = {});
        for(j in data) {
          if(data.hasOwnProperty(j)) {
            if(data.hasOwnProperty(j) && j.substring(0, 3) !== "J@I") {
              clone[j] = data[j]
            }
          }
        }
      }
    }
    return list
  };
  prototype.setSorter = function(sorter) {
    this.grid.event.trigger("onChangeSorter", [this.__sorter_h__, sorter]);
    this.__sorter_h__ = sorter
  };
  prototype.__sort_i__ = function(sorter) {
    if(Util.isNull(sorter)) {
      sorter = this.__sorter_h__
    }else {
      this.setSorter(sorter)
    }
    if(Util.isNull(sorter)) {
      return
    }
    var datalist = this.all;
    this.grid.event.trigger("onBeforeSort", [datalist]);
    if(Util.isNotNull(sorter.comparator)) {
      datalist.sort(sorter.comparator);
      if(sorter.desc) {
        datalist.reverse()
      }
    }else {
      if(Util.isNotNull(sorter.lexi)) {
        this.constructor.__lexi_a__(datalist, sorter.lexi, sorter.desc)
      }
    }
    this.grid.event.trigger("onAfterSort", [datalist])
  };
  prototype.addFilter = function(filter) {
    this.__filters_r__.push(filter);
    this.refresh()
  };
  prototype.removeFilter = function(filter) {
    var len = this.__filters_r__.length;
    this.__filters_r__.remove(filter);
    if(len !== this.__filters_r__.length) {
      this.refresh()
    }
  };
  prototype.__filter_j__ = function() {
    var datalist = this.datalist, failed = this.failed, i = 0, filters = this.__filters_r__, flen = filters.length, filter, j;
    this.grid.event.trigger("onBeforeFilter", [datalist, failed]);
    datalist.length = 0;
    datalist.pushList(this.all);
    failed.length = 0;
    for(;i < flen;i++) {
      filter = this.__filters_r__[i];
      for(j = datalist.length - 1;j >= 0;j--) {
        if(!filter(datalist[j])) {
          failed.push(datalist[j]);
          datalist.removeAt(j)
        }
      }
    }
    this.grid.event.trigger("onFilter", [datalist, failed]);
    this.grid.event.trigger("onAfterFilter", [datalist, failed])
  };
  prototype.__finish_k__ = function(args) {
    this.__reidx_g__();
    this.grid.event.trigger("onAfterRefresh", [args])
  };
  prototype.refresh = function(args) {
    this.grid.event.trigger("onBeforeRefresh");
    if(args === undefined) {
      this.__sort_i__()
    }else {
      if(args.noSort !== true) {
        this.__sort_i__(args.sorter)
      }
    }
    if(args === undefined || args.noFilter !== true) {
      this.__filter_j__()
    }
    this.__finish_k__(args)
  };
  prototype.exportRowToArray = function(index, keys) {
    if(!(index in this.datalist)) {
      return null
    }
    if(!keys) {
      keys = this.grid.colDefMgr.getKeys()
    }
    var datarow = this.datalist[index], array = [], key, i = 0, l = keys.length;
    for(;i < l;i++) {
      key = keys[i];
      array.push(key in datarow ? datarow[key] : null)
    }
    return array
  };
  prototype.exportToArray = function(keys, from, to) {
    if(!keys) {
      keys = this.grid.colDefMgr.getKeys()
    }
    var datalist = this.datalist.slice(from, to), array, arr = [], datarow, key, j = 0, jl = datalist.length, i, l = keys.length;
    for(;j < jl;j++) {
      datarow = datalist[j];
      for(i = 0, array = [];i < l;i++) {
        key = keys[i];
        array.push(key in datarow ? datarow[key] : null)
      }
      arr.push(array)
    }
    return arr
  };
  DataManager.__lexi_a__ = function(datalist, key, desc) {
    var oldToString = Object.prototype.toString;
    Object.prototype.toString = Util.isFunction(key) ? key : function() {
      return this[key]
    };
    datalist.sort();
    Object.prototype.toString = oldToString;
    if(desc) {
      datalist.reverse()
    }
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.provide("jx.grid.EventManager");
(function() {
  goog.exportSymbol("jx.grid.EventManager", EventManager);
  JGM._add("EventManager", EventManager);
  function EventManager(args) {
    this.mid = args.mid;
    args.grid.event = this;
    this.__map_a__ = {}
  }
  EventManager.getInstance = function(args) {
    return new EventManager(args)
  };
  var prototype = EventManager.prototype;
  prototype.destroy = function() {
    var i, map = this.__map_a__;
    for(i in map) {
      if(map.hasOwnProperty(i)) {
        JGM.__deleteArray_r__(map, i)
      }
    }
    JGM._destroy(this, {name:"EventManager", path:"event", map:"__map_a__"})
  };
  prototype.register = function(events, fn, target) {
    if(Util.isString(events)) {
      this.__parseAndAdd_b__(events, fn, target)
    }else {
      if(Util.isNotNull(events.e)) {
        this.__parseAndAdd_b__(events.e, events.f, events.t)
      }else {
        var i, len = events.length, e;
        for(;i < len;i++) {
          if(Util.isNotNull(e = events[i])) {
            this.__parseAndAdd_b__(e.e, e.f, e.t)
          }
        }
      }
    }
  };
  prototype.bind = function(events, fn, target) {
    if(Util.isString(events)) {
      this.__parseAndAdd_b__(events, fn, target)
    }else {
      var e;
      for(e in events) {
        if(events.hasOwnProperty(e)) {
          this.__parseAndAdd_b__(e, events[e], fn)
        }
      }
    }
  };
  prototype.__parseAndAdd_b__ = function(events, fn, target) {
    if(Util.isNull(target)) {
      target = window
    }
    var arr = Util.split(events), len = arr.length, i = 0;
    if(Util.isFunction(fn)) {
      for(;i < len;i++) {
        this.__addHandler_c__(arr[i], fn, target)
      }
    }else {
      if(Util.isString(fn)) {
        var fns = Util.split(fn), flen = fns.length, e, j;
        for(;i < len;i++) {
          e = arr[i];
          for(j = 0;j < flen;j++) {
            this.__addHandler_c__(e, target[fns[j]], target)
          }
        }
      }else {
        var flen = fn.length, e, j;
        for(;i < len;i++) {
          e = arr[i];
          for(j = 0;j < flen;j++) {
            this.__addHandler_c__(e, fn[j], target)
          }
        }
      }
    }
  };
  prototype.__addHandler_c__ = function(e, fn, target) {
    if(!this.__map_a__.hasOwnProperty(e)) {
      this.__map_a__[e] = []
    }
    this.__map_a__[e].push({fn:fn, target:target})
  };
  prototype.unregister = function(event, fn) {
    var map = this.__map_a__;
    if(!map.hasOwnProperty(event)) {
      return
    }
    var hans = map[event];
    if(Util.isNull(fn)) {
      hans.length = 0;
      delete map[event];
      return
    }
    var i = 0, len = hans.length;
    for(;i < len;i++) {
      if(hans[i].fn === fn) {
        hans.removeAt(i);
        if(hans.length === 0) {
          delete map[event]
        }
        return
      }
    }
  };
  prototype.trigger = function(events, args, filter) {
    var hans, hlen, map = this.__map_a__, rarr = [], arr = Util.split(events), len = arr.length, noarg = Util.isEmptyArray(args), filon = Util.isFunction(filter), e, i, j = 0;
    for(;j < len;j++) {
      e = arr[j];
      if(!map.hasOwnProperty(e)) {
        continue
      }
      hans = map[e];
      hlen = hans.length;
      if(hlen === 0) {
        continue
      }
      i = 0;
      if(filon) {
        var res;
        if(noarg) {
          for(;i < hlen;i++) {
            res = hans[i].fn.call(hans[i].target);
            if(filter(res)) {
              rarr.push(res)
            }
          }
        }else {
          for(;i < hlen;i++) {
            res = hans[i].fn.apply(hans[i].target, args);
            if(filter(res)) {
              rarr.push(res)
            }
          }
        }
      }else {
        if(noarg) {
          for(;i < hlen;i++) {
            rarr.push(hans[i].fn.call(hans[i].target))
          }
        }else {
          for(;i < hlen;i++) {
            rarr.push(hans[i].fn.apply(hans[i].target, args))
          }
        }
      }
    }
    return rarr
  };
  prototype.triggerInvalid = function(events, args) {
    return this.trigger(events, args, function(a) {
      return a === false
    }).length !== 0
  };
  prototype.sendToBack = function(event, fn) {
    var eventQueue = this.__map_a__[event], len = eventQueue.length, handler, index = -1, i = 0;
    for(;i < len;i++) {
      if(eventQueue[i].fn === fn) {
        index = i;
        handler = eventQueue[i];
        break
      }
    }
    if(index > -1) {
      eventQueue.removeAt(i);
      eventQueue.push(handler)
    }
  };
  prototype.sendToFront = function(event, fn) {
    var eventQueue = this.__map_a__[event], len = eventQueue.length, handler, index = -1, i = 0;
    for(;i < len;i++) {
      if(eventQueue[i].fn === fn) {
        index = i;
        handler = eventQueue[i];
        break
      }
    }
    if(index > -1) {
      eventQueue.removeAt(i);
      eventQueue.unshift(handler)
    }
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Column");
goog.provide("jx.grid.ColumnManager");
(function() {
  goog.exportSymbol("jx.grid.ColumnManager", ColDefManager);
  JGM._add("ColDefManager", ColDefManager);
  function ColDefManager(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.colDefMgr = this;
    var options = {__colDef_a__:{key:undefined, name:"", colClass:undefined, defaultValue:undefined, inputOnCreate:undefined, style:"", headerStyle:"", width:80, minW:30, maxW:undefined, editor:undefined, sorter:undefined, hidden:false, sumRenderer:undefined, tooltipEnabled:false, resizable:false, renderer:JGM.ViewportManager.__renderer_AD__, rendererInput:false, noTitle:false, noName:false, title:undefined, noSearch:false, filter:undefined, parser:undefined, validator:undefined}};
    this._options = JGM.__extend_e__(options, args.options, {colDef:"__colDef_a__"});
    this.__colDefs_a__ = [];
    this.__filtered_b__ = [];
    this.__keyToDef_c__ = {};
    this.__keyToIdx_d__ = {};
    this.__init(args)
  }
  ColDefManager.getInstance = function(args) {
    return new ColDefManager(args)
  };
  var prototype = ColDefManager.prototype;
  prototype.__init = function(args) {
    this.grid.event.bind("onDestroy", this.__destroy_aA__, this);
    this.set(args.colDefs)
  };
  prototype.__destroy_aA__ = function() {
    JGM._destroy(this, {name:"ColDefManager", path:"colDefMgr", property:"__colDefs_a__", map:"__keyToIdx_d__ __keyToDef_c__ _options", array:"__filtered_b__"})
  };
  prototype.getAll = function() {
    return this.__colDefs_a__
  };
  prototype.set = function(colDefs) {
    if(this.__colDefs_a__ === colDefs || Util.areEqualArrays(this.__colDefs_a__, colDefs)) {
      return colDefs
    }
    if(Util.isNull(colDefs)) {
      colDefs = []
    }else {
      var filtered = colDefs.filter(function(a) {
        return Util.isNotNull(a)
      });
      colDefs.length = 0;
      colDefs.pushList(filtered)
    }
    this.grid.event.trigger("onBeforeSetColDefs", [this.__colDefs_a__, colDefs]);
    this.__colDefs_a__ = [];
    this.__filtered_b__.length = 0;
    this.__keyToIdx_d__ = {};
    this.__keyToDef_c__ = {};
    this.grid.event.trigger("onEmptyColDefs");
    var i = 0, len = colDefs.length, map = this.__keyToDef_c__, col, key;
    for(;i < len;i++) {
      col = colDefs[i];
      if(!col.hasOwnProperty("key")) {
        this.__keyToDef_c__ = {};
        return this.grid.error("KEY_UNDEFINED", i)
      }
      key = col.key;
      if(Util.isEmptyString(key)) {
        this.__keyToDef_c__ = {};
        return this.grid.error("BAD_NULL", i)
      }
      if(map.hasOwnProperty(key)) {
        this.__keyToDef_c__ = {};
        return this.grid.error("DUP_KEY", key)
      }
      map[key] = col
    }
    this.__colDefs_a__ = colDefs;
    for(i = 0;i < len;i++) {
      this.__extend_i__(colDefs[i])
    }
    this.grid.event.trigger("onAfterSetColDefs", [colDefs, this.__filter_e__()]);
    return colDefs
  };
  prototype.push = function(colDef) {
    return this.addAt(this.__filtered_b__.length, colDef)
  };
  prototype.addAt = function(i, colDef) {
    if(Util.isNull(colDef)) {
      return
    }
    var key = colDef.key, map = this.__keyToDef_c__, filtered = this.__filtered_b__;
    if(Util.isNull(i) || i > filtered.length) {
      i = filtered.length
    }else {
      if(i < 0) {
        i += filtered.length
      }
    }
    this.grid.event.trigger("onBeforeAddColDef", [colDef]);
    if(Util.isNull(key)) {
      return this.grid.error("KEY_UNDEFINED")
    }
    if(map.hasOwnProperty(key)) {
      return this.grid.error("DUP_KEY", key)
    }
    this.__colDefs_a__.addAt(i, this.__extend_i__(map[key] = colDef));
    if(colDef.hidden !== true) {
      filtered.addAt(i, colDef);
      this.__reidx_f__()
    }
    this.grid.event.trigger("onAfterAddColDef", [colDef, i]);
    return filtered.length
  };
  prototype.__extend_i__ = function(colDef) {
    if(Util.isNull(colDef)) {
      return
    }
    var options = {}, sorter;
    $.extend(true, options, this._options.__colDef_a__);
    $.extend(true, options, colDef);
    $.extend(true, colDef, options);
    colDef.sorter = sorter = ColDefManager.sorter(colDef.sorter, colDef.key);
    if(Util.isNotNull(sorter)) {
      sorter.key = colDef.key
    }
    return colDef
  };
  prototype.hide = function(i) {
    var colDef = this.__filtered_b__[i];
    if(Util.isNull(colDef)) {
      return
    }
    colDef.hidden = true;
    this.__filtered_b__.removeAt(i);
    this.__reidx_f__();
    this.grid.event.trigger("onHideCol", [colDef, i]);
    return colDef
  };
  prototype.show = function(key) {
    if(Util.isNull(key)) {
      return
    }
    if(!Util.isString(key)) {
      if(!Util.isObject(key)) {
        return
      }
      key = key.key
    }
    var map = this.__keyToDef_c__, colDef;
    if(!map.hasOwnProperty(key)) {
      return
    }
    if(this.__keyToIdx_d__.hasOwnProperty(key)) {
      return map[key]
    }
    colDef = map[key];
    colDef.hidden = false;
    this.__filter_e__();
    this.__reidx_f__();
    this.grid.event.trigger("onShowCol", [colDef, this.__keyToIdx_d__[key]]);
    return colDef
  };
  prototype.__filter_e__ = function() {
    this.__filtered_b__ = this.__colDefs_a__.filter(function(colDef) {
      return colDef.hidden !== true
    });
    this.__reidx_f__();
    return this.__filtered_b__
  };
  prototype.__reidx_f__ = function() {
    this.__keyToIdx_d__ = {};
    return this.__reidxFrom_g__()
  };
  prototype.__reidxFrom_g__ = function(from) {
    if(Util.isNull(from)) {
      from = 0
    }
    var i = from, f = this.__filtered_b__, len = f.length, map = this.__keyToIdx_d__;
    for(;i < len;i++) {
      map[f[i].key] = i
    }
    return map
  };
  prototype.get = function(i) {
    if(Util.isNull(i)) {
      return this.__filtered_b__
    }
    if(this.__filtered_b__.hasOwnProperty(i)) {
      return this.__filtered_b__[i]
    }
  };
  prototype.getByKey = function(key) {
    if(Util.isNotNull(key) && this.__keyToDef_c__.hasOwnProperty(key)) {
      return this.__keyToDef_c__[key]
    }
  };
  prototype.length = function() {
    return this.__filtered_b__.length
  };
  prototype.getIdxByKey = function(key) {
    if(this.__keyToIdx_d__.hasOwnProperty(key)) {
      return this.__keyToIdx_d__[key]
    }
    return-1
  };
  prototype.getIdx = function(colDef) {
    if(Util.isNotNull(colDef) && this.__keyToIdx_d__.hasOwnProperty(colDef.key)) {
      return this.__keyToIdx_d__[colDef.key]
    }
    return-1
  };
  prototype.sortByKey = function(keys) {
    this.__filtered_b__.length = 0;
    this.__keyToIdx_d__ = {};
    var i = 0, len = keys.length, f = this.__filtered_b__, map = this.__keyToIdx_d__, dmap = this.__keyToDef_c__;
    for(;i < len;i++) {
      f.push(dmap[keys[i]]);
      map[keys[i]] = i
    }
    this.grid.event.trigger("onReorderCols", keys);
    return this.__filtered_b__
  };
  prototype.getKeys = function() {
    return this.__filtered_b__.map(function(def) {
      return def.key
    })
  };
  ColDefManager.sorter = function(type, key, on) {
    on = on ? true : false;
    if(type === "text") {
      return{lexi:key, on:on, key:key}
    }
    if(type === "int") {
      return{on:on, comparator:function(a, b) {
        var aVal = a[key], bVal = b[key];
        if(Util.isNull(aVal)) {
          aVal = Number.MAX_VALUE
        }else {
          if(typeof aVal === "string") {
            aVal = aVal.toInt()
          }
        }
        if(Util.isNull(bVal)) {
          bVal = Number.MAX_VALUE
        }else {
          if(typeof bVal === "string") {
            bVal = bVal.toInt()
          }
        }
        return aVal - bVal
      }, key:key}
    }
    if(type === "float  tehu") {
      return{on:on, comparator:function(a, b) {
        var aVal = a[key], bVal = b[key];
        if(Util.isNull(aVal)) {
          aVal = Number.MAX_VALUE
        }else {
          if(typeof aVal === "string") {
            aVal = aVal.toFloat()
          }
        }
        if(Util.isNull(bVal)) {
          bVal = Number.MAX_VALUE
        }else {
          if(typeof bVal === "string") {
            bVal = bVal.toFloat()
          }
        }
        return aVal - bVal
      }, key:key}
    }
  }
})();
goog.require("jx.util");
goog.require("jx.events.EventDispatcher");
goog.provide("jx.data.TreeNode");
goog.provide("jx.data.Tree");
goog.provide("TreeNode");
goog.provide("Tree");
(function() {
  goog.exportSymbol("jx.data.TreeNode", TreeNode);
  goog.exportSymbol("jx.data.Tree", Tree);
  goog.exportSymbol("TreeNode", TreeNode);
  goog.exportSymbol("Tree", Tree);
  function TreeNode(args) {
    this.tree = args.tree;
    this.data = args.data;
    this.nodeId = args.nodeId;
    this.level;
    this.parent;
    this.childrenMap = {};
    this.children = []
  }
  TreeNode.getInstance = function(args) {
    return new TreeNode(args)
  };
  var prototype = TreeNode.prototype;
  prototype.destroy = function() {
    this.detach();
    delete this.tree;
    delete this.data;
    delete this.nodeId;
    delete this.childrenMap;
    delete this.children
  };
  prototype.destroyCompletely = function() {
    this.detachCompletely();
    delete this.tree;
    delete this.data;
    delete this.nodeId;
    delete this.childrenMap;
    delete this.children
  };
  prototype.destroyDown = function() {
    if(Util.isNotNull(this.parent)) {
      this.parent.removeChild(this)
    }
    this.traverse({post:true, fn:function() {
      this.destroy()
    }})
  };
  prototype.detach = function() {
    delete this.parent;
    delete this.level;
    this.children.length = 0;
    this.childrenMap = {}
  };
  prototype.detachCompletely = function() {
    if(Util.isNotNull(this.parent)) {
      this.parent.removeChild(this)
    }
    this.removeAllChildren();
    delete this.parent;
    delete this.level
  };
  prototype.detachDown = function() {
    if(Util.isNotNull(this.parent)) {
      this.parent.removeChild(this)
    }
    this.traverse({post:true, fn:function() {
      this.detach()
    }})
  };
  prototype.isRoot = function() {
    return Util.isNull(this.parent)
  };
  prototype.getRoot = function() {
    this.tree.root
  };
  prototype.isLeaf = function() {
    return this.children.length === 0
  };
  prototype.setParent = function(node) {
    if(this.parent === node) {
      return
    }
    if(Util.isNotNull(this.parent)) {
      this.parent.removeChild(this)
    }
    this.parent = node;
    delete this.level;
    if(Util.isNotNull(node)) {
      node.addChild(this)
    }
  };
  prototype.hasChild = function(node) {
    return this.childrenMap.hasOwnProperty(node.nodeId)
  };
  prototype.addChild = function(child) {
    if(this.hasChild(child)) {
      return
    }
    this.children.push(child);
    this.childrenMap[child.nodeId] = this.children.length - 1;
    child.setParent(this)
  };
  prototype.addChildAt = function(index, child) {
    var i;
    if(this.hasChild(child)) {
      i = this.childrenMap[child.nodeId];
      if(i === index) {
        return
      }
      this.children.removeAt(i)
    }
    this.children.addAt(index, child);
    if(Util.isNotNull(i) && i < index) {
      this.resetChildIdx(i)
    }else {
      this.resetChildIdx(index)
    }
    child.setParent(this)
  };
  prototype.removeChild = function(child) {
    if(this.hasChild(child)) {
      var i = this.childrenMap[child.nodeId];
      this.children.removeAt(i);
      delete this.childrenMap[child.nodeId];
      this.resetChildIdx(i);
      delete child.parent;
      delete child.level
    }
  };
  prototype.removeChildAt = function(i) {
    var child = this.children[i];
    this.children.removeAt(i);
    delete this.childrenMap[child.nodeId];
    this.resetChildIdx(i);
    delete child.parent;
    delete child.level
  };
  prototype.resetChildIdx = function(from) {
    if(Util.isNull(from)) {
      from = 0
    }
    var i = from, children = this.children, len = children.length, map = this.childrenMap;
    for(;i < len;i++) {
      map[children[i].nodeId] = i
    }
  };
  prototype.removeAllChildren = function() {
    var i = 0, children = this.children, len = children.length;
    for(;i < len;i++) {
      delete children[i].parent;
      delete children[i].level
    }
    children.length = 0;
    this.childrenMap = {}
  };
  prototype.getSiblings = function() {
    if(this.isRoot()) {
      return[]
    }
    var siblings = this.parent.children.slice();
    siblings.removeAt(this.parent.getChildIdx(this));
    return siblings
  };
  prototype.getChildIdx = function(node) {
    return this.childrenMap[node.nodeId]
  };
  prototype.getIdx = function() {
    if(this.isRoot()) {
      return-1
    }
    return this.parent.getChildIdx(this)
  };
  prototype.getPath = function() {
    return this.traverse({res:[], up:true, post:true, fn:function(args) {
      if(!this.isRoot()) {
        args.res.push(this.getIdx())
      }
    }}).res
  };
  prototype.getAncestors = function() {
    var args = {res:[], up:true, post:true, fn:function(args) {
      args.res.push(this)
    }};
    this.traverse(args);
    args.res.pop();
    return args.res
  };
  prototype.getDescendents = function() {
    var args = {res:[], fn:function(args) {
      args.res.push(this)
    }};
    this.traverse(args);
    args.res.shift();
    return args.res
  };
  prototype.getLevel = function() {
    if(this.isRoot()) {
      return this.level = -1
    }
    return this.level = this.parent.getLevel() + 1
  };
  prototype.find = function(dataToFind) {
    return this.traverse({fn:function(args) {
      if(this.data === dataToFind) {
        args.res = this;
        args.stop = true
      }
    }}).res
  };
  prototype.traverse = function(args, index) {
    if(args.stop) {
      return args
    }
    if(args.up) {
      if(this.isRoot()) {
        this.callFn(args)
      }else {
        if(args.post) {
          this.parent.traverse(args);
          this.callFn(args)
        }else {
          this.callFn(args);
          this.parent.traverse(args)
        }
      }
    }else {
      var i = 0, c = this.children, len = c.length;
      if(args.post) {
        for(;i < len;i++) {
          c[i].traverse(args, i)
        }
        this.callFn(args, index)
      }else {
        this.callFn(args, index);
        if(args.propagate === false) {
          delete args.propagate
        }else {
          for(;!args.stop && i < len;i++) {
            c[i].traverse(args, i)
          }
        }
      }
    }
    return args
  };
  prototype.traverseChildren = function(args) {
    var i = 0, c = this.children, len = c.length;
    for(;i < len;i++) {
      c[i].traverse(args, i)
    }
  };
  prototype.traverseParent = function(args) {
    if(Util.isNotNull(this.parent)) {
      this.parent.traverse(args)
    }
  };
  prototype.callFn = function(args, index) {
    if(!args.stop) {
      if(Util.isNull(args.target)) {
        Util.callFn(this, args.fn, args, index)
      }else {
        args.node = this;
        Util.callFn(args.target, args.fn, args, index)
      }
    }
  };
  function Tree(args) {
    this.mid = args.mid;
    this.list = args.list;
    var options = {nodeKey:"nodeId", parentKey:"parentId"};
    this._options = JGM.__extend_e__(options, args.options);
    this.map = {};
    this.root = new TreeNode({tree:this});
    this.infants = {}
  }
  Tree.getInstance = function(args) {
    return new Tree(args)
  };
  prototype = Tree.prototype;
  prototype.__init = function() {
    this.makeTree()
  };
  prototype.destroy = function() {
    this.root.destroyDown();
    this.map = {};
    this.emptyInfants();
    delete this.list;
    delete this._options;
    delete this.map;
    delete this.root;
    delete this.infants;
    JGM.__remove_f__("Tree", this.mid);
    delete this.mid
  };
  prototype.detach = function() {
    this.root.detachDown();
    this.emptyInfants()
  };
  prototype.emptyInfants = function() {
    var i, inf = this.infants;
    for(i in inf) {
      if(inf.hasOwnProperty(i)) {
        inf[i].length = 0
      }
    }
    this.infants = {}
  };
  prototype.reattach = function(list) {
    this.detach();
    if(Util.isNull(list)) {
      list = this.list
    }
    var nodeKey = this._options.nodeKey, map = this.map, len = list.length, i = 0;
    for(;i < len;i++) {
      this.attachNode(map[list[i][nodeKey]])
    }
  };
  prototype.makeTree = function(list) {
    if(Util.isNull(list)) {
      list = this.list
    }
    var i = 0, len = list.length;
    for(;i < len;i++) {
      this.createNode(list[i])
    }
  };
  prototype.hasNode = function(data) {
    return Util.isNotNull(data) && this.map.hasOwnProperty(data[this._options.nodeKey])
  };
  prototype.getNode = function(data) {
    return this.map[data[this._options.nodeKey]]
  };
  prototype.getNodeByNodeId = function(nodeId) {
    return this.map[nodeId]
  };
  prototype.createNode = function(data) {
    if(this.hasNode()) {
      return
    }
    var nodeId = data[this._options.nodeKey], node = new TreeNode({tree:this, data:data, nodeId:nodeId});
    this.map[nodeId] = node;
    this.attachNode(node);
    return node
  };
  prototype.adoptInfants = function(node, nodeId) {
    if(this.infants.hasOwnProperty(nodeId)) {
      var list = this.infants[nodeId], i = 0, len = list.length;
      for(;i < len;i++) {
        node.addChild(list[i])
      }
      list.length = 0;
      delete this.infants[nodeId]
    }
  };
  prototype.attachNode = function(node) {
    var nodeId = node.nodeId, parentId = node.data[this._options.parentKey];
    this.adoptInfants(node, nodeId);
    if(Util.isNull(parentId) || parentId == nodeId) {
      this.root.addChild(node);
      return true
    }
    if(this.map.hasOwnProperty(parentId)) {
      this.map[parentId].addChild(node);
      return true
    }
    this.addToInfants(node, parentId);
    return false
  };
  prototype.changeNodeId = function(node, before, newId) {
    if(before === newId) {
      return
    }
    delete this.map[before];
    this.map[newId] = node;
    this.removeChildren(node);
    node.nodeId = node.data[this._options.nodeKey] = newId;
    if(Util.isNotNull(node.parent)) {
      node.parent.childrenMap[newId] = node.parent.childrenMap[before];
      delete node.parent.childrenMap[before]
    }
    this.adoptInfants(node, newId)
  };
  prototype.changeParentId = function(node, before, newId) {
    if(before === newId) {
      return
    }
    if(Util.isNull(node.parent)) {
      this.removeFromInfants(node, before)
    }
    var parent = this.map[newId];
    node.setParent(parent);
    node.data[this._options.parentKey] = newId;
    if(Util.isNull(parent)) {
      this.addToInfants(node, newId)
    }
  };
  prototype.destroyNodeByData = function(data) {
    this.destroyNode(this.getNode(data))
  };
  prototype.destroyNode = function(node) {
    this.removeChildren(node);
    this.removeFromInfants(node);
    this.removeFromMap(node);
    node.destroyCompletely()
  };
  prototype.removeFromMap = function(node) {
    delete this.map[node.nodeId]
  };
  prototype.addToInfants = function(node, parentId) {
    if(!this.infants.hasOwnProperty(parentId)) {
      this.infants[parentId] = []
    }
    this.infants[parentId].push(node)
  };
  prototype.removeFromInfants = function(node, parentId) {
    if(Util.isNull(parentId)) {
      parentId = node.data[this._options.parentKey]
    }
    if(this.infants.hasOwnProperty(parentId)) {
      this.infants[parentId].remove(node);
      if(this.infants[parentId].length === 0) {
        delete this.infants[parentId]
      }
    }
  };
  prototype.removeChildren = function(node) {
    if(node.children.length !== 0) {
      if(!this.infants.hasOwnProperty(node.nodeId)) {
        this.infants[node.nodeId] = []
      }
      this.infants[node.nodeId].pushList(node.children);
      node.removeAllChildren()
    }
  };
  prototype.sortList = function(list) {
    if(Util.isNull(list)) {
      list = []
    }else {
      list.length = 0
    }
    this.root.traverseChildren({fn:function() {
      list.push(this.data)
    }})
  }
})();
goog.require("jx.util");
goog.require("jx.util$");
goog.require("jx.lang.Disposable");
goog.require("jx.events.EventDispatcher");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.EventManager");
goog.provide("jx.grid.Grid");
(function() {
  goog.exportSymbol("jx.grid.Grid", Grid);
  JGM._add("Grid", Grid);
  function Grid(args) {
    goog.base(this, args)
  }
  goog.inherits(Grid, JGM.core.BaseModule);
  Grid.getInstance = function(args) {
    return new Grid(args)
  };
  var prototype = Grid.prototype;
  prototype._defaultOptions = function() {
    return{classGrid:"jgrid", border:"1px solid #868686", width:undefined, font:"15px Arial,Helvetica,sans-serif", style:"", borderSide:true, imageUrl:"../images/", links:{data:"dataMgr.all", datalen:"dataMgr.all.length", shown:"dataMgr.datalist", set:"dataMgr.set", add:"dataMgr.add", addList:"dataMgr.addList", update:"dataMgr.update", updateByKey:"dataMgr.updateByKey", updateList:"dataMgr.updateList", remove:"dataMgr.remove", removeList:"dataMgr.removeList", select:"dataMgr.executeSelect", undo:"dataMgr.undo", 
    redo:"dataMgr.redo", addFilter:"dataMgr.addFilter", removeFilter:"dataMgr.removeFilter", check:"collapser.checkMgr.checkList checkMgr.checkList", checked:"collapser.checkMgr.getCheckList checkMgr.getCheckList", removeChecked:"collapser.checkMgr.removeChecked checkMgr.removeChecked", register:"event.register", trigger:"event.trigger", bind:"event.bind", unregister:"event.unregister", unbind:"event.unregister", collen:"colDefMgr.length"}, autoWidth:false, showMessage:false}
  };
  prototype._init = function(args) {
    this._ctnr = args.container;
    this.name = this._options.name;
    this._vars = {drag:false, scrollbarDim:undefined, lastW:undefined, lastH:undefined};
    this._ctnr = $("<div id='" + this.mid + "' class='" + this._options.classGrid + "' " + (Util.isNull(this._options.width) ? "" : "style='width:" + this._options.width + "px' ") + "tabIndex='0'>").appendTo(Util$.safe$(this._ctnr));
    this._vars.scrollbarDim = Util$.calScrollbarDims(this._ctnr);
    this.event = JGM.create("EventManager", {grid:this, options:this._options.EventManager});
    delete this._options.EventManager;
    this.colDefMgr = JGM.create("ColDefManager", {grid:this, colDefs:args.colDefs, options:this._options.ColDefManager});
    delete this._options.ColDefManager;
    this.dataMgr = JGM.create("DataManager", {grid:this, datalist:args.datalist, options:this._options.DataManager});
    delete this._options.DataManager;
    if(this._options.CheckManager) {
      this.checkMgr = JGM.create("CheckManager", {grid:this, options:this._options.CheckManager});
      delete this._options.CheckManager
    }
    var i = 10, colDefs = this.colDefMgr.getAll(), len = colDefs.length;
    for(;i < len;i++) {
      colDef = colDefs[i];
      if(colDef.CheckManager) {
        colDef.CheckManager.colDef = colDef;
        colDef.checkMgr = JGM.create("CheckManager", {grid:this, options:colDef.CheckManager})
      }
    }
    if(this._options.Collapser) {
      this.collapser = JGM.create("Collapser", {grid:this, options:this._options.Collapser});
      this.collapser.__init();
      delete this._options.Collapser
    }
    if(this._options.ColGroup) {
      this.colGroup = JGM.create("ColGroup", {grid:this, options:this._options.ColGroup});
      delete this._options.ColGroup
    }
    if(this._options.SelectionManager) {
      this.selMgr = JGM.create("SelectionManager", {grid:this, options:this._options.SelectionManager});
      delete this._options.SelectionManager
    }
    if(this._options.EditManager) {
      this.editMgr = JGM.create("EditManager", {grid:this, options:this._options.EditManager});
      delete this._options.EditManager
    }
    if(this._options.ColHeader) {
      this.header = JGM.create("ColHeader", {grid:this, container:this._ctnr, options:this._options.ColHeader});
      delete this._options.ColHeader
    }
    if(this._options.SearchManager) {
      this.search = JGM.create("SearchManager", {grid:this, container:this._ctnr, options:this._options.SearchManager});
      delete this._options.SearchManager
    }
    if(this._options.MenuBar) {
      this.menubar = JGM.create("MenuBar", {grid:this, container:this._ctnr, options:this._options.MenuBar});
      delete this._options.MenuBar
    }
    this.view = JGM.create("ViewportManager", {grid:this, container:this._ctnr, options:this._options.ViewportManager});
    delete this._options.ViewportManager;
    if(this._options.TooltipManager) {
      this.tooltip = JGM.create("TooltipManager", {grid:this, container:this._ctnr, options:this._options.TooltipManager});
      delete this._options.TooltipManager
    }
    if(this._options.DataCreator) {
      this.creator = JGM.create("DataCreator", {grid:this, container:this._ctnr, options:this._options.DataCreator});
      delete this._options.DataCreator
    }
    if(this._options.Footer) {
      this.footer = JGM.create("Footer", {grid:this, container:this._ctnr, options:this._options.Footer});
      delete this._options.Footer
    }
    if(this._options.autoWidth) {
      this.event.bind("onResizeCanvasWidth", this.width, this)
    }
    this._createCss();
    this.event.trigger("onBeforeRenderModules onRenderModules onAfterRenderModules");
    this.msg = $("<div id='" + this.mid + "msg' class='msg' onmousedown='$(this).hide(1000)' style='position:relative;padding-left:4px;overflow:hidden;z-index:100;font-size:12px;height:21px;line-height:21px'></div>").appendTo(this._ctnr).hide();
    this._vars.lastW = this._ctnr[0].clientWidth;
    this._vars.lastH = this._ctnr[0].clientHeight;
    this._registerLinks(this._options.links)
  };
  prototype._bindEvents = function() {
    JGM._bindGlobalEvents();
    var thisIns = this;
    this._ctnr.bind({keydown:function(e) {
      thisIns._keydown(e)
    }, keyup:function(e) {
      thisIns._keyup(e)
    }, keypress:function(e) {
      thisIns._keypress(e)
    }, mousein:function(e) {
      thisIns._mousein(e)
    }, mouseout:function(e) {
      thisIns._mouseout(e)
    }, mouseenter:function(e) {
      thisIns._mouseenter(e)
    }, mouseleave:function(e) {
      thisIns._mouseleave(e)
    }, mouseover:function(e) {
      thisIns._mouseover(e)
    }, mousedown:function(e) {
      thisIns._mousedown(e)
    }, click:function(e) {
      thisIns._click(e)
    }, dblclick:function(e) {
      thisIns._dblclick(e)
    }})
  };
  prototype.destroy = function() {
    try {
      if(Util.isEmptyObj(JGM.m.Grid)) {
        JGM._unbindGlobalEvents()
      }
      this.event.trigger("onDestroy");
      JGM._destroy(this, {name:"Grid", module:"event", "$":"_ctnr", map:"_vars _options", style:"_style _dynStyle"})
    }catch(e) {
      return e
    }
  };
  prototype._registerLinks = function(links) {
    var link, arr, arrlen, j, path, pathlen, current, last, lastPath, i;
    link_loop:for(link in links) {
      if(links.hasOwnProperty(link) && !(link in this)) {
        arr = Util.split(links[link]);
        arrlen = arr.length;
        j = 0;
        arr_loop:for(;j < arrlen;j++) {
          path = arr[j].split(".");
          pathlen = path.length;
          if(pathlen < 1) {
            continue
          }
          current = this;
          last = this;
          lastPath = "";
          i = 0;
          for(;i < pathlen;i++) {
            if(!(path[i] in current)) {
              continue arr_loop
            }else {
              last = current;
              current = current[lastPath = path[i]]
            }
          }
          this._registerLink(link, current, last, lastPath);
          continue link_loop
        }
      }
    }
  };
  prototype._registerLink = function(name, fn, thisp, lastPath) {
    if(this.hasOwnProperty(name)) {
      return false
    }
    if(Util.isFunction(fn)) {
      this[name] = function() {
        return fn.apply(thisp, arguments)
      }
    }else {
      this[name] = function() {
        return thisp[lastPath]
      }
    }
    return true
  };
  prototype._createCss = function() {
    var style = Util.sprint("%selector%{overflow:hidden;font:%font%;%border%%style%}%submodule%", {selector:"#" + this.mid, font:this._options.font, border:this._options.borderSide ? "border:" + this._options.border + ";" : "border-top:" + this._options.border + ";border-bottom:" + this._options.border + ";", style:this._options.style, submodule:this.event.trigger("onCreateCss").join("")});
    this._style = Util.createStyle(style);
    this._dynStyle = Util.createStyle(this.event.trigger("onCreateDynamicCss").join(""))
  };
  prototype._recreateDynamicCss = function() {
    Util.setStyle(this._dynStyle, this.event.trigger("onCreateDynamicCss").join(""))
  };
  prototype._keydown = function(e) {
    if(this.event.triggerInvalid("onBeforeKeydown", [e])) {
      return
    }
    this.event.trigger("keydown_" + e.which + " keydown", [e])
  };
  prototype._keyup = function(e) {
    if(this.event.triggerInvalid("onBeforeKeyup", [e])) {
      return
    }
    this.event.trigger("keyup_" + e.which + " keyup", [e])
  };
  prototype._keypress = function(e) {
    if(this.event.triggerInvalid("onBeforeKeypress", [e])) {
      return
    }
    this.event.trigger("keypress_" + e.which + " keypress", [e])
  };
  prototype._mousein = function(e) {
    if(this.event.triggerInvalid("onBeforeMousein", [e])) {
      return
    }
    if(this._vars.drag) {
      this.event.trigger("dragin mousein", [e])
    }else {
      this.event.trigger("mousein", [e])
    }
  };
  prototype._mouseout = function(e) {
    if(this.event.triggerInvalid("onBeforeMouseout", [e])) {
      return
    }
    if(this._vars.drag) {
      this.event.trigger("dragout mouseout", [e])
    }else {
      this.event.trigger("mouseout", [e])
    }
  };
  prototype._mouseenter = function(e) {
    if(this.event.triggerInvalid("onBeforeMouseenter", [e])) {
      return
    }
    if(this._vars.drag) {
      this.event.trigger("dragenter mouseenter", [e])
    }else {
      this.event.trigger("mouseenter", [e])
    }
  };
  prototype._mouseleave = function(e) {
    if(this.event.triggerInvalid("onBeforeMouseleave", [e])) {
      return
    }
    if(this._vars.drag) {
      this.event.trigger("dragleave mouseleave", [e])
    }else {
      this.event.trigger("mouseleave", [e])
    }
  };
  prototype._mousemove = function(e) {
    if(this.event.triggerInvalid("onBeforeMousemove", [e])) {
      return
    }
    if(this._vars.drag) {
      this.event.trigger("dragmove mousemove", [e])
    }else {
      this.event.trigger("mousemove", [e])
    }
  };
  prototype._mouseover = function(e) {
    if(this.event.triggerInvalid("onBeforeMouseover", [e])) {
      return
    }
    if(this._vars.drag) {
      this.event.trigger("dragover mouseover", [e])
    }else {
      this.event.trigger("mouseover", [e])
    }
  };
  prototype._mousedown = function(e) {
    this._vars.drag = true;
    if(this.event.triggerInvalid("onBeforeMousedown", [e])) {
      return
    }
    this.event.trigger("mousedown", [e])
  };
  prototype._mouseup = function(e) {
    this._vars.drag = false;
    this.event.trigger("unsetDrag");
    if(!this.containsEvent(e)) {
      return
    }
    if(this.event.triggerInvalid("onBeforeMouseup", [e])) {
      return
    }
    this.event.trigger("mouseup", [e])
  };
  prototype._click = function(e) {
    if(this.event.triggerInvalid("onBeforeClick", [e])) {
      return
    }
    this.event.trigger("click", [e])
  };
  prototype._dblclick = function(e) {
    if(this.event.triggerInvalid("onBeforeDblclick", [e])) {
      return
    }
    this.event.trigger("dblclick", [e])
  };
  prototype._resize = function(e) {
    var change = false, width = this._ctnr[0].clientWidth, height;
    if(width >= 1 && this._vars.lastW !== width) {
      this.event.trigger("resizeWidth", [width, this._vars.lastW]);
      this._vars.lastW = width;
      change = true
    }
    height = this._ctnr[0].clientHeight;
    if(height >= 1 && this._vars.lastH !== height) {
      this.event.trigger("resizeHeight", [height, this._vars.lastH]);
      this._vars.lastH = height;
      change = true
    }
    if(change) {
      this.event.trigger("resize", [e])
    }
  };
  prototype.width = function(w) {
    w = parseInt(w);
    if(Util.isNull(w) || isNaN(w) || w < 1 || w === this._ctnr[0].clientWidth) {
      return this._ctnr[0].clientWidth
    }
    this._ctnr[0].style.width = w + "px";
    this.event.trigger("resizeWidth", [w, this._vars.lastW]);
    this._vars.lastW = w;
    this.event.trigger("resize");
    return w
  };
  prototype.height = function(h) {
    h = parseInt(h);
    if(Util.isNull(h) || isNaN(h) || h < 1 || h === this._ctnr[0].clientHeight) {
      return this._ctnr[0].clientHeight
    }
    this._ctnr[0].style.height = h + "px";
    this.event.trigger("resizeHeight", [h, this._vars.lastH]);
    this._vars.lastH = h;
    this.event.trigger("resize");
    return h
  };
  prototype.getCellByIdAndKey = function(id, key) {
    return JGM.create("Cell", {grid:this, datarow:this.dataMgr.getById(id), colDef:this.colDefMgr.getByKey(key)})
  };
  prototype.getCellByIdx = function(rowIdx, colIdx) {
    return JGM.create("Cell", {grid:this, row:rowIdx, col:colIdx})
  };
  prototype.error = function(code) {
    var str = JGM.error[code], i = 1, e, len = arguments.length;
    for(;i < len;i++) {
      str = str.replace(new RegExp("%" + (i - 1), "g"), arguments[i])
    }
    e = new Error(str);
    e.code = code;
    this.printError(e.message);
    this.event.trigger("onError", [e]);
    return e
  };
  prototype.printError = function(str) {
    if(this._options.showMessage) {
      var msg = this.msg;
      msg[0].innerHTML = str;
      msg[0].style.width = this._ctnr[0].clientWidth + "px";
      msg[0].style.background = "#ffebe8";
      msg[0].style.color = "#333";
      msg.show();
      clearTimeout(this.timeout);
      this.timeout = setTimeout(function() {
        msg.hide(1E3)
      }, 5E3)
    }
  };
  prototype.printMessage = function(str) {
    if(this._options.showMessage) {
      var msg = this.msg;
      msg[0].innerHTML = str;
      msg[0].style.width = this._ctnr[0].clientWidth + "px";
      msg[0].style.background = "#dfdfdf";
      msg[0].style.color = "#6f6f6f";
      msg.show();
      clearTimeout(this.timeout);
      this.timeout = setTimeout(function() {
        msg.hide(1E3)
      }, 5E3)
    }
  };
  prototype.containsEvent = function(e) {
    return Util.contains(this._ctnr[0], e.target)
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.provide("jx.grid.MenuBar");
(function() {
  goog.exportSymbol("jx.grid.MenuBar", MenuBar);
  JGM._add("MenuBar", MenuBar);
  function MenuBar(args) {
    goog.base(this, args);
    this.grid.menubar = this
  }
  goog.inherits(MenuBar, JGM.grids.BaseModule);
  MenuBar.getInstance = function(args) {
    return new MenuBar(args)
  };
  var proto = MenuBar.prototype;
  proto._defaultOptions = function() {
    return{background:"url(" + this.grid._options.imageUrl + "menubar-bg.png) repeat-x scroll center", borderThickness:1, border:"solid #b6bac0", height:27, classMenuBar:"menubar", classIcon:"menu-icon", iconBorderThickness:1, iconBorder:"solid transparent", iconBorderHover:"solid #d4d4d4", iconBorderActive:"solid #9a9a9a", iconMargin:2, iconBackground:"", iconBackgroundHover:"url(" + this.grid._options.imageUrl + "menu-icon-hover.png) repeat-x scroll center", iconBackgroundActive:"url(" + this.grid._options.imageUrl + 
    "menu-icon-active.png) repeat-x scroll center", iconHeight:21, iconWidth:21, iconBorderRadius:4, iconBorderFocus:"solid #5f5f5f"}
  };
  proto._init = function(args) {
    this._ctnr = args.container;
    this.__menubar_a__ = $("<div class='" + this._options.__classMenuBar_e__ + "'></div>").prependTo(this._ctnr)
  };
  proto._bindEvents = function(args) {
    this.grid.event.bind({onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__}, this)
  };
  proto.__destroy_aA__ = function() {
    JGM._destroy(this, {name:"MenuBar", path:"menubar", "$":"__menubar_a__", property:"_ctnr", map:"_options"})
  };
  proto.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, border = o.__borderThickness_b__ + "px " + o.__border_c__, rules = [];
    rules.push(gridId + o.__classMenuBar_e__ + "{" + JGM.__CONST_g__.__cssUnselectable_a__ + "overflow:hidden;width:100%;background:" + o.__background_a__ + ";border-bottom:" + border + ";height:" + o.__height_d__ + "px}");
    rules.push(gridId + o.__classIcon_f__ + "{float:left;height:" + o.__iconHeight_o__ + "px;width:" + o.__iconWidth_p__ + "px;border:" + o.__iconBorderThickness_g__ + "px " + o.__iconBorder_h__ + ";margin:" + o.__iconMargin_k__ + "px 0 0 " + o.__iconMargin_k__ + "px;background:" + o.__iconBackground_l__ + ";border-radius:" + o.__iconBorderRadius_q__ + "px;-moz-border-radius:" + o.__iconBorderRadius_q__ + "px}");
    rules.push(gridId + o.__classIcon_f__ + ":hover," + gridId + o.__classIcon_f__ + ":focus{background:" + o.__iconBackgroundHover_m__ + ";border:" + o.__iconBorderThickness_g__ + "px " + o.__iconBorderHover_i__ + "}");
    rules.push(gridId + o.__classIcon_f__ + ":active," + gridId + o.__classIcon_f__ + ".active{cursor:default;background:" + o.__iconBackgroundActive_n__ + ";border:" + o.__iconBorderThickness_g__ + "px " + o.__iconBorderActive_j__ + "}");
    rules.push(gridId + o.__classIcon_f__ + ".active:focus{border:" + o.__iconBorderThickness_g__ + "px " + o.__iconBorderFocus_r__ + "}");
    return rules.join("")
  };
  proto.addIcon = function(css, title, width, height, fn) {
    return $("<div class='" + this._options.__classIcon_f__ + "' tabIndex='0' title='" + title + "'><div class='" + css + "' style='margin-top:" + (this._options.__iconHeight_o__ - height) / 2 + "px;margin-left:" + (this._options.__iconWidth_p__ - width) / 2 + "px'></div></div>").appendTo(this.__menubar_a__).click(function(e) {
      fn();
      $(this).toggleClass("active");
      e.preventDefault()
    }).keydown(function(e) {
      if(e.which === Util.keyMapKeydown.enter || e.which === Util.keyMapKeydown.space) {
        fn();
        $(this).toggleClass("active");
        e.preventDefault()
      }
    })
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.data.DataManager");
goog.provide("jx.grid.TooltipManager");
(function() {
  goog.exportSymbol("jx.grid.TooltipManager", TooltipManager);
  JGM._add("TooltipManager", TooltipManager);
  function TooltipManager(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.tooltip = this;
    this._ctnr = args.container;
    var options = {__classTooltip_a__:"jgrid-tooltip", __tooltipSyncEnabled_b__:true, __offsetX_c__:0, __offsetY_d__:18, __background_e__:"#F5F5F5", __border_f__:"1px solid #868686", __padding_g__:"2px 10px", __font_h__:"14px Arial,Helvetica,sans-serif", __color_i__:"#333"};
    this._options = JGM.__extend_e__(options, args.options, {classTooltip:"__classTooltip_a__", tooltipSyncEnabled:"__tooltipSyncEnabled_b__", offsetX:"__offsetX_c__", offsetY:"__offsetY_d__", background:"__background_e__", border:"__border_f__", padding:"__padding_g__", font:"__font_h__", color:"__color_i__"});
    this.__tooltip_a__;
    this.__init()
  }
  TooltipManager.getInstance = function(args) {
    return new TooltipManager(args)
  };
  var prototype = TooltipManager.prototype;
  prototype.__init = function() {
    this.grid.event.bind({onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__, mouseoutCanvas:this.__mouseoutCanvas_bb__, mousemoveCanvas:this.__mousemoveCanvas_bc__, mouseoverCanvas:this.__mouseoverCanvas_bd__}, this)
  };
  prototype.__destroy_aA__ = function() {
    JGM._destroy(this, {name:"TooltipManager", path:"tooltip", "$":"__tooltip_a__", property:"_ctnr", map:"_options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", opt = this._options, rules = [];
    rules.push(gridId + opt.__classTooltip_a__ + "{position:absolute;z-index:10;background:" + opt.__background_e__ + ";border:" + opt.__border_f__ + ";padding:" + opt.__padding_g__ + ";color:" + opt.__color_i__ + ";font:" + opt.__font_h__ + "}");
    return rules.join("")
  };
  prototype.__mouseoutCanvas_bb__ = function(e, cell) {
    if(Util.isNotNull(this.__tooltip_a__)) {
      this._ctnr[0].removeChild(this.__tooltip_a__[0]);
      delete this.__tooltip_a__
    }
  };
  prototype.__mousemoveCanvas_bc__ = function(e, cell) {
    var opt = this._options;
    if(opt.__tooltipSyncEnabled_b__ && Util.isNotNull(this.__tooltip_a__)) {
      this.__tooltip_a__.css({left:e.pageX + opt.__offsetX_c__ + "px", top:e.pageY + opt.__offsetY_d__ + "px"})
    }
  };
  prototype.__mouseoverCanvas_bd__ = function(e, cell) {
    if(cell.getColDef().tooltipEnabled) {
      if(Util.isNull(this.__tooltip_a__)) {
        var opt = this._options, temp = document.createElement("div");
        temp.innerHTML = "<div class='" + opt.__classTooltip_a__ + "' style='left:" + (e.pageX + opt.__offsetX_c__) + "px;top:" + (e.pageY + opt.__offsetY_d__) + "px'>" + cell.getValue() + "</div>";
        this.__tooltip_a__ = $(temp.firstChild);
        this._ctnr[0].appendChild(this.__tooltip_a__[0])
      }
    }
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.require("jx.data.DataManager");
goog.provide("jx.grid.Footer");
(function() {
  goog.exportSymbol("jx.grid.Footer", Footer);
  JGM._add("Footer", Footer);
  function Footer(args) {
    this.mid = args.mid;
    this._ctnr = args.container;
    this.__foot_a__;
    this.grid = args.grid;
    this.grid.footer = this;
    var options = {__classCell_a__:"footer-cell", __background_b__:"#F1F5FB", __border_c__:"0px solid #CCD9EA", __color_d__:"#000", __fontSize_e__:"13px", __fontWeight_f__:"normal", __cellHeight_g__:25, __cellPadding_h__:40, __countTemplate_i__:" <span name='shownCount'></span>  /  <span name='totalCount'></span> ", __titleColor_j__:"#5A6779", __titleFontSize_k__:"12px", __titleFontWeight_l__:"normal", __contentColor_n__:"#1E395B", __contentFontSize_o__:"12px", __contentFontWeight_p__:"normal", 
    __classFooter_q__:"jgrid-footer", __classTitle_r__:"footer-title", __classContent_s__:"footer-content", __style_u__:"", __cellStyle_v__:"", __titleStyle_w__:"", __contentStyle_x__:""};
    this._options = JGM.__extend_e__(options, args.options, {classCell:"__classCell_a__", background:"__background_b__", border:"__border_c__", color:"__color_d__", fontSize:"__fontSize_e__", fontWeight:"__fontWeight_f__", cellHeight:"__cellHeight_g__", cellPadding:"__cellPadding_h__", countTemplate:"__countTemplate_i__", titleColor:"__titleColor_j__", titleFontSize:"__titleFontSize_k__", titleFontWeight:"__titleFontWeight_l__", contentColor:"__contentColor_n__", contentFontSize:"__contentFontSize_o__", 
    contentFontWeight:"__contentFontWeight_p__", classFooter:"__classFooter_q__", classTitle:"__classTitle_r__", classContent:"__classContent_s__", style:"__style_u__", cellStyle:"__cellStyle_v__", titleStyle:"__titleStyle_w__", contentStyle:"__contentStyle_x__"});
    this.__sumMap_g__ = {};
    this.__init()
  }
  Footer.getInstance = function(args) {
    return new Footer(args)
  };
  var prototype = Footer.prototype;
  prototype.__init = function() {
    this.__foot_a__ = $("<div class='" + this._options.__classFooter_q__ + "'>").appendTo(this._ctnr);
    this.getNextCell().html(this._options.__countTemplate_i__);
    this.__updateTotalCount_d__();
    this.__updateShownCount_c__();
    this.__initSumCells_f__();
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    this.grid.event.bind({onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__, onDataChange:[this.__updateTotalCount_d__, this.__updateSums_e__], onAfterRefresh:this.__updateShownCount_c__}, this)
  };
  prototype.__destroy_aA__ = function() {
    var i, map = this.__sumMap_g__;
    for(i in map) {
      if(map.hasOwnProperty(i)) {
        map[i].remove()
      }
    }
    JGM._destroy(this, {name:"Footer", path:"footer", "$":"__foot_a__", property:"_ctnr", map:"__sumMap_g__ _options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var o = this._options, footerSel = "#" + this.grid.mid + " ." + o.__classFooter_q__, rules = [];
    rules.push(footerSel + "{float:left;cursor:default;width:100%;" + JGM.__CONST_g__.__cssUnselectable_a__ + "background:" + o.__background_b__ + ";border-top:" + o.__border_c__ + ";border-collapse:collapse;color:" + o.__color_d__ + ";font-size:" + o.__fontSize_e__ + ";font-weight:" + o.__fontWeight_f__ + ";padding-left:8px;" + o.__style_u__ + "}");
    rules.push(footerSel + " ." + o.__classCell_a__ + "{float:left;white-space:nowrap;line-height:" + o.__cellHeight_g__ + "px;padding-right:" + o.__cellPadding_h__ + "px;" + o.__cellStyle_v__ + "}");
    rules.push(footerSel + " ." + o.__classTitle_r__ + "{text-align:right;color:" + o.__titleColor_j__ + ";font-size:" + o.__titleFontSize_k__ + ";font-weight:" + o.__titleFontWeight_l__ + ";" + o.__titleStyle_w__ + "}");
    rules.push(footerSel + " ." + o.__classContent_s__ + "{color:" + o.__contentColor_n__ + ";font-size:" + o.__contentFontSize_o__ + ";font-weight:" + o.__contentFontWeight_p__ + ";" + o.__contentStyle_x__ + "}");
    return rules.join("")
  };
  prototype.__updateTotalCount_d__ = function() {
    this.__foot_a__.find("[name=totalCount]")[0].innerHTML = this.grid.dataMgr.getReal().length
  };
  prototype.__updateShownCount_c__ = function() {
    this.__foot_a__.find("[name=shownCount]")[0].innerHTML = this.grid.dataMgr.filterReal(this.grid.dataMgr.datalist).length
  };
  prototype.__initSumCells_f__ = function() {
    var rows = this.grid.dataMgr.getReal(), colDefs = this.grid.colDefMgr.get(), clen = colDefs.length, colDef, renderer, lower, key, name, sum, sumfn = Footer.__calSum_a__, map = this.__sumMap_g__, cell, node, i = 0;
    for(;i < clen;i++) {
      colDef = colDefs[i];
      renderer = colDef.sumRenderer;
      if(Util.isNotNull(renderer)) {
        key = colDef.key;
        name = colDef.name;
        sum = sumfn(rows, key);
        cell = map[key] = this.getNextCell();
        node = cell[0];
        if(Util.isFunction(renderer)) {
          node.innerHTML = renderer(name, sum)
        }else {
          if(Util.isString(renderer)) {
            lower = renderer.toLowerCase();
            if(lower === "krw" || renderer === "\\") {
              node.innerHTML = this.__sumRenderer_h__(name, Util.formatNumber(sum))
            }else {
              if(lower === "usd" || renderer === "$") {
                node.innerHTML = this.__sumRenderer_h__(name, Util.formatNumber(sum, 2, "$ "))
              }
            }
          }else {
            node.innerHTML = this.__sumRenderer_h__(name, sum)
          }
        }
      }
    }
  };
  prototype.__updateSums_e__ = function() {
    var rows = this.grid.dataMgr.getReal(), key, map = this.__sumMap_g__, cmgr = this.grid.colDefMgr, colDef, renderer, lower, name, sum, sumfn = Footer.__calSum_a__, cell, node, content = this._options.__classContent_s__;
    for(key in map) {
      if(map.hasOwnProperty(key)) {
        colDef = cmgr.getByKey(key);
        name = colDef.name;
        renderer = colDef.sumRenderer;
        sum = sumfn(rows, key);
        cell = map[key];
        node = cell[0];
        if(Util.isFunction(renderer)) {
          node.innerHTML = renderer(colDef.name, sum)
        }else {
          if(Util.isString(renderer)) {
            lower = renderer.toLowerCase();
            if(lower === "krw" || renderer === "\\") {
              cell.find("span." + content)[0].innerHTML = Util.formatNumber(sum)
            }else {
              if(lower === "usd" || renderer === "$") {
                cell.find("span." + content)[0].innerHTML = Util.formatNumber(sum, 2, "$ ")
              }
            }
          }else {
            cell.find("span." + content)[0].innerHTML = sum
          }
        }
      }
    }
  };
  prototype.getNextCell = function() {
    return $("<div class='" + this._options.__classCell_a__ + "'/>").appendTo(this.__foot_a__)
  };
  prototype.__sumRenderer_h__ = function(name, sum) {
    return"<span class='" + this._options.__classTitle_r__ + "'>" + name + " : </span><span class='" + this._options.__classContent_s__ + "'>" + sum + "</span>"
  };
  Footer.__calSum_a__ = function(datalist, key) {
    var sum = 0, tmp, len = datalist.length, i = 0;
    for(;i < len;i++) {
      if(typeof(tmp = datalist[i][key]) === "string") {
        tmp = tmp.toFloat()
      }
      sum += isNaN(tmp) ? 0 : tmp
    }
    return sum
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.require("jx.data.DataManager");
goog.provide("jx.grid.Cell");
(function() {
  goog.exportSymbol("jx.grid.Cell", Cell);
  JGM._add("Cell", Cell);
  function Cell(args) {
    this.grid = args.grid;
    this.__datarow_h__ = args.datarow;
    this.__colDef_i__ = args.colDef;
    this.__init(args)
  }
  Cell.getInstance = function(args) {
    return new Cell(args)
  };
  var prototype = Cell.prototype;
  prototype.__init = function(args) {
    if(Util.isNull(this.__datarow_h__)) {
      if(Util.isNotNull(args.row)) {
        this.__datarow_h__ = this.grid.dataMgr.getByIdx(args.row)
      }else {
        if(Util.isNotNull(args.node)) {
          this.__datarow_h__ = this.grid.dataMgr.getByNode(args.node.parentNode)
        }else {
          if(Util.isNotNull(args.$)) {
            this.__datarow_h__ = this.grid.dataMgr.getByNode(args.$[0].parentNode)
          }
        }
      }
    }
    if(Util.isNull(this.__colDef_i__)) {
      if(Util.isNotNull(args.col)) {
        this.__colDef_i__ = this.grid.colDefMgr.get(args.col)
      }else {
        if(Util.isNotNull(args.node)) {
          this.__colDef_i__ = this.grid.colDefMgr.get(Util.index(args.node))
        }else {
          if(Util.isNotNull(args.$)) {
            this.__colDef_i__ = this.grid.colDefMgr.get(Util.index(args.$[0]))
          }
        }
      }
    }
    if(Util.isNullOr(this.__datarow_h__, this.__colDef_i__) && Util.isNotNull(args.event)) {
      var node = this.grid.view.__getClosestCell_Az__(args.event.target);
      if(Util.isNotNull(node)) {
        this.__datarow_h__ = this.grid.dataMgr.getByNode(node.parentNode);
        this.__colDef_i__ = this.grid.colDefMgr.get(Util.index(node))
      }
    }
  };
  prototype.destroy = function() {
    delete this.grid;
    delete this.__datarow_h__;
    delete this.__colDef_i__
  };
  prototype.getRowIdx = function() {
    if(Util.isNotNull(this.__datarow_h__)) {
      return this.grid.dataMgr.getIdx(this.__datarow_h__)
    }
  };
  prototype.getColIdx = function() {
    if(Util.isNotNull(this.__colDef_i__)) {
      return this.grid.colDefMgr.getIdx(this.__colDef_i__)
    }
  };
  prototype.getNode = function() {
    if(Util.isNotNullAnd(this.__datarow_h__, this.__colDef_i__)) {
      return this.grid.view.getCellByIdAndKey(this.grid.dataMgr.getId(this.__datarow_h__), this.__colDef_i__.key)
    }
  };
  prototype.getRowNode = function() {
    return this.grid.view.getRow(this.__datarow_h__)
  };
  prototype.get$ = function() {
    var cellNode = this.getNode();
    if(cellNode !== undefined) {
      return $(cellNode)
    }
    return $([])
  };
  prototype.getDatarow = function() {
    return this.__datarow_h__
  };
  prototype.getColDef = function() {
    return this.__colDef_i__
  };
  prototype.getKey = function() {
    if(Util.isNotNull(this.__colDef_i__)) {
      return this.__colDef_i__.key
    }
  };
  prototype.getId = function() {
    return this.grid.dataMgr.getId(this.__datarow_h__)
  };
  prototype.getValue = function() {
    if(Util.isNotNullAnd(this.__datarow_h__, this.__colDef_i__)) {
      return this.__datarow_h__[this.__colDef_i__.key]
    }
  };
  prototype.isValid = function() {
    return Util.isNotNull(this.getNode())
  };
  prototype.isInvalid = function() {
    return Util.isNull(this.getNode())
  };
  prototype.isEmpty$ = function() {
    return this.get$().length === 0
  };
  prototype.has$ = function() {
    return this.get$().length !== 0
  };
  prototype.equals = function(cell) {
    return Util.isNotNull(cell) && Util.isNotNull(this.__datarow_h__) && this.__datarow_h__ === cell.getDatarow() && Util.isNotNull(this.__colDef_i__) && this.__colDef_i__ === cell.getColDef()
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.data.DataManager");
goog.require("jx.grid.Cell");
goog.provide("jx.grid.SelectionManager");
(function() {
  goog.exportSymbol("jx.grid.SelectionManager", SelectionManager);
  JGM._add("SelectionManager", SelectionManager);
  function SelectionManager(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.selMgr = this;
    var options = {__rowSelKey_a__:this.grid.dataMgr.idKey, __bgColorSelection_b__:"#DCEBFE", __bgColorLast_c__:"#f1ca7f", __bgColorRange_d__:"#D9D9D9", __classSelection_e__:"jgrid-selection", __classLast_f__:"selection-last", __classRange_g__:"selection-range", __multiSelectEnabled_h__:false, classRowSelected:"rowSelected", highlightRowEnabled:true, bgColorRowSelected:"#d8dfea"};
    this._options = JGM.__extend_e__(options, args.options, {rowSelKey:"__rowSelKey_a__", bgColorSelection:"__bgColorSelection_b__", bgColorLast:"__bgColorLast_c__", bgColorRange:"__bgColorRange_d__", classSelection:"__classSelection_e__", classLast:"__classLast_f__", classRange:"__classRange_g__", multiSelectEnabled:"__multiSelectEnabled_h__"});
    this.__consts_a__ = {__UP_a__:1, __DOWN_b__:2, __LEFT_c__:3, __RIGHT_d__:4, __PGDN_f__:5, __PGUP_g__:6, __HOME_h__:7, __END_i__:8, __NAVKEYS_e__:{}};
    this.__consts_a__.__NAVKEYS_e__ = Util.which(["enter", "tab", "arrow", "pgdn", "pgup", "home", "end"]);
    this.__last_b__;
    this.__range_c__;
    this.__rows_d__ = {length:0};
    this.__cols_e__ = {length:0};
    this.__init()
  }
  SelectionManager.getInstance = function(args) {
    return new SelectionManager(args)
  };
  var prototype = SelectionManager.prototype;
  prototype.__init = function() {
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    this.grid.event.bind({onGetCellClass:this.__onGetCellClass_aI__, onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__, keydownCanvas:this.__keydownCanvas_ba__, dragoverCanvas:this.__dragoverCanvas_be__, mousedownCanvas:this.__mousedownCanvas_bf__, onBeforeRerender:this.__onBeforeRerender_t__, onAfterRerender:this.onAfterRerender, onBeforeDataChange:this.onBeforeDataChange}, this)
  };
  prototype.__destroy_aA__ = function() {
    JGM.__deleteMap_l__(this.__consts_a__, "__NAVKEYS_e__");
    var i, rows = this.__rows_d__, cols = this.__cols_e__;
    for(i in rows) {
      if(rows.hasOwnProperty(i) && i !== "length") {
        JGM.__deleteMap_l__(rows, i)
      }
    }
    for(i in cols) {
      if(cols.hasOwnProperty(i) && i !== "length") {
        JGM.__deleteMap_l__(cols, i)
      }
    }
    JGM._destroy(this, {name:"SelectionManager", path:"selMgr", map:"__rows_d__ __cols_e__ __range_c__ __last_b__ __consts_a__ _options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var rules = this.grid.event.trigger("onBeforeCreateSelCss"), gridId = "#" + this.grid.mid + " .", opt = this._options;
    if(opt.highlightRowEnabled === true) {
      rules.push(gridId + opt.classRowSelected + " > *{background:" + opt.bgColorRowSelected + "}")
    }
    if(opt.__multiSelectEnabled_h__ === true) {
      rules.push(gridId + opt.__classSelection_e__ + "{background:" + opt.__bgColorSelection_b__ + "}");
      rules.push(gridId + opt.__classRange_g__ + "{background:" + opt.__bgColorRange_d__ + "}")
    }
    rules.push(gridId + opt.__classLast_f__ + "{background:" + opt.__bgColorLast_c__ + "}");
    return rules.join("\n")
  };
  prototype.__onGetCellClass_aI__ = function(row, col, datarow, colDef) {
    var css = "", last = this.__last_b__, range = this.__range_c__, rows = this.__rows_d__, opt = this._options;
    if(Util.isNotNull(last) && last.getDatarow() === datarow && last.getColDef() === colDef) {
      css += opt.__classLast_f__
    }
    if(opt.__multiSelectEnabled_h__ === true) {
      if(Util.isNotNull(range) && range.getDatarow() === datarow && range.getColDef() === colDef) {
        css += " " + opt.__classRange_g__
      }
      if(rows.hasOwnProperty(row) && rows[row].hasOwnProperty(col)) {
        css += " " + opt.__classSelection_e__
      }
    }
    return css
  };
  prototype.__mousedownCanvas_bf__ = function(e, cell) {
    if(Util.isNotNull(this.__last_b__) && this.__last_b__.equals(cell)) {
      return
    }
    this.grid.event.trigger("onBeforeSelect", [e, cell]);
    if(this._options.__multiSelectEnabled_h__ === false) {
      this.selectCell(cell)
    }else {
      if(e.shiftKey && Util.isNotNullAnd(this.__last_b__, this.__range_c__)) {
        this.selectRange(cell)
      }else {
        if(e.ctrlKey) {
          if(cell.getKey() === this._options.__rowSelKey_a__) {
            this.addRow(cell)
          }else {
            this.addCell(cell)
          }
        }else {
          this.selectCell(cell)
        }
      }
    }
  };
  prototype.__dragoverCanvas_be__ = function(e, cell) {
    if(this._options.__multiSelectEnabled_h__ === false) {
      this.selectCell(cell)
    }else {
      if(Util.isNotNullAnd(this.__last_b__, this.__range_c__)) {
        this.selectRange(cell)
      }
    }
  };
  prototype.__keydownCanvas_ba__ = function(e) {
    if(Util.isNullOr(this.__last_b__, this.__range_c__)) {
      if(this.__consts_a__.__NAVKEYS_e__[e.which]) {
        this.selectCell(JGM.create("Cell", {grid:this.grid, row:this.grid.view.__getFirstSafeVisibleRow_l__(), col:this.grid.view.__getFirstSafeVisibleCol_q__()}))
      }
      return
    }
    if(this.__consts_a__.__NAVKEYS_e__[e.which]) {
      if(this.grid.event.triggerInvalid("onBeforeNavigate", [e])) {
        return
      }
      var nextCell;
      e.preventDefault();
      switch(e.which) {
        case Util.keyMapKeydown.tab:
          if(e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__LEFT_c__, this.__last_b__);
            this.selectCell(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__RIGHT_d__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.enter:
          if(e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__UP_a__, this.__last_b__);
            this.selectCell(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__DOWN_b__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.up:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__UP_a__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__UP_a__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.down:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__DOWN_b__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__DOWN_b__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.left:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__LEFT_c__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__LEFT_c__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.right:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__RIGHT_d__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__RIGHT_d__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.pgup:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__PGUP_g__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__PGUP_g__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.pgdn:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__PGDN_f__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__PGDN_f__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.space:
          if(e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__PGUP_g__, this.__last_b__);
            this.selectCell(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__PGDN_f__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.home:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__HOME_h__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__HOME_h__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break;
        case Util.keyMapKeydown.end:
          if(this._options.__multiSelectEnabled_h__ && e.shiftKey) {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__END_i__, this.__range_c__);
            this.selectRange(nextCell)
          }else {
            nextCell = this.__idxToCell_j__(this.__consts_a__.__END_i__, this.__last_b__);
            this.selectCell(nextCell)
          }
          break
      }
      this.grid.event.trigger("onAfterNavigate", [nextCell])
    }else {
      if(this.__cols_e__.length === 1) {
        var key, cmgr = this.grid.colDefMgr, col, cols = this.__cols_e__;
        for(col in cols) {
          if(cols.hasOwnProperty(col) && col !== "length") {
            key = cmgr.get(col).key;
            this.grid.event.trigger("keydownColSel_" + key + "_" + e.which + " keydownColSel_" + key, [e, cols[col], this.__last_b__])
          }
        }
      }
      if(this.__rows_d__.length === 1) {
        var row, rows = this.__rows_d__;
        for(row in rows) {
          if(rows.hasOwnProperty(row) && row !== "length") {
            this.grid.event.trigger("keydownRowSel_" + e.which + " keydownRowSel", [e, rows[row], this.__last_b__])
          }
        }
      }
      this.grid.event.trigger("keydownSel_" + e.which + " keydownSel", [e, this.__rows_d__, this.__cols_e__])
    }
  };
  prototype.getCell = function() {
    if(Util.isNotNull(this.__last_b__)) {
      return this.__last_b__
    }
  };
  prototype.__isSelected_h__ = function(cell) {
    return Util.isNotNull(this.__last_b__) && this.__last_b__.equals(cell)
  };
  JGM.Cell.prototype.isSelected = function() {
    return this.grid.selMgr.__isSelected_h__(this)
  };
  prototype.__getCellIdxToNavigate_i__ = function(dir, row, col) {
    switch(dir) {
      case this.__consts_a__.__RIGHT_d__:
        if(col < this.grid.colDefMgr.length() - 1) {
          col++
        }
        break;
      case this.__consts_a__.__LEFT_c__:
        if(col > 0) {
          col--
        }
        break;
      case this.__consts_a__.__DOWN_b__:
        if(row < this.grid.dataMgr.datalist.length - 1) {
          row++
        }
        break;
      case this.__consts_a__.__UP_a__:
        if(row > 0) {
          row--
        }
        break;
      case this.__consts_a__.__PGDN_f__:
        row += this.grid.view._options.__rowsPerPage_e__;
        if(row > this.grid.dataMgr.datalist.length - 1) {
          row = this.grid.dataMgr.datalist.length - 1
        }
        break;
      case this.__consts_a__.__PGUP_g__:
        row -= this.grid.view._options.__rowsPerPage_e__;
        if(row < 0) {
          row = 0
        }
        break;
      case this.__consts_a__.__HOME_h__:
        row = 0;
        break;
      case this.__consts_a__.__END_i__:
        row = this.grid.dataMgr.datalist.length - 1;
        break
    }
    return[row, col]
  };
  prototype.__idxToCell_j__ = function(dir, idx) {
    var newIdx = this.__getCellIdxToNavigate_i__(dir, idx.getRowIdx(), idx.getColIdx());
    return JGM.create("Cell", {grid:this.grid, row:newIdx[0], col:newIdx[1]})
  };
  prototype.selectRow = function(cell) {
    var row = cell.getRowIdx(), col = cell.getColIdx();
    this.__setRange_l__(row, col, cell);
    this.__setLast_k__(row, col, cell);
    this.__setSelMap_p__(this.__getRowMap_s__(row, col, cell))
  };
  prototype.selectCell = function(cell, noScroll) {
    this.grid.event.trigger("onBeforeSelectCell", [cell]);
    if(this._options.__multiSelectEnabled_h__ && cell.getKey() === this._options.__rowSelKey_a__) {
      this.selectRow(cell)
    }else {
      var row = cell.getRowIdx(), col = cell.getColIdx();
      this.__setRange_l__(row, col, cell, noScroll);
      this.__setLast_k__(row, col, cell);
      this.__setSelMap_p__(this.__getCellMap_q__(row, col, cell))
    }
    this.grid.event.trigger("onAfterSelectCell", [cell])
  };
  prototype.onBeforeDataChange = function() {
  };
  prototype.__onBeforeRerender_t__ = function() {
    if(Util.isNotNull(this.__last_b__)) {
      this.toSelect = this.__last_b__
    }
    this.empty()
  };
  prototype.onAfterRerender = function() {
    if(Util.isNotNull(this.toSelect)) {
      this.selectCell(this.toSelect, true);
      this.grid.view.scrollToRowLazy(this.toSelect.getRowIdx())
    }
  };
  prototype.addRow = function(cell) {
    var row = cell.getRowIdx(), col = cell.getColIdx();
    this.__setRange_l__(row, col, cell);
    this.__setLast_k__(row, col, cell);
    this.__addSelMap_m__(this.__getRowMap_s__(row, col, cell))
  };
  prototype.addCell = function(cell) {
    var row = cell.getRowIdx(), col = cell.getColIdx();
    this.__setRange_l__(row, col, cell);
    this.__setLast_k__(row, col, cell);
    this.__addSelMap_m__(this.__getCellMap_q__(row, col, cell))
  };
  prototype.selectRange = function(cell) {
    var row = cell.getRowIdx(), col = cell.getColIdx(), lastRow = this.__last_b__.getRowIdx(), lastCol = this.__last_b__.getColIdx(), minRow = lastRow < row ? lastRow : row, maxRow = lastRow < row ? row : lastRow, minCol, maxCol;
    this.__setRange_l__(row, col, cell);
    if(cell.getKey() === this._options.__rowSelKey_a__) {
      minCol = 0;
      maxCol = this.grid.colDefMgr.length() - 1
    }else {
      minCol = lastCol < col ? lastCol : col;
      maxCol = lastCol < col ? col : lastCol
    }
    this.__setSelMap_p__(this.__getRangeMap_r__(minRow, minCol, maxRow, maxCol, row, col, cell));
    return{minRow:minRow, minCol:minCol, maxRow:maxRow, maxCol:maxCol}
  };
  prototype.__setLast_k__ = function(row, col, cell) {
    var last = this.__last_b__, lastRow;
    if(Util.isNotNull(last)) {
      lastRow = last.getRowIdx();
      if(row !== lastRow && Util.isNotNull(this.__range_c__) && lastRow !== this.__range_c__.getRowIdx()) {
        this.grid.view.unlockRowById(last.getId())
      }
      last.get$().removeClass(this._options.__classLast_f__);
      if(this._options.highlightRowEnabled === true) {
        $(last.getRowNode()).removeClass(this._options.classRowSelected)
      }
      if(Util.isNull(cell)) {
        delete this.__last_b__
      }
    }
    if(Util.isNull(cell)) {
      return
    }
    (this.__last_b__ = cell).get$().addClass(this._options.__classLast_f__);
    if(this._options.highlightRowEnabled === true) {
      $(cell.getRowNode()).addClass(this._options.classRowSelected)
    }
    this.grid.view.lockRowByIdx(row)
  };
  prototype.__setRange_l__ = function(row, col, cell, noScroll) {
    var range = this.__range_c__;
    if(Util.isNotNull(range)) {
      var rangeRow = range.getRowIdx();
      if(row === rangeRow && col === range.getColIdx()) {
        return
      }
      if(row !== rangeRow && Util.isNotNull(this.__last_b__) && rangeRow !== this.__last_b__.getRowIdx()) {
        this.grid.view.unlockRowById(range.getId())
      }
      range.get$().removeClass(this._options.__classRange_g__);
      if(Util.isNull(cell)) {
        delete this.__range_c__
      }
    }
    if(Util.isNull(cell)) {
      return
    }
    (this.__range_c__ = cell).get$().addClass(this._options.__classRange_g__);
    var view = this.grid.view;
    view.lockRowByIdx(row);
    if(!noScroll) {
      view.scrollToLazy(row, col)
    }
  };
  prototype.__addSelMap_m__ = function(map) {
    var rowsmap = this.__rows_d__, rowmap, addrow, r, c, view = this.grid.view, toAddClass = {};
    for(r in map) {
      if(map.hasOwnProperty(r)) {
        addrow = map[r];
        if(rowsmap.hasOwnProperty(r)) {
          rowmap = rowsmap[r];
          for(c in addrow) {
            if(addrow.hasOwnProperty(c)) {
              if(rowmap.hasOwnProperty(c)) {
                if(addrow[c] instanceof JGM.Cell) {
                  rowmap[c] = addrow[c]
                }
                delete addrow[c]
              }
            }
          }
        }
      }
    }
    this.addOrRemoveCss(toAddClass, true);
    this.__addToMaps_n__(map)
  };
  prototype.__setSelMap_p__ = function(map) {
    var rowsmap = this.__rows_d__, rowmap, colmap, addrow, r, c, view = this.grid.view, toRemoveClass = {}, toRemoveRow, removeMap = {};
    for(r in rowsmap) {
      if(rowsmap.hasOwnProperty(r) && r !== "length") {
        rowmap = rowsmap[r];
        if(map.hasOwnProperty(r)) {
          addrow = map[r];
          for(c in rowmap) {
            if(rowmap.hasOwnProperty(c) && c !== "length") {
              if(addrow.hasOwnProperty(c)) {
                if(addrow[c] instanceof JGM.Cell) {
                  rowmap[c] = addrow[c]
                }
                delete addrow[c]
              }else {
                if(!removeMap.hasOwnProperty(r)) {
                  removeMap[r] = {}
                }
                removeMap[r][c] = true
              }
            }
          }
        }else {
          colmap = removeMap[r] = {};
          for(c in rowmap) {
            if(rowmap.hasOwnProperty(c) && c !== "length") {
              colmap[c] = true
            }
          }
        }
      }
    }
    this.__removeFromMaps_o__(removeMap);
    this.addOrRemoveCss(toRemoveClass, false);
    this.__addSelMap_m__(map)
  };
  prototype.addOrRemoveCss = function(map, add) {
    var list = [], r, c, row, view = this.grid.view;
    for(r in map) {
      if(map.hasOwnProperty(r)) {
        row = map[r];
        for(c in row) {
          if(row.hasOwnProperty(c)) {
            if(row[c] instanceof JGM.Cell) {
              list.push(row[c].getNode())
            }else {
              list.push(view.getCell(r, c))
            }
          }
        }
      }
    }
    list = list.filter(function(n) {
      return Util.isNotNull(n)
    });
    if(add) {
      $(list).addClass(this._options.__classSelection_e__)
    }else {
      $(list).removeClass(this._options.__classSelection_e__)
    }
  };
  prototype.__addToMaps_n__ = function(map) {
    var r, c, cell, rowmap = this.__rows_d__, colmap = this.__cols_e__, row;
    for(r in map) {
      if(map.hasOwnProperty(r)) {
        row = map[r];
        for(c in row) {
          if(row.hasOwnProperty(c)) {
            cell = Util.isNull(cell = row[c]) ? true : cell;
            if(rowmap.hasOwnProperty(r)) {
              rowmap[r].length++
            }else {
              rowmap[r] = {length:1};
              rowmap.length++
            }
            rowmap[r][c] = cell;
            if(colmap.hasOwnProperty(c)) {
              colmap[c].length++
            }else {
              colmap[c] = {length:1};
              colmap.length++
            }
            colmap[c][r] = cell
          }
        }
      }
    }
  };
  prototype.__removeFromMaps_o__ = function(map) {
    var r, c, rowmap = this.__rows_d__, colmap = this.__cols_e__, row;
    for(r in map) {
      if(map.hasOwnProperty(r)) {
        row = map[r];
        for(c in row) {
          if(row.hasOwnProperty(c)) {
            if(--rowmap[r].length === 0) {
              delete rowmap[r];
              rowmap.length--
            }else {
              delete rowmap[r][c]
            }
            if(--colmap[c].length === 0) {
              delete colmap[c];
              colmap.length--
            }else {
              delete colmap[c][r]
            }
          }
        }
      }
    }
  };
  prototype.__getCellMap_q__ = function(row, col, cell) {
    var map = {};
    map[row] = {};
    map[row][col] = cell;
    return map
  };
  prototype.__getRowMap_s__ = function(row, col, cell) {
    var map = {}, collen = this.grid.colDefMgr.length(), i = 0;
    map[row] = {};
    for(;i < collen;i++) {
      map[row][i] = true
    }
    map[row][col] = cell;
    return map
  };
  prototype.__getRangeMap_r__ = function(rowMin, colMin, rowMax, colMax, row, col, cell) {
    var map = {}, i = rowMin, j;
    for(;i <= rowMax;i++) {
      map[i] = {};
      j = colMin;
      for(;j <= colMax;j++) {
        map[i][j] = true
      }
    }
    map[row][col] = cell;
    return map
  };
  prototype.empty = function() {
    this.__setLast_k__();
    this.__setRange_l__();
    this.__setSelMap_p__({})
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.Cell");
goog.provide("jx.grid.EditManager");
goog.provide("jx.grid.Editor");
(function() {
  goog.exportSymbol("jx.grid.EditManager", EditManager);
  goog.exportSymbol("jx.grid.Editor", Editor);
  JGM._add("EditManager", EditManager);
  JGM._add("Editor", Editor);
  function EditManager(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.editMgr = this;
    var options = {__classEdit_a__:"jgrid-edit", __classCellEditable_b__:"jgrid-editable", __classCellNotEditable_c__:"jgrid-notEditable", __editableBgEnabled_d__:false, __notEditableBgEnabled_e__:false, __editableBg_f__:"#FFF", __notEditableBg_g__:"#F6F6F6", __deleteEnabled_h__:false, __editIconEnabled_i__:true, __urlEditIcon_j__:this.grid._options.imageUrl + "editable-small.png", __classEditIcon_k__:"edit-icon", __editIconWidth_l__:12, __editIconPadding_m__:3, __basicBackground_n__:"#FFF9D7", classSuccess:"edit-success", 
    successBackground:"#cdf7b6", classFailure:"edit-failure", failureBackground:"#ffcec5"};
    this._options = JGM.__extend_e__(options, args.options, {classEdit:"__classEdit_a__", classCellEditable:"__classCellEditable_b__", classCellNotEditable:"__classCellNotEditable_c__", editableBgEnabled:"__editableBgEnabled_d__", notEditableBgEnabled:"__notEditableBgEnabled_e__", editableBg:"__editableBg_f__", notEditableBg:"__notEditableBg_g__", deleteEnabled:"__deleteEnabled_h__", editIconEnabled:"__editIconEnabled_i__", urlEditIcon:"__urlEditIcon_j__", classEditIcon:"__classEditIcon_k__", editIconWidth:"__editIconWidth_l__", 
    editIconPadding:"__editIconPadding_m__", basicBackground:"__basicBackground_n__"});
    this.editor;
    this.__beginEditKeys_c__ = Util.which(["number", "alphabet", "del", "backspace"]);
    this.beingCommitted;
    this.__init()
  }
  EditManager.getInstance = function(args) {
    return new EditManager(args)
  };
  var prototype = EditManager.prototype;
  prototype.__init = function() {
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    var events = {onGetColCellClass:this.__onGetColCellClass_f__, keydownCanvas:this.__keydownCanvas_ba__, onDestroy:this.__destroy_aA__, dblclickCanvas:this.__dblclickCanvas_bi__, onCreateDynamicCss:this.onCreateDynamicCss, "onBeforeNavigate onBeforeRefresh onBeforeSelect":this.commit, onBeforeFocusCanvas:this.notActive};
    if(Util.isNull(this.grid.selMgr)) {
      events.onCreateCss = this.__onBeforeCreateSelCss_d__
    }else {
      events.onBeforeCreateSelCss = this.__onBeforeCreateSelCss_d__
    }
    if(this._options.__deleteEnabled_h__) {
      events["keydownSel_" + Util.keyMapKeydown.del] = this.__deleteContents_i__
    }
    if(this._options.__editIconEnabled_i__) {
      var colDefs = this.grid.colDefMgr.get(), len = colDefs.length, i = 0;
      for(;i < len;i++) {
        if(Util.isNotNull(colDefs[i].editor)) {
          events["onRenderHeader_" + colDefs[i].key + "_prepend"] = this.__onRenderHeader_aH__
        }
      }
    }
    this.grid.event.bind(events, this)
  };
  prototype.__destroy_aA__ = function() {
    this.__deleteEditor_g__();
    JGM._destroy(this, {name:"EditManager", path:"editMgr", map:"__beginEditKeys_c__ _options"})
  };
  prototype.__onBeforeCreateSelCss_d__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, rules = [], height = this.grid.view.__getRowInnerHeight_AO__();
    rules.push(this.grid.view.__getCellSelector_AG__() + "." + o.__classEdit_a__ + "{background:" + o.__basicBackground_n__ + "}");
    rules.push(gridId + o.__classEdit_a__ + " input{position:absolute;z-index:10;top:0;padding:0;border:0;margin:0;background:" + o.__basicBackground_n__ + ";height:" + height + "px;line-height:" + height + "px}");
    if(o.__editableBgEnabled_d__) {
      rules.push(gridId + o.__classCellEditable_b__ + "{background:" + o.__editableBg_f__ + "}")
    }
    if(o.__notEditableBgEnabled_e__) {
      rules.push(gridId + o.__classCellNotEditable_c__ + "{background:" + o.__notEditableBg_g__ + "}")
    }
    if(o.__editIconEnabled_i__) {
      rules.push(gridId + o.__classEditIcon_k__ + "{float:left;position:absolute;left:0;top:0;padding:0 " + o.__editIconPadding_m__ + "px;width:" + o.__editIconWidth_l__ + "px;height:" + height + "px;background:url(" + o.__urlEditIcon_j__ + ") no-repeat center transparent}")
    }
    rules.push(gridId + o.classSuccess + "{background:" + o.successBackground + "}");
    rules.push(gridId + o.classFailure + "{background:" + o.failureBackground + "}");
    return rules.join("")
  };
  prototype.onCreateDynamicCss = function() {
    var cellSel = this.grid.view.__getCellSelector_AG__(), padding = this.grid.view.__getPadding_AM__(), colDefs = this.grid.colDefMgr.get(), i = 0, str = "";
    for(;i < colDefs.length;i++) {
      if(Util.isNotNull(colDefs[i].editor)) {
        str += cellSel + ".k_" + colDefs[i].key + " .basic-editor{width:" + (colDefs[i].width - 2 * padding) + "px}"
      }
    }
    return str
  };
  prototype.__onRenderHeader_aH__ = function(html) {
    html.push("<span class='" + this._options.__classEditIcon_k__ + "'></span>")
  };
  prototype.__onRenderCell_aH__ = function(rowIdx, colIdx, datarow, colDef, cellHtml) {
    if(this.grid.dataMgr.isReal(datarow)) {
      cellHtml.push("<span class='" + this._options.__classEditIcon_k__ + "' title='  ' onclick='JGM.m.EditManager." + this.mid + '.beginEdit("' + datarow[this.grid.dataMgr.idKey] + '","' + colDef.key + "\")'></span>")
    }
  };
  prototype.cancelMouseEvent = function(e) {
    return!Util.hasTagAndClass(e.target, "DIV", this._options.__classEditIcon_k__)
  };
  prototype.beginEdit = function(id, key) {
    this.begin(JGM.create("Cell", {grid:this.grid, datarow:this.grid.dataMgr.getById(id), colDef:this.grid.colDefMgr.getByKey(key)}))
  };
  prototype.__dblclickCanvas_bi__ = function(e, cell) {
    if(!cell.isEdited()) {
      this.begin(cell)
    }
  };
  prototype.__keydownCanvas_ba__ = function(e) {
    if(this.active()) {
      if(e.which === Util.keyMapKeydown.esc) {
        this.cancel()
      }
    }else {
      if(e.ctrlKey) {
        return
      }else {
        if(!e.altKey && Util.isNotNull(this.grid.selMgr)) {
          if(e.which === Util.keyMapKeydown.del && this._options.__deleteEnabled_h__) {
            this.__deleteContent_h__(this.grid.selMgr.getCell())
          }else {
            if(this.__beginEditKeys_c__[e.which]) {
              this.begin(this.grid.selMgr.getCell())
            }else {
              if(e.which === Util.keyMapKeydown.f2) {
                e.preventDefault();
                this.begin(this.grid.selMgr.getCell())
              }
            }
          }
        }
      }
    }
  };
  prototype.active = function() {
    return Util.isNotNull(this.editor)
  };
  prototype.notActive = function() {
    return Util.isNull(this.editor)
  };
  prototype.__isEdited_e__ = function(cell) {
    return this.active() && this.editor.cell.equals(cell)
  };
  prototype.__onGetColCellClass_f__ = function(colDef) {
    if(Util.isNotNull(colDef.editor)) {
      return this._options.__classCellEditable_b__
    }else {
      return this._options.__classCellNotEditable_c__
    }
  };
  JGM.Cell.prototype.isEdited = function() {
    return this.grid.editMgr.__isEdited_e__(this)
  };
  JGM.Cell.prototype.setValue = function(value) {
    var datarow = this.getDatarow(), key = this.getKey(), res;
    if(Util.isNotNullAnd(datarow, key)) {
      res = this.grid.dataMgr.updateByKey(datarow, key, value, {noSort:true, noFilter:true, noRerender:true});
      if(res === true) {
        this.grid.view.rerenderRow(datarow)
      }
    }
    return res
  };
  prototype.isEditable = function(cell) {
    return Util.isNotNull(cell) && Util.isNotNull(cell.getColDef().editor) && this.grid.dataMgr.isReal(cell.getDatarow())
  };
  prototype.begin = function(cell) {
    if(this.active()) {
      this.commit()
    }
    if(!this.isEditable(cell)) {
      return
    }
    this.editor = cell.getColDef().editor;
    this.editor.cell = cell;
    this.editor.grid = this.grid;
    var node = cell.getNode();
    this.editor.before = node.innerHTML;
    node.innerHTML = this.editor.edit(cell.getValue());
    cell.get$().addClass(this._options.__classEdit_a__);
    this.editor.focus()
  };
  prototype.cancel = function() {
    if(!this.active()) {
      return
    }
    var cell = this.editor.cell;
    cell.getNode().innerHTML = this.editor.before;
    this.__deleteEditor_g__();
    cell.get$().removeClass(this._options.__classEdit_a__);
    this.grid.view.focus()
  };
  prototype.__deleteEditor_g__ = function() {
    if(Util.isNotNull(this.editor)) {
      delete this.editor.grid;
      delete this.editor.cell;
      delete this.editor.before;
      delete this.editor
    }
  };
  prototype.commit = function() {
    if(this.beingCommitted || !this.active()) {
      return
    }
    this.beingCommitted = true;
    var cell = this.editor.cell, value = this.editor.value(cell.getNode()), $cell;
    if(value == cell.getValue()) {
      this.cancel()
    }else {
      var res = cell.setValue(value), classRes;
      $cell = cell.get$();
      if(res instanceof Error) {
        this.cancel();
        classRes = this._options.classFailure;
        $cell.addClass(classRes);
        setTimeout(function() {
          $cell.removeClass(classRes)
        }, 1E3)
      }else {
        this.__deleteEditor_g__();
        this.grid.view.focus();
        classRes = this._options.classSuccess;
        this.grid.printMessage("Successfully Updated.");
        $cell.addClass(classRes);
        setTimeout(function() {
          $cell.removeClass(classRes)
        }, 1E3)
      }
    }
    cell.get$().removeClass(this._options.__classEdit_a__);
    this.beingCommitted = false
  };
  prototype.__deleteContent_h__ = function(cell) {
    if(this.active() || !this.isEditable(cell)) {
      return
    }
    var colDef = cell.getColDef();
    if(cell.getValue() === colDef.defaultValue) {
      return
    }
    cell.setValue(colDef.defaultValue)
  };
  prototype.__deleteContents_i__ = function(e, selectionRows, selectionCols) {
    if(this.active()) {
      return
    }
    var updates = {}, fakerows = {}, updatelist = [], col, colDef, defaultValue, key, cell, datarow, selCol, row;
    col_loop:for(col in selectionCols) {
      if(!selectionCols.hasOwnProperty(col) || col === "length") {
        continue
      }
      colDef = undefined;
      defaultValue = undefined;
      key = undefined;
      selCol = selectionCols[col];
      row_loop:for(row in selCol) {
        if(!selCol.hasOwnProperty(row) || row === "length" || fakerows.hasOwnProperty(row)) {
          continue
        }
        cell = selCol[row].cell;
        if(Util.isNull(colDef)) {
          colDef = cell.getColDef();
          defaultValue = colDef.defaultValue;
          key = colDef.key;
          if(Util.isNull(colDef.editor)) {
            continue col_loop
          }
        }
        if(Util.isNotNull(updates[row])) {
          datarow = updates[row].datarow
        }else {
          datarow = cell.getDatarow()
        }
        if(!this.grid.dataMgr.isReal(datarow)) {
          fakerows[row] = true;
          continue
        }
        if(defaultValue === datarow[key]) {
          continue
        }
        if(Util.isNull(updates[row])) {
          updates[row] = {datarow:datarow, change:{}};
          updatelist.push(updates[row])
        }
        updates[row].change[key] = defaultValue
      }
    }
    if(updatelist.length !== 0) {
      this.grid.dataMgr.updateList(updatelist)
    }
  };
  function Editor(args) {
    var i;
    for(i in args) {
      if(args.hasOwnProperty(i)) {
        this[i] = args[i]
      }
    }
  }
  Editor.getInstance = function(args) {
    return new Editor(args)
  };
  prototype = Editor.prototype;
  prototype.edit = function(value) {
    return"<input type='text' class='basic-editor' value='" + Util.ifNull(value, "") + "' style='position:relative'/>"
  };
  prototype.focus = function() {
    var node = this.cell.getNode().childNodes[0];
    if(Util.isFunction(node.setActive)) {
      try {
        node.setActive()
      }catch(e) {
      }
    }
    node.focus();
    if(document.activeElement !== node) {
      this.cell.get$().children(":eq(0)").focus()
    }
  };
  prototype.value = function(wrapperNode) {
    return wrapperNode.childNodes[0].value
  };
  prototype.path = function() {
    return"JGM.m.Editor." + this.mid
  };
  Editor.numberKeys = Util.which(["number", "del", "backspace"]);
  Editor.isNumberKey = function(keyCode) {
    return this.numberKeys[keyCode] ? true : false
  };
  Editor.numberEdit = function(cell) {
    var value = cell.getValue();
    return"<input type='text' class='basic-editor' onkeydown='if (!JGM.Editor.isNumberKey(event.which)) return false;' value='" + Util.ifNull(value, "") + "'/>"
  };
  Editor.floatKeys = Util.which(["number", ".", "del", "backspace"]);
  Editor.isFloatKey = function(keyCode) {
    return this.floatKeys[keyCode] ? true : false
  };
  Editor.floatEdit = function(cell) {
    var value = cell.getValue();
    return"<input type='text' class='basic-editor' onkeydown='if (!JGM.Editor.isFloatKey(event.which)) return false;' value='" + Util.ifNull(value, "") + "'/>"
  };
  Editor.alphabetKeys = Util.which(["alphabet", "del", "backspace", "space"]);
  Editor.isAlphabet = function(keyCode) {
    return this.alphabetKeys[keyCode] ? true : false
  };
  Editor.alphabetEdit = function(cell) {
    var value = cell.getValue();
    return"<input type='text' class='basic-editor' onkeydown='if (!JGM.Editor.isAlphabet(event.which)) return false;' value='" + Util.ifNull(value, "") + "'/>"
  }
})();
goog.require("jx.util");
goog.require("jx.util$");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.provide("jx.grid.PrintManager");
(function() {
  goog.exportSymbol("jx.grid.PrintManager", PrintManager);
  JGM._add("PrintManager", PrintManager);
  function PrintManager(args) {
    this.mid = args.mid;
    this._ctnr = Util$.safe$(args.container);
    this.grid = args.grid;
    var options = {title:"Print Preview", font:"15px arial,sans-serif", headerFontColor:"#27413E", headerBackgroundColor:"#DCDEDE", tableBorderColor:"#6E7174", headerBorderColor:"#909192", cellBorderColor:"#D0D7E5", winOptions:{name:"Print Preview", width:800, height:600, directories:"no", location:"no", menubar:"no", status:"no", toolbar:"no"}};
    this._options = JGM.__extend_e__(options, args.options);
    this.__init()
  }
  PrintManager.getInstance = function(args) {
    return new PrintManager(args)
  };
  var prototype = PrintManager.prototype;
  prototype.__init = function() {
    var manager = this;
    this._ctnr[0].innerHTML = "<button type='button'>Print</button>";
    this._ctnr.click(function() {
      manager.print()
    })
  };
  prototype.print = function() {
    var printHtml = this.getPrintHtml(this.grid.colDefMgr.get(), this.grid.dataMgr.datalist), printWin = Util.open(this._options.winOptions);
    printWin.document.write(printHtml);
    printWin.document.close()
  };
  prototype.getPrintHtml = function(colDefs, datalist) {
    var opt = this._options, tableBorderColor = opt.tableBorderColor, headerBorderColor = opt.headerBorderColor, cellBorderColor = opt.cellBorderColor, html = [], collen = colDefs.length, lastCol = collen - 1, datalen = datalist.length, last = datalen - 1, datarow, i = 0, j;
    html.push("<html><head>");
    html.push("<title>" + opt.title + "</title>");
    html.push("</head><body onload='window.print();'>");
    html.push("<table width='100%' cellspacing='0' cellpadding='0'><tbody><tr><td align='left'>");
    html.push("<table width='100%' cellspacing='0' cellpadding='2' style='border-collapse:collapse'>");
    html.push("<tbody style='font:" + opt.font + ";'>");
    html.push("<tr style='background-color:" + opt.headerBackgroundColor + ";color:" + opt.headerFontColor + ";text-align:center'>");
    for(;i < collen;i++) {
      html.push("<td style='border:solid 1px " + headerBorderColor + ";'>" + colDefs[i].name + "</td>")
    }
    html.push("</tr>");
    for(i = 0;i < datalen;i++) {
      datarow = datalist[i];
      html.push("<tr>");
      if(i === 0) {
        for(j = 0;j < collen;j++) {
          if(j === 0) {
            html.push("<td style='border:solid 1px " + cellBorderColor + ";border-top:solid 1px " + headerBorderColor + ";border-left:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
          }else {
            if(j === lastCol) {
              html.push("<td style='border:solid 1px " + cellBorderColor + ";border-top:solid 1px " + headerBorderColor + ";border-right:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
            }else {
              html.push("<td style='border:solid 1px " + cellBorderColor + ";border-top:solid 1px " + headerBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
            }
          }
        }
      }else {
        if(i < last) {
          for(j = 0;j < collen;j++) {
            if(j === 0) {
              html.push("<td style='border:solid 1px " + cellBorderColor + ";border-left:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
            }else {
              if(j === lastCol) {
                html.push("<td style='border:solid 1px " + cellBorderColor + ";border-right:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
              }else {
                html.push("<td style='border:solid 1px " + cellBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
              }
            }
          }
        }else {
          for(j = 0;j < collen;j++) {
            if(j === 0) {
              html.push("<td style='border:solid 1px " + cellBorderColor + ";border-bottom:solid 1px " + tableBorderColor + ";border-left:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
            }else {
              if(j === lastCol) {
                html.push("<td style='border:solid 1px " + cellBorderColor + ";border-bottom:solid 1px " + tableBorderColor + ";border-right:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
              }else {
                html.push("<td style='border:solid 1px " + cellBorderColor + ";border-bottom:solid 1px " + tableBorderColor + "'>" + datarow[colDefs[j].key] + "</td>")
              }
            }
          }
        }
      }
      html.push("</tr>")
    }
    html.push("</tbody></table></td></tr></tbody></table></body></html>");
    return html.join("")
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.provide("jx.grid.ColumnHeader");
(function() {
  goog.exportSymbol("jx.grid.ColumnHeader", ColHeader);
  JGM._add("ColHeader", ColHeader);
  function ColHeader(args) {
    this.mid = args.mid;
    this._ctnr = args.container;
    this.__mask_a__;
    this.__head_c__;
    this.grid = args.grid;
    this.grid.header = this;
    var options = {__reorderEnabled_a__:false, __reorderSyncEnabled_b__:true, __background_c__:"url(" + this.grid._options.imageUrl + "column-headers-bg.png) repeat-x scroll center", __backgroundHover_d__:"url(" + this.grid._options.imageUrl + "column-headers-over-bg.png) repeat-x scroll center", __backgroundPlaceholder_e__:"#646464", __sortBackground_f__:this.grid._options.imageUrl + "sort.png", __sortRight_g__:4, __sortWidth_h__:7, __sortBackgroundAsc_i__:this.grid._options.imageUrl + "sort-asc.png", 
    __sortBackgroundDesc_j__:this.grid._options.imageUrl + "sort-desc.png", __font_k__:"15px Arial,Helvetica,sans-serif", __height_l__:21, __borderThickness_n__:1, __border_o__:"solid #909192", __classHeaderMask_p__:"jgrid-header-mask", __classHeader_q__:"jgrid-header", __classColHeader_r__:"jgrid-colheader", __classColHeaderActive_s__:"jgrid-colheader-active", __classColHeaderPlaceholder_t__:"jgrid-colheader-placeholder", __classInteractive_u__:"interactive", __classColHeaderSorted_v__:"jgrid-colheader-sorted", 
    __classSort_w__:"jgrid-sort", __classSortAsc_x__:"jgrid-sort-asc", __classSortDesc_y__:"jgrid-sort-desc", __classResizeHandle_z__:"jgrid-resize-handle", __resizeHandleWidth_A__:11, __style_B__:"", __headerStyle_C__:"", __scrollerLeft_D__:1E4, __scrollerWidth_E__:1E5, __classResizeGuide_F__:"resize-guide", __resizeGuideWidth_G__:1, __resizeBackground_H__:"black;filter:alpha(opacity=40);opacity:0.4", __syncResize_I__:false, __resizeHandleBackground_J__:"black;filter:alpha(opacity=5);opacity:0.05"};
    this._options = JGM.__extend_e__(options, args.options, {reorderEnabled:"__reorderEnabled_a__", reorderSyncEnabled:"__reorderSyncEnabled_b__", background:"__background_c__", backgroundHover:"__backgroundHover_d__", backgroundPlaceholder:"__backgroundPlaceholder_e__", sortBackground:"__sortBackground_f__", sortRight:"__sortRight_g__", sortWidth:"__sortWidth_h__", sortBackgroundAsc:"__sortBackgroundAsc_i__", sortBackgroundDesc:"__sortBackgroundDesc_j__", font:"__font_k__", height:"__height_l__", 
    borderThickness:"__borderThickness_n__", border:"__border_o__", classHeaderMask:"__classHeaderMask_p__", classHeader:"__classHeader_q__", classColHeader:"__classColHeader_r__", classColHeaderActive:"__classColHeaderActive_s__", classColHeaderPlaceholder:"__classColHeaderPlaceholder_t__", classInteractive:"__classInteractive_u__", classColHeaderSorted:"__classColHeaderSorted_v__", classSort:"__classSort_w__", classSortAsc:"__classSortAsc_x__", classSortDesc:"__classSortDesc_y__", classResizeHandle:"__classResizeHandle_z__", 
    resizeHandleWidth:"__resizeHandleWidth_A__", style:"__style_B__", headerStyle:"__headerStyle_C__", scrollerLeft:"__scrollerLeft_D__", scrollerWidth:"__scrollerWidth_E__", classResizeGuide:"__classResizeGuide_F__", resizeGuideWidth:"__resizeGuideWidth_G__", resizeBackground:"__resizeBackground_H__", syncResize:"__syncResize_I__", resizeHandleBackground:"__resizeHandleBackground_J__"});
    this.__map_d__ = {};
    this.__resizeKey_n__;
    this.__resizeInitX_o__;
    this.__resizeHandleInitX_p__;
    this.__resizeInitWidth_q__;
    this.__resizeMap_r__ = {};
    this.__resizeInitColWidth_v__;
    this.__resizeGuide_w__;
    this.__resizeHandleOffset_D__;
    this.__init()
  }
  ColHeader.getInstance = function(args) {
    return new ColHeader(args)
  };
  var prototype = ColHeader.prototype;
  prototype.__init = function() {
    this.__mask_a__ = $("<div class='" + this._options.__classHeaderMask_p__ + "'>").prependTo(this._ctnr);
    this.__head_c__ = $("<div class='" + this._options.__classHeader_q__ + "'>").appendTo(this.__mask_a__);
    ColHeader.__disableSel_e__(this.__head_c__);
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    var events, colDefs = this.grid.colDefMgr.get(), len = colDefs.length, i = 0;
    events = {onRenderModules:this.__onRenderModules_aE__, onAfterRenderModules:this.__onAfterRenderModules_aF__, onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__, mousedown:this._mousedown, mouseup:this._mouseup, dragmove:this.__dragmove_H__, onScrollViewportH:this.__onScrollViewportH_bo__, onScrollViewportV:this.__onScrollViewportV_C__, onChangeSorter:this.__onChangeSorter_l__, click:this._click, onResizeCol:this.__setWidthByKey_z__};
    for(;i < len;i++) {
      if(Util.isNotNull(colDefs[i].sorter)) {
        events["clickHeader_" + colDefs[i].key] = this.__sort_i__
      }
    }
    this.grid.event.bind(events, this)
  };
  prototype.__destroy_aA__ = function() {
    if(this.__head_c__.sortable) {
      this.__head_c__.sortable("destroy")
    }
    this.__destroyResizeHandles_t__();
    JGM._destroy(this, {name:"ColHeader", path:"header", "$":"__resizeGuide_w__ __mask_a__ __head_c__", property:"_ctnr __resizeMap_r__", map:"__map_d__ _options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, border = o.__borderThickness_n__ + "px " + o.__border_o__, rules = [], colDefs = this.grid.colDefMgr.get(), len = colDefs.length, i = 0;
    rules.push(gridId + o.__classHeaderMask_p__ + "{position:relative;overflow:hidden;width:100%;font:" + o.__font_k__ + ";background:" + o.__background_c__ + ";border-bottom:" + border + ";" + o.__style_B__ + "}");
    rules.push(gridId + o.__classHeader_q__ + "{position:relative;overflow:hidden;white-space:nowrap;cursor:default;left:" + -o.__scrollerLeft_D__ + "px;width:" + o.__scrollerWidth_E__ + "px;line-height:" + o.__height_l__ + "px}");
    rules.push(gridId + o.__classColHeader_r__ + "{position:relative;overflow:hidden;float:left;text-overflow:ellipsis;text-align:center;height:" + o.__height_l__ + "px;left:" + (o.__scrollerLeft_D__ - this.grid.view.getScrollLeft()) + "px;border-right:" + border + ";" + o.__headerStyle_C__ + "}");
    rules.push(gridId + o.__classColHeader_r__ + "." + o.__classInteractive_u__ + ":hover, " + gridId + o.__classColHeaderActive_s__ + "{background:" + o.__backgroundHover_d__ + "}");
    rules.push(gridId + o.__classColHeaderActive_s__ + "{border-left:" + border + "}");
    rules.push(gridId + o.__classColHeader_r__ + "." + o.__classColHeaderPlaceholder_t__ + "{background:" + o.__backgroundPlaceholder_e__ + "!important}");
    rules.push(gridId + o.__classSort_w__ + "{position:absolute;height:" + o.__height_l__ + "px;right:" + o.__sortRight_g__ + "px;width:" + o.__sortWidth_h__ + "px;background:url(" + o.__sortBackground_f__ + ") no-repeat center transparent}");
    rules.push(gridId + o.__classSortAsc_x__ + "{background:url(" + o.__sortBackgroundAsc_i__ + ") no-repeat center transparent}");
    rules.push(gridId + o.__classSortDesc_y__ + "{background:url(" + o.__sortBackgroundDesc_j__ + ") no-repeat center transparent}");
    rules.push(gridId + o.__classResizeHandle_z__ + "{z-index:10;background:" + o.__resizeHandleBackground_J__ + ";cursor:e-resize;position:absolute;height:" + o.__height_l__ + "px;width:" + o.__resizeHandleWidth_A__ + "px}");
    rules.push(gridId + o.__classResizeGuide_F__ + "{z-index:10;position:absolute;background:" + o.__resizeBackground_H__ + ";width:" + o.__resizeGuideWidth_G__ + "px}");
    for(;i < len;i++) {
      rules.push(gridId + o.__classColHeader_r__ + "#" + this.mid + "h" + colDefs[i].key + "{" + colDefs[i].headerStyle + "}")
    }
    return rules.join("")
  };
  prototype.__widthPlus_f__ = function() {
    return this._options.__borderThickness_n__
  };
  prototype.__onScrollViewportH_bo__ = function(scrollLeft) {
    this.__head_c__[0].style.left = -this._options.__scrollerLeft_D__ - scrollLeft + "px"
  };
  prototype.__onRenderModules_aE__ = function() {
    var colDefs = this.grid.colDefMgr.get(), len = colDefs.length, i = 0, colDef, headers = [];
    for(;i < len;i++) {
      if(!(colDef = colDefs[i]).hidden) {
        this.__render_g__(headers, colDef, i)
      }
    }
    this.__head_c__[0].innerHTML = headers.join("");
    this.grid.event.trigger("onRenderHeadersComplete")
  };
  prototype.__onAfterRenderModules_aF__ = function() {
    if(this._options.__reorderEnabled_a__) {
      this.__initReorder_k__()
    }
    this.__initResizeHandles_u__();
    this.__resizeGuide_w__ = $("<div class='" + this._options.__classResizeGuide_F__ + "'>").appendTo(this.grid.view.__mask_a__);
    this.__resizeGuide_w__[0].style.top = "0px";
    this.__resizeGuide_w__[0].style.height = "0px"
  };
  prototype.__render_g__ = function(header, colDef, i) {
    if(Util.isNull(colDef)) {
      return
    }
    var name = colDef.noName ? "" : colDef.name || colDef.key, widthPlus = this.__widthPlus_f__();
    header.push("<div id='" + this.mid + "h" + colDef.key + "' class='" + this._options.__classColHeader_r__ + " " + (this._options.__reorderEnabled_a__ || Util.isNotNull(colDef.sorter) ? " " + this._options.__classInteractive_u__ : "") + "' " + (colDef.noTitle ? "" : "title='" + (colDef.title || name) + "' ") + "style='width:" + (this.grid.view.__getColOuterWidth_AK__(i) - widthPlus) + "px;' colKey='" + colDef.key + "'>");
    this.grid.event.trigger("onRenderHeader_" + colDef.key + "_prepend", [header]);
    header.push(name);
    this.grid.event.trigger("onRenderHeader_" + colDef.key + "_append", [header]);
    if(Util.isNotNull(colDef.sorter)) {
      header.push("<span class='" + this._options.__classSort_w__ + "'></span>")
    }
    header.push("</div>")
  };
  ColHeader.__disableSel_e__ = function(target) {
    Util$.safe$(target).attr("unselectable", "on").css("MozUserSelect", "none").bind("selectstart.ui", function() {
      return false
    })
  };
  prototype.get = function(key) {
    if(this.__map_d__.hasOwnProperty(key)) {
      return this.__map_d__[key]
    }
    var node = document.getElementById(this.mid + "h" + key);
    if(Util.isNull(node)) {
      return $([])
    }
    return this.__map_d__[key] = $(node)
  };
  prototype.__updateIndicator_m__ = function(key, status) {
    var colHeader = this.get(key);
    if(colHeader.length === 0) {
      return
    }
    var opt = this._options, indicator = colHeader.find("." + opt.__classSort_w__);
    if(status === 0) {
      colHeader.removeClass(opt.__classColHeaderSorted_v__);
      indicator.removeClass(opt.__classSortAsc_x__ + " " + opt.__classSortDesc_y__)
    }else {
      colHeader.addClass(opt.__classColHeaderSorted_v__);
      if(status === 1) {
        indicator.addClass(opt.__classSortAsc_x__).removeClass(opt.__classSortDesc_y__)
      }else {
        if(status === 2) {
          indicator.addClass(opt.__classSortDesc_y__).removeClass(opt.__classSortAsc_x__)
        }
      }
    }
  };
  prototype.__closest_h__ = function(obj) {
    return Util$.safe$(obj).closest("div." + this._options.__classColHeader_r__, this.__head_c__)
  };
  prototype.__getDef_y__ = function(header) {
    return this.grid.colDefMgr.getByKey(header.attr("colKey"))
  };
  prototype.__sort_i__ = function(e, colHeader, colDef) {
    var sorter = colDef.sorter;
    if(Util.isNull(sorter)) {
      return
    }
    this.grid.event.trigger("onBeforeColSort_" + colDef.key + " onBeforeColSort");
    sorter.desc = sorter.desc === false ? true : false;
    this.grid.dataMgr.refresh({sorter:sorter});
    this.grid.view.__scroll_As__()
  };
  prototype.__onChangeSorter_l__ = function(oldSorter, newSorter) {
    if(oldSorter === newSorter) {
      if(Util.isNotNull(newSorter)) {
        this.__updateIndicator_m__(newSorter.key, newSorter.desc ? 2 : 1)
      }
      return
    }
    if(Util.isNotNull(oldSorter)) {
      this.__updateIndicator_m__(oldSorter.key, 0)
    }
    if(Util.isNotNull(newSorter)) {
      this.__updateIndicator_m__(newSorter.key, newSorter.desc ? 2 : 1)
    }
  };
  prototype.__initReorder_k__ = function() {
    var thisIns = this, opt = this._options, colDefMgr = this.grid.colDefMgr, container = this.__head_c__, idSubLen = this.mid.length + 1, updatefn = function(e, ui) {
      var keys = $(container).sortable("toArray"), len = keys.length, key, i = 0;
      for(;i < len;i++) {
        key = keys[i];
        if(key === "") {
          keys[i] = ui.item.attr("id").substring(idSubLen)
        }else {
          keys[i] = key.substring(idSubLen)
        }
      }
      colDefMgr.sortByKey(keys)
    };
    container.sortable({items:"." + opt.__classColHeader_r__, axis:"x", forcePlaceholderSize:true, placeholder:opt.__classColHeaderPlaceholder_t__ + " " + opt.__classColHeader_r__, tolerance:"pointer", start:function(e, ui) {
      ui.item.addClass(thisIns._options.__classColHeaderActive_s__)
    }, stop:function(e, ui) {
      ui.item.removeClass(thisIns._options.__classColHeaderActive_s__);
      thisIns.__syncResizeHandles_A__()
    }, update:updatefn});
    if(opt.__reorderSyncEnabled_b__) {
      container.sortable("option", "change", updatefn)
    }
  };
  prototype.__getDx_s__ = function(e, colDef) {
    var dx = e.clientX - this.__resizeInitX_o__, minW = colDef.minW, maxW = Util.ifNull(colDef.maxW, Number.MAX_VALUE), initW = this.__resizeInitWidth_q__;
    if(initW + dx < minW) {
      dx = minW - initW
    }
    if(initW + dx > maxW) {
      dx = maxW - initW
    }
    return dx
  };
  prototype._click = function(e) {
    var colHeader = this.__closest_h__(e.target);
    if(colHeader.length === 0) {
      return
    }
    var colDef = this.__getDef_y__(colHeader);
    if(this.grid.event.triggerInvalid("clickHeaderValid_" + colDef.key, [e, colHeader, colDef])) {
      return
    }
    this.grid.event.trigger("clickHeader_" + colDef.key + " clickHeader", [e, colHeader, colDef])
  };
  prototype._mousedown = function(e) {
    if(Util.hasTagAndClass(e.target, "DIV", this._options.__classResizeHandle_z__)) {
      this.__resizeKey_n__ = e.target.getAttribute("key");
      this.__resizeInitWidth_q__ = this.get(this.__resizeKey_n__)[0].clientWidth;
      this.__resizeInitColWidth_v__ = this.grid.colDefMgr.getByKey(this.__resizeKey_n__).width;
      this.__resizeInitX_o__ = e.clientX;
      this.__resizeHandleInitX_p__ = this.__resizeMap_r__[this.__resizeKey_n__][0].offsetLeft;
      this.__resizeGuide_w__[0].style.left = Math.floor(this.__resizeHandleInitX_p__ + (this._options.__resizeHandleWidth_A__ - this._options.__resizeGuideWidth_G__) / 2 - this._options.__scrollerLeft_D__) + "px";
      this.__resizeGuide_w__[0].style.height = this.grid.view.getInnerHeight() + "px";
      return
    }
    var colHeader = this.__closest_h__(e.target);
    if(colHeader.length === 0) {
      return
    }
    this.grid.event.trigger("mousedownHeader", [e, colHeader]);
    var colDef = this.__getDef_y__(colHeader);
    this.grid.event.trigger("mousedownHeader_" + colDef.key, [e, colHeader, colDef])
  };
  prototype.__dragmove_H__ = function(e) {
    if(Util.isNull(this.__resizeKey_n__)) {
      return
    }
    var dx = this.__getDx_s__(e, this.grid.colDefMgr.getByKey(this.__resizeKey_n__));
    if(Math.abs(dx) < 1) {
      return
    }
    this.get(this.__resizeKey_n__)[0].style.width = this.__resizeInitWidth_q__ + dx + "px";
    this.__moveResizeHandles_B__(this.__resizeHandleInitX_p__ + dx - this.__resizeMap_r__[this.__resizeKey_n__][0].offsetLeft, this.grid.colDefMgr.getIdxByKey(this.__resizeKey_n__));
    this.__resizeGuide_w__[0].style.left = Math.floor(this.__resizeHandleInitX_p__ + dx + (this._options.__resizeHandleWidth_A__ - this._options.__resizeGuideWidth_G__) / 2 - this._options.__scrollerLeft_D__) + "px";
    if(this._options.__syncResize_I__) {
      this.grid.view.setWidthByKey(this.__resizeKey_n__, this.__resizeInitColWidth_v__ + dx)
    }
  };
  prototype._mouseup = function(e) {
    if(Util.isNull(this.__resizeKey_n__)) {
      return
    }
    this.__resizeGuide_w__[0].style.height = "0px";
    var dx = this.__getDx_s__(e, this.grid.colDefMgr.getByKey(this.__resizeKey_n__));
    if(Math.abs(dx) >= 1) {
      this.grid.view.setWidthByKey(this.__resizeKey_n__, this.__resizeInitColWidth_v__ + dx)
    }
    delete this.__resizeKey_n__;
    delete this.__resizeInitX_o__;
    delete this.__resizeHandleInitX_p__;
    delete this.__resizeInitWidth_q__;
    delete this.__resizeInitColWidth_v__
  };
  prototype.__setWidthByKey_z__ = function(key, w, o) {
    this.get(key)[0].style.width = w + this.grid.view.__colWidthPlus_f__() - this.__widthPlus_f__() + "px";
    this.__syncResizeHandles_A__(this.grid.colDefMgr.getIdxByKey(key))
  };
  prototype.__syncResizeHandles_A__ = function(i) {
    if(Util.isNull(i)) {
      i = 0
    }
    var lefts = this.grid.view.__getColLefts_Bh__(), colDefs = this.grid.colDefMgr.get(), len = colDefs.length, rmap = this.__resizeMap_r__, key;
    for(;i < len;i++) {
      key = colDefs[i].key;
      if(rmap.hasOwnProperty(key)) {
        rmap[key][0].style.left = lefts[i + 1] + this.__resizeHandleOffset_D__ + "px"
      }
    }
  };
  prototype.__moveResizeHandles_B__ = function(dx, i) {
    if(Util.isNull(i)) {
      i = 0
    }
    var colDefs = this.grid.colDefMgr.get(), len = colDefs.length, rmap = this.__resizeMap_r__, key, node;
    for(;i < len;i++) {
      key = colDefs[i].key;
      if(rmap.hasOwnProperty(key)) {
        node = rmap[key][0];
        node.style.left = node.offsetLeft + dx + "px"
      }
    }
  };
  prototype.__onScrollViewportV_C__ = function() {
    this.__resizeGuide_w__[0].style.top = this.grid.view.getScrollTop() + "px"
  };
  prototype.__destroyResizeHandles_t__ = function() {
    var rmap = this.__resizeMap_r__, key;
    for(key in rmap) {
      if(rmap.hasOwnProperty(key)) {
        rmap[key].remove();
        delete rmap[key]
      }
    }
    delete this.__resizeKey_n__;
    delete this.__resizeInitX_o__;
    delete this.__resizeHandleInitX_p__;
    delete this.__resizeInitWidth_q__;
    delete this.__resizeInitColWidth_v__
  };
  prototype.__initResizeHandles_u__ = function() {
    var colDefs = this.grid.colDefMgr.get(), len = colDefs.length, lefts = this.grid.view.__getColLefts_Bh__(), opt = this._options, rmap = this.__resizeMap_r__, colDef, key, i = 0, offset = this.__resizeHandleOffset_D__ = Math.floor(opt.__scrollerLeft_D__ - opt.__resizeHandleWidth_A__ / 2), vmid = this.grid.view.mid, handle = opt.__classResizeHandle_z__, head = this.__head_c__;
    for(;i < len;i++) {
      colDef = colDefs[i];
      if(colDef.resizable) {
        key = colDef.key;
        rmap[key] = $("<div class='" + handle + "' key='" + key + "' ondblclick='JGM.m.ViewportManager." + vmid + '.__autoColWidth_Bg__("' + key + "\")' style='left:" + (offset + lefts[i + 1]) + "px' title='" + colDef.name + "   .'>").appendTo(head)
      }
    }
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.require("jx.data.DataManager");
goog.provide("jx.grid.CheckManager");
(function() {
  goog.exportSymbol("jx.grid.CheckManager", CheckManager);
  JGM._add("CheckManager", CheckManager);
  function CheckManager(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    var options = {__colDef_a__:{key:"checkbox", width:20, name:" ", noTitle:true, resizable:false, sorter:null, filter:null, noSearch:true, editor:null, inputOnCreate:false}, __colIdx_b__:0, __name_c__:undefined, __classCheck_d__:"checkmg", __classMasterCheck_e__:"checkm", __master_f__:true, __isRadio_g__:false};
    this._options = JGM.__extend_e__(options, args.options, {colDef:"__colDef_a__", colIdx:"__colIdx_b__", name:"__name_c__", classCheck:"__classCheck_d__", classMasterCheck:"__classMasterCheck_e__", master:"__master_f__", isRadio:"__isRadio_g__"});
    if(this._options.__isRadio_g__) {
      if(Util.isNull(this._options.__name_c__)) {
        this._options.__name_c__ = "radio" + this.mid
      }
      this._options.__master_f__ = false
    }
    this.__map_a__ = {};
    this.disabledmap = {};
    this.__count_b__ = 0;
    this.__disabled_d__ = false;
    this.__master_c__;
    this.__init()
  }
  CheckManager.getInstance = function(args) {
    return new CheckManager(args)
  };
  var prototype = CheckManager.prototype;
  prototype.__init = function() {
    var opt = this._options, size, con = JGM.__CONST_g__;
    if(this.grid.colDefMgr.getByKey(opt.__colDef_a__.key) === undefined) {
      this.grid.colDefMgr.addAt(opt.__colIdx_b__, opt.__colDef_a__)
    }
    if(Util.isNull(con.__checkboxWidth_c__)) {
      size = Util.calCheckSize();
      con.__checkboxWidth_c__ = size.checkboxW;
      con.__checkboxHeight_d__ = size.checkboxH;
      con.__radioWidth_e__ = size.radioW;
      con.__radioHeight_f__ = size.radioH
    }
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    var opt = this._options, key = opt.__colDef_a__.key, events;
    events = {onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__, onAfterSetDatalist:this.uncheckAll, onIdChange:this.__onIdChange_ai__, onIdListChange:this.__onIdListChange_aj__, onRemoveDatarow:this.__onRemoveDatarow_af__, onRemoveDatalist:this.__onRemoveDatalist_ag__};
    events["onRenderCell_" + key + "_prepend"] = this.__onRenderCell_aH__;
    events["keydownColSel_" + key + "_" + Util.keyMapKeydown.space] = this.__keydownColSel_bA__;
    if(opt.__master_f__) {
      events["onRenderHeader_" + key + "_prepend"] = this.__onRenderHeader_aG__;
      events.onRenderHeadersComplete = this.__getMaster_h__
    }
    this.grid.event.bind(events, this)
  };
  prototype.__destroy_aA__ = function() {
    JGM._destroy(this, {name:"CheckManager", path:"checkMgr", "$":"__master_c__", property:"__count_b__ __disabled_d__", map:"__map_a__ _options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var w, h, checkCommon, css;
    if(this._options.__isRadio_g__) {
      w = JGM.__CONST_g__.__radioWidth_e__;
      h = JGM.__CONST_g__.__radioHeight_f__
    }else {
      w = JGM.__CONST_g__.__checkboxWidth_c__;
      h = JGM.__CONST_g__.__checkboxHeight_d__
    }
    checkCommon = "*overflow:hidden;padding:0;width:" + w + "px;height:" + h + "px;";
    css = this.grid.view.__getCellSelector_AG__() + " ." + this._options.__classCheck_d__ + "[mid='" + this.mid + "']{" + checkCommon + "margin:" + (this.grid.view.__getRowInnerHeight_AO__() - h) / 2 + "px 0 0 " + (this._options.__colDef_a__.width - this.grid.view.__getPadding_AM__() - w) / 2 + "px}" + "#" + this.mid + "h{" + checkCommon + "margin:" + (this.grid.header._options.__height_l__ - h) / 2 + "px 0 0 0}";
    return css
  };
  prototype.checkList = function(list, nomap) {
    if(!nomap) {
      list = this.grid.dataMgr.mapList(list).mapped
    }
    var i = 0, len = list.length;
    for(;i < len;i++) {
      this.check(list[i], true)
    }
  };
  prototype.setCheckList = function(list, nomap) {
    this.uncheckAll();
    this.checkList(list, nomap)
  };
  prototype.getCheckList = function() {
    return Util.toArray(this.__map_a__)
  };
  prototype.getDisableds = function() {
    return Util.toArray(this.disabledmap)
  };
  prototype.toggleCheckAll = function() {
    if(this.isCheckedAll()) {
      this.uncheckAll()
    }else {
      this.checkAll()
    }
  };
  prototype.checkAll = function() {
    if(this._options.__master_f__) {
      CheckManager.__check_a__(this.__master_c__)
    }
    CheckManager.__check_a__(this.getCheckboxes());
    var list = this.grid.dataMgr.all, len = list.length, idKey = this.grid.dataMgr.idKey, map = this.__map_a__, i = 0;
    for(;i < len;i++) {
      map[list[i][idKey]] = list[i]
    }
    this.__count_b__ = len
  };
  prototype.uncheckAll = function() {
    if(this._options.__master_f__) {
      CheckManager.__uncheck_b__(this.__master_c__)
    }
    CheckManager.__uncheck_b__(this.getCheckboxes());
    this.__map_a__ = {};
    this.__count_b__ = 0
  };
  prototype.toggleCheck = function(datarow, nomap) {
    if(!nomap) {
      datarow = this.grid.dataMgr.map(datarow)
    }
    if(this.isChecked(datarow, true) && !this._options.__isRadio_g__) {
      this.uncheck(datarow, true)
    }else {
      this.check(datarow, true)
    }
  };
  prototype.toggleDisable = function(datarow, nomap) {
    if(!nomap) {
      datarow = this.grid.dataMgr.map(datarow)
    }
    if(this.isDisabled(datarow, true)) {
      this.enable(datarow, true)
    }else {
      this.disable(datarow, true)
    }
  };
  prototype.toggleById = function(id) {
    this.toggleCheck(this.grid.dataMgr.getById(id), true)
  };
  prototype.check = function(datarow, nomap) {
    if(!nomap) {
      datarow = this.grid.dataMgr.map(datarow)
    }
    if(!this.__add_f__(datarow)) {
      return
    }
    CheckManager.__check_a__(this.getCheckbox(datarow));
    this.__updateMaster_e__();
    this.grid.event.trigger("onCheckChange", [datarow, true])
  };
  prototype.uncheck = function(datarow, nomap) {
    if(!nomap) {
      datarow = this.grid.dataMgr.map(datarow)
    }
    if(!this.__remove_g__(datarow)) {
      return
    }
    CheckManager.__uncheck_b__(this.getCheckbox(datarow));
    if(this._options.__master_f__) {
      CheckManager.__uncheck_b__(this.__master_c__)
    }
    this.grid.event.trigger("onCheckChange", [datarow, false])
  };
  prototype.disable = function(datarow, nomap) {
    var datam = this.grid.dataMgr;
    if(!nomap) {
      datarow = datam.map(datarow)
    }
    var id = datam.getId(datarow), map = this.disabledmap;
    if(map.hasOwnProperty(id)) {
      return
    }
    map[id] = datarow;
    CheckManager.disableNode(this.getCheckbox(datarow));
    this.grid.event.trigger("onDisableCheck", [datarow])
  };
  prototype.enable = function(datarow, nomap) {
    var datam = this.grid.dataMgr;
    if(!nomap) {
      datarow = this.grid.dataMgr.map(datarow)
    }
    var id = datam.getId(datarow), map = this.disabledmap;
    if(!map.hasOwnProperty(id)) {
      return
    }
    delete map[id];
    CheckManager.enableNode(this.getCheckbox(datarow));
    this.grid.event.trigger("onEnableCheck", [datarow])
  };
  prototype.__updateMaster_e__ = function() {
    if(this._options.__master_f__) {
      CheckManager.__setCheck_c__(this.__master_c__, this.isCheckedAll())
    }
  };
  prototype.__add_f__ = function(datarow) {
    var id = datarow[this.grid.dataMgr.idKey];
    if(this.__map_a__.hasOwnProperty(id)) {
      return false
    }
    if(this._options.__isRadio_g__ === true) {
      this.__map_a__ = {};
      this.__count_b__ = 0
    }
    this.__map_a__[id] = datarow;
    this.__count_b__++;
    return true
  };
  prototype.__remove_g__ = function(datarow) {
    var id = datarow[this.grid.dataMgr.idKey], map = this.__map_a__;
    if(!map.hasOwnProperty(id)) {
      return false
    }
    delete map[id];
    this.__count_b__--;
    return true
  };
  prototype.isChecked = function(datarow, nomap) {
    var datam = this.grid.dataMgr;
    if(!nomap) {
      datarow = datam.map(datarow)
    }
    return this.__map_a__.hasOwnProperty(datam.getId(datarow))
  };
  prototype.isDisabled = function(datarow, nomap) {
    var datam = this.grid.dataMgr;
    if(!nomap) {
      datarow = datam.map(datarow)
    }
    return this.disabledmap.hasOwnProperty(datam.getId(datarow))
  };
  prototype.splitChecked = function(datalist, nomap) {
    if(!nomap) {
      datalist = this.grid.dataMgr.mapList(datalist).mapped
    }
    var checked = [], unchecked = [], i = 0, len = datalist.length, idKey = this.grid.dataMgr.idKey, data, map = this.__map_a__;
    for(;i < len;i++) {
      if(map.hasOwnProperty((data = datalist[i])[idKey])) {
        checked.push(data)
      }else {
        unchecked.push(data)
      }
    }
    return{checked:checked, unchecked:unchecked}
  };
  prototype.isCheckedAll = function() {
    return this.__count_b__ !== 0 && this.__count_b__ === this.grid.dataMgr.all.length ? true : false
  };
  prototype.removeChecked = function() {
    return this.grid.dataMgr.removeList(this.getCheckList())
  };
  prototype.__getMaster_h__ = function() {
    this.__master_c__ = $(document.getElementById(this.mid + "h"))
  };
  prototype.__getChecks_i__ = function(rows) {
    var len = rows.length, checks = [], i = 0, col = this.grid.colDefMgr.getIdxByKey(this._options.__colDef_a__.key);
    for(;i < len;i++) {
      checks.push(rows[i].childNodes[col].childNodes[0])
    }
    return checks
  };
  prototype.getCheckboxes = function() {
    return this.__getChecks_i__(this.grid.view.getRenderedRows())
  };
  prototype.getCheckboxById = function(id) {
    var row = this.grid.view.getRowById(id);
    if(Util.isNotNull(row)) {
      return row.childNodes[this.grid.colDefMgr.getIdxByKey(this._options.__colDef_a__.key)].childNodes[0]
    }
  };
  prototype.getCheckbox = function(datarow) {
    return this.getCheckboxById(this.grid.dataMgr.getId(datarow))
  };
  prototype.getCheckboxByIdx = function(i) {
    return this.getCheckboxById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.__onRemoveDatarow_af__ = function(datarow) {
    this.uncheck(datarow, true);
    this.enable(datarow, true)
  };
  prototype.__onRemoveDatalist_ag__ = function(datalist) {
    var i = 0, len = datalist.length;
    for(;i < len;i++) {
      this.uncheck(datalist[i], true);
      this.enable(datalist[i], true)
    }
  };
  prototype.__onIdChange_ai__ = function(datarow, before, after) {
    var map = this.__map_a__, dmap = this.disabledmap;
    if(map.hasOwnProperty(before)) {
      delete map[before];
      map[after] = datarow
    }
    if(dmap.hasOwnProperty(before)) {
      delete dmap[before];
      dmap[after] = datarow
    }
  };
  prototype.__onIdListChange_aj__ = function(datalist, idBefores, idKey) {
    var i = 0, len = datalist.length, map = this.__map_a__, dmap = this.disabledmap, data, before;
    for(;i < len;i++) {
      data = datalist[i];
      before = idBefores[i];
      if(map.hasOwnProperty(before)) {
        delete map[before];
        map[data[idKey]] = data
      }
      if(dmap.hasOwnProperty(before)) {
        delete dmap[before];
        dmap[data[idKey]] = data
      }
    }
  };
  prototype.__keydownColSel_bA__ = function(e, colSelections, lastSelection) {
    e.preventDefault();
    if(Util.isNotNullAnd(colSelections, lastSelection)) {
      var checked = this.isChecked(lastSelection.getDatarow(), true), row, list = this.grid.dataMgr.datalist;
      if(this._options.__isRadio_g__) {
        for(row in colSelections) {
          if(colSelections.hasOwnProperty(row)) {
            if(row === "length") {
              continue
            }
            this.check(list[row], true);
            return
          }
        }
      }else {
        for(row in colSelections) {
          if(colSelections.hasOwnProperty(row)) {
            if(row === "length") {
              continue
            }
            if(checked) {
              this.uncheck(list[row], true)
            }else {
              this.check(list[row], true)
            }
          }
        }
      }
    }
  };
  prototype.__onRenderHeader_aG__ = function(headerHtml) {
    headerHtml.push("<input id='" + this.mid + "h' type='checkbox' tabIndex='-1' onclick='JGM.m.CheckManager." + this.mid + ".toggleCheckAll();' class='" + this._options.__classCheck_d__ + " " + this._options.__classMasterCheck_e__ + "' mid='" + this.mid + "'");
    if(this.isCheckedAll()) {
      headerHtml.push(" checked='checked'")
    }
    if(this.__disabled_d__) {
      headerHtml.push(" disabled='disabled'")
    }
    headerHtml.push("/>")
  };
  prototype.__onRenderCell_aH__ = function(rowIdx, colIdx, datarow, colDef, cellHtml) {
    cellHtml.push("<input tabIndex='-1' onclick=\"JGM.m.CheckManager." + this.mid + ".toggleById('" + datarow[this.grid.dataMgr.idKey] + "')\" type='" + (this._options.__isRadio_g__ ? "radio" : "checkbox") + "' class='" + this._options.__classCheck_d__ + "' mid='" + this.mid + "'");
    if(Util.isNotNull(this._options.__name_c__)) {
      cellHtml.push(" name='" + this._options.__name_c__ + "'")
    }
    if(this.isChecked(datarow, true)) {
      cellHtml.push(" checked='checked'")
    }
    if(this.__disabled_d__ || this.isDisabled(datarow, true)) {
      cellHtml.push(" disabled='disabled'")
    }
    cellHtml.push("/>")
  };
  prototype.disableAll = function() {
    if(this.__disabled_d__) {
      return
    }
    this.__disabled_d__ = true;
    if(this._options.__master_f__) {
      this.__master_c__.attr("disabled", "disabled")
    }
    $(this.getCheckboxes()).attr("disabled", "disabled")
  };
  prototype.enableAll = function() {
    if(!this.__disabled_d__) {
      return
    }
    this.__disabled_d__ = false;
    if(this._options.__master_f__) {
      this.__master_c__.removeAttr("disabled")
    }
    $(this.getCheckboxes()).removeAttr("disabled")
  };
  CheckManager.__check_a__ = function(obj) {
    if(Util.isNotNull(obj)) {
      Util$.safe$(obj).attr("checked", "checked")
    }
  };
  CheckManager.__uncheck_b__ = function(obj) {
    if(Util.isNotNull(obj)) {
      Util$.safe$(obj).removeAttr("checked")
    }
  };
  CheckManager.disableNode = function(obj) {
    if(Util.isNotNull(obj)) {
      Util$.safe$(obj).attr("disabled", "disabled")
    }
  };
  CheckManager.enableNode = function(obj) {
    if(Util.isNotNull(obj)) {
      Util$.safe$(obj).removeAttr("disabled")
    }
  };
  CheckManager.__setCheck_c__ = function(obj, check) {
    if(check) {
      CheckManager.__check_a__(obj)
    }else {
      CheckManager.__uncheck_b__(obj)
    }
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.require("jx.grid.CheckManager");
goog.require("jx.data.DataManager");
goog.require("jx.data.Tree");
goog.require("jx.data.TreeNode");
goog.provide("jx.grid.Collapser");
(function() {
  goog.exportSymbol("JGM.module.Collapser", Collapser);
  JGM._add("Collapser", Collapser);
  function Collapser(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.collapser = this;
    var options = {__key_e__:undefined, __colDef_a__:{key:"collapser", width:120, name:" ", noSearch:true}, __colIdx_b__:0, __urlCollapsed_c__:this.grid._options.imageUrl + "collapsed.png", __urlCollapsedHover_d__:this.grid._options.imageUrl + "collapsed-hover.png", __urlExpanded_f__:this.grid._options.imageUrl + "expanded.png", __urlExpandedHover_g__:this.grid._options.imageUrl + "expanded-hover.png", __width_h__:6, __padding_i__:5, __classCollapser_j__:"jgrid-collapser", __classCollapsed_k__:"collapsed", 
    __classExpanded_l__:"expanded", __classIndent_m__:"indent", __classMasterCollapser_n__:"master", __indentSize_o__:12, __beginCollapsed_p__:false, CheckManager:undefined, Tree:undefined};
    this._options = JGM.__extend_e__(options, args.options, {colDef:"__colDef_a__", colIdx:"__colIdx_b__", urlCollapsed:"__urlCollapsed_c__", urlCollapsedHover:"__urlCollapsedHover_d__", key:"__key_e__", urlExpanded:"__urlExpanded_f__", urlExpandedHover:"__urlExpandedHover_g__", width:"__width_h__", padding:"__padding_i__", classCollapser:"__classCollapser_j__", classCollapsed:"__classCollapsed_k__", classExpanded:"__classExpanded_l__", classIndent:"__classIndent_m__", classMasterCollapser:"__classMasterCollapser_n__", 
    indentSize:"__indentSize_o__", beginCollapsed:"__beginCollapsed_p__"});
    if(this._options.CheckManager) {
      this.checkMgr = JGM.create("CheckManager", {grid:this.grid, options:this._options.CheckManager});
      delete this._options.CheckManager;
      if(Util.isNull(this._options.__key_e__)) {
        this._options.__colIdx_b__++
      }
    }
    this.__tree_a__ = JGM.create("Tree", {list:this.grid.dataMgr.all, options:this._options.Tree});
    this.__master_c__;
    this.key
  }
  Collapser.getInstance = function(args) {
    return new Collapser(args)
  };
  var prototype = Collapser.prototype;
  prototype.__init = function() {
    if(Util.isNull(this._options.__key_e__)) {
      this.grid.colDefMgr.addAt(this._options.__colIdx_b__, this._options.__colDef_a__)
    }
    this.__makeTree_d__();
    this.__filterRefresh_g__();
    this.key = Util.isNull(this._options.__key_e__) ? this._options.__colDef_a__.key : this._options.__key_e__;
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    var key = this.key, events;
    events = {onAfterFilter:this.__onAfterFilter_as__, onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__, onAfterSetDatalist:this.__onAfterSetDatalist_ab__, onAddDatarow:this.__onAddDatarow_ac__, onAddDatalist:this.__onAddDatalist_ad__, onUpdateDatarow:this.__onUpdateDatarow_ae__, onUpdateDatalist:this.__onUpdateDatalist_ah__, onRemoveDatarow:this.__onRemoveDatarow_A__, onRemoveDatalist:this.__onRemoveDatalist_ag__, onRenderHeadersComplete:this.__getMaster_h__};
    events["onRenderHeader_" + key + "_prepend"] = this.__onRenderHeader_aG__;
    events["clickHeaderValid_" + key] = this.__clickHeaderValid_bO__;
    events["onRenderCell_" + key + "_prepend"] = this.__onRenderCell_aH__;
    events["dblclickCanvas_" + key] = this.__dblclickCanvas_bi__;
    events["keydownColSel_" + key + "_" + Util.keyMapKeydown.space] = this.__keydownColSel_bA__;
    if(Util.isNotNull(this.checkMgr)) {
      events.onCheckChange = this.__onCheckChange_f__
    }
    this.grid.event.bind(events, this)
  };
  prototype.__destroy_aA__ = function() {
    JGM._destroy(this, {name:"Collapser", path:"collapser", module:"__tree_a__", "$":"__master_c__", property:"checkMgr", map:"_options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, rowSel = gridId + this.grid.view._options.__classRow_l__ + " .", toggleSel = gridId + o.__classCollapser_j__, expandedSel = toggleSel + "." + o.__classExpanded_l__, collapsedSel = toggleSel + "." + o.__classCollapsed_k__, rowH = this.grid.view.__getRowInnerHeight_AO__(), rules = [], header = this.grid.header;
    rules.push(gridId + o.__classIndent_m__ + "{height:" + rowH + "px;float:left;}");
    rules.push(toggleSel + "{width:" + o.__width_h__ + "px;float:left;padding:0 " + o.__padding_i__ + "px}");
    rules.push(rowSel + o.__classCollapser_j__ + "{height:" + rowH + "px}");
    rules.push(expandedSel + "{background:url(" + o.__urlExpanded_f__ + ") no-repeat center transparent}");
    rules.push(expandedSel + ":hover{background:url(" + o.__urlExpandedHover_g__ + ") no-repeat center transparent}");
    rules.push(collapsedSel + "{background:url(" + o.__urlCollapsed_c__ + ") no-repeat center transparent}");
    rules.push(collapsedSel + ":hover{background:url(" + o.__urlCollapsedHover_d__ + ") no-repeat center transparent}");
    if(Util.isNotNull(header)) {
      rules.push(gridId + header._options.__classColHeader_r__ + " ." + o.__classCollapser_j__ + "{height:" + header._options.__height_l__ + "px}")
    }
    return rules.join("")
  };
  prototype.__onAfterSetDatalist_ab__ = function(datalist) {
    this.__tree_a__.destroy();
    this.__tree_a__ = JGM.create("Tree", {list:this.grid.dataMgr.all, options:this._options.Tree});
    this.__makeTree_d__()
  };
  prototype.__onAddDatarow_ac__ = function(datarow) {
    var node = this.__tree_a__.createNode(datarow);
    node._collapsed = this._options.__beginCollapsed_p__;
    if(Util.isNotNull(node.parent) && (node.parent === node.tree.root || node.parent._shown && !node.parent._collapsed)) {
      node._shown = true
    }else {
      node._shown = false
    }
    if(Util.isNotNull(node.parent) && node.parent.children.length === 1) {
      this.grid.view.rerenderCellByIdAndKey(this.grid.dataMgr.getId(node.parent.data), this.key)
    }
    if(node._collapsed === true || node._shown === false) {
      node.traverseChildren({fn:function(args) {
        this._shown = false
      }})
    }else {
      node.traverseChildren({fn:function(args) {
        if(Util.isNotNull(this.parent) && (this.parent === this.tree.root || this.parent._shown && !this.parent._collapsed)) {
          this._shown = true
        }else {
          args.propagate = false;
          this.traverse({fn:function(args) {
            this._shown = false
          }})
        }
      }})
    }
    this.grid.event.trigger("onCollapserTreeChange")
  };
  prototype.__onAddDatalist_ad__ = function(datalist) {
    var i = 0, len = datalist.length, tree = this.__tree_a__, root = tree.root, collapsed = this._options.__beginCollapsed_p__, key = this.key, view = this.grid.view, datam = this.grid.dataMgr, node, toRerender = [], par;
    for(;i < len;i++) {
      node = tree.createNode(datalist[i]);
      node._collapsed = collapsed;
      if(Util.isNotNull(node.parent) && node.parent.children.length === 1) {
        toRerender.push(node.parent.data)
      }
    }
    if(view !== undefined) {
      i = 0;
      len = toRerender.length;
      for(;i < len;i++) {
        view.rerenderCellByIdAndKey(datam.getId(toRerender[i]), key)
      }
    }
    root.traverseChildren({fn:function(args) {
      par = this.parent;
      if(Util.isNotNull(par) && (par === root || par._shown && !par._collapsed)) {
        this._shown = true
      }else {
        args.propagate = false;
        this.traverse({fn:function(args) {
          this._shown = false
        }})
      }
    }});
    this.grid.event.trigger("onCollapserTreeChange")
  };
  prototype.__onUpdateDatarow_ae__ = function(datarow, change, before) {
    var tree = this.__tree_a__, nodeKey = tree._options.nodeKey, parentKey = tree._options.parentKey, node;
    if(change.hasOwnProperty(nodeKey)) {
      node = tree.getNodeByNodeId(before[nodeKey]);
      tree.changeNodeId(node, before[nodeKey], change[nodeKey]);
      this.grid.event.trigger("onCollapserTreeChange")
    }
    if(change.hasOwnProperty(parentKey)) {
      if(Util.isNull(node)) {
        node = tree.getNode(datarow)
      }
      tree.changeParentId(node, before[parentKey], change[parentKey]);
      this.grid.event.trigger("onCollapserTreeChange")
    }
  };
  prototype.__onUpdateDatalist_ah__ = function(datalist, changes, befores) {
    var tree = this.__tree_a__, nodeKey = tree._options.nodeKey, parentKey = tree._options.parentKey, before, datarow, treeNode, nodeIdChanged = [], parentIdChanged = [], nlen, plen, temp, i = 0, len = datalist.length;
    for(;i < len;i++) {
      before = befores[i];
      datarow = datalist[i];
      treeNode = undefined;
      if(before.hasOwnProperty(nodeKey)) {
        if(Util.isNull(treeNode)) {
          treeNode = tree.getNodeByNodeId(before[nodeKey])
        }
        nodeIdChanged.push({node:treeNode, before:before[nodeKey], newId:datarow[nodeKey]})
      }
      if(before.hasOwnProperty(parentKey)) {
        if(Util.isNull(treeNode)) {
          treeNode = tree.getNode(datarow)
        }
        parentIdChanged.push({node:treeNode, before:before[parentKey], newId:datarow[parentKey]})
      }
    }
    nlen = nodeIdChanged.length;
    plen = parentIdChanged.length;
    if(nlen + plen === 0) {
      return
    }
    if(nlen + plen > 10) {
      tree.reattach()
    }else {
      for(i = 0;i < nlen;i++) {
        temp = nodeIdChanged[i];
        tree.changeNodeId(temp.node, temp.before, temp.newId)
      }
      for(i = 0;i < plen;i++) {
        temp = parentIdChanged[i];
        tree.changeParentId(temp.node, temp.before, temp.newId)
      }
    }
    this.grid.event.trigger("onCollapserTreeChange")
  };
  prototype.__onRemoveDatarow_A__ = function(datarow) {
    this.__tree_a__.destroyNodeByData(datarow);
    this.grid.event.trigger("onCollapserTreeChange")
  };
  prototype.__onRemoveDatalist_ag__ = function(datalist) {
    var i = 0, len = datalist.length, tree = this.__tree_a__;
    for(;i < len;i++) {
      tree.destroyNodeByData(datalist[i])
    }
    this.grid.event.trigger("onCollapserTreeChange")
  };
  prototype.__onAfterFilter_as__ = function(filteredList, failedList) {
    var tree = this.__tree_a__;
    if(failedList.length > 0) {
      var dataMgr = this.grid.dataMgr, len = filteredList.length, indexMap = dataMgr.__idToIdx_b__, idKey = dataMgr.idKey, pdata, i = 0, travfn = function(args) {
        if(Util.isNotNull(this.parent)) {
          pdata = this.parent.data;
          if(Util.isNotNull(pdata) && !dataMgr.has(pdata)) {
            filteredList.push(pdata);
            failedList.remove(pdata);
            indexMap[pdata[idKey]] = -1
          }
        }else {
          args.stop = true
        }
      };
      dataMgr.__reidx_g__();
      tree.reattach();
      for(;i < len;i++) {
        tree.getNode(filteredList[i]).traverse({up:true, fn:travfn})
      }
      tree.reattach(filteredList);
      tree.sortList(filteredList);
      this.grid.event.trigger("onCollapserTreeChange")
    }else {
      tree.reattach(filteredList);
      this.grid.event.trigger("onCollapserTreeChange");
      this.__filter_b__(filteredList, failedList)
    }
  };
  prototype.__filter_b__ = function(filteredList, failedList) {
    filteredList.length = 0;
    this.__tree_a__.root.traverseChildren({fn:function(args) {
      if(this._shown) {
        filteredList.push(this.data)
      }else {
        failedList.push(this.data)
      }
    }})
  };
  prototype.toggleById = function(id) {
    if(Util.isNotNull(id)) {
      return this.toggleCollapse(this.__tree_a__.getNode(this.grid.dataMgr.getById(id)))
    }
  };
  prototype.toggle = function(datarow) {
    return this.toggleById(this.grid.dataMgr.getId(datarow))
  };
  prototype.toggleByIdx = function(i) {
    return this.toggleById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.__clickHeaderValid_bO__ = function(e, colheader) {
    if(Util.hasTagAndClass(e.target, "DIV", this._options.__classCollapser_j__)) {
      return false
    }
  };
  prototype.__dblclickCanvas_bi__ = function(e, cell) {
    if(Util.hasTagAndClass(e.target, "DIV", this._options.__classCollapser_j__)) {
      return
    }
    this.toggleCollapse(this.__tree_a__.getNode(cell.getDatarow()))
  };
  prototype.__keydownColSel_bA__ = function(e, colSelections, lastSelection) {
    e.preventDefault();
    if(Util.isNotNullAnd(colSelections, lastSelection)) {
      var tree = this.__tree_a__, collapsed = tree.getNode(lastSelection.getDatarow())._collapsed, datalist = this.grid.dataMgr.datalist, node, row;
      for(row in colSelections) {
        if(colSelections.hasOwnProperty(row)) {
          if(row === "length") {
            continue
          }
          node = tree.getNode(datalist[row]);
          if(collapsed) {
            this.expand(node)
          }else {
            this.collapse(node)
          }
        }
      }
      this.__filterRefresh_g__()
    }
  };
  prototype.__makeTree_d__ = function() {
    var tree = this.__tree_a__, i, map, root;
    tree.__init();
    map = tree.map;
    root = tree.root;
    if(this._options.__beginCollapsed_p__) {
      for(i in map) {
        if(map.hasOwnProperty(i)) {
          map[i]._collapsed = true;
          map[i]._shown = false
        }
      }
      var first = root.children, len = first.length;
      for(i = 0;i < len;i++) {
        first[i]._shown = true
      }
      root._collapsed = true
    }else {
      for(i in map) {
        if(map.hasOwnProperty(i)) {
          map[i]._collapsed = false;
          map[i]._shown = true
        }
      }
      root._collapsed = false
    }
    this.grid.event.trigger("onCollapserTreeChange")
  };
  prototype.__onRenderHeader_aG__ = function(headerHtml) {
    headerHtml.push("<div id='" + this.mid + "h' onmousedown='JGM.m.Collapser." + this.mid + ".toggleMaster();' class='" + this._options.__classCollapser_j__ + " " + this._options.__classMasterCollapser_n__);
    if(this.__tree_a__.root._collapsed) {
      headerHtml.push(" " + this._options.__classCollapsed_k__)
    }else {
      headerHtml.push(" " + this._options.__classExpanded_l__)
    }
    headerHtml.push("'></div>")
  };
  prototype.__onRenderCell_aH__ = function(rowIdx, colIdx, datarow, colDef, cellHtml) {
    var node = this.__tree_a__.getNode(datarow);
    if(Util.isNull(node)) {
      return null
    }
    var id = this.grid.dataMgr.getId(datarow), opt = this._options;
    cellHtml.push("<div class='" + opt.__classIndent_m__ + "' style='width:" + opt.__indentSize_o__ * node.getLevel() + "px;'></div><div ");
    if(!node.isLeaf()) {
      cellHtml.push('onmousedown="JGM.m.Collapser.' + this.mid + ".toggleById('" + id + "');\" class='" + opt.__classCollapser_j__);
      if(node._collapsed) {
        cellHtml.push(" " + opt.__classCollapsed_k__)
      }else {
        cellHtml.push(" " + opt.__classExpanded_l__)
      }
    }else {
      cellHtml.push("class='" + opt.__classCollapser_j__)
    }
    cellHtml.push("'></div>")
  };
  prototype.getLevel = function(datarow) {
    var node = this.__tree_a__.getNode(datarow);
    if(Util.isNull(node)) {
      return null
    }
    return node.getLevel()
  };
  prototype.collapse = function(node, nocheck) {
    if(node._collapsed === true || node.isLeaf()) {
      return
    }
    node._collapsed = true;
    node.traverseChildren({fn:function(args) {
      this._shown = false;
      if(this._collapsed) {
        args.propagate = false
      }
    }});
    var collapser = this.__getCollapser_i__(node.data);
    if(collapser.length > 0) {
      this.__setClass_e__(collapser, true)
    }
    if(!nocheck && node.parent === this.__tree_a__.root && this.__tree_a__.root._collapsed === false) {
      this.__setClass_e__(this.__master_c__, this.__tree_a__.root._collapsed = true)
    }
  };
  prototype.expand = function(node, nocheck) {
    if(node._collapsed === false || node.isLeaf()) {
      return
    }
    node._collapsed = false;
    node.traverseChildren({fn:function(args) {
      this._shown = true;
      if(this._collapsed) {
        args.propagate = false
      }
    }});
    var collapser = this.__getCollapser_i__(node.data), tree = this.__tree_a__;
    if(collapser.length > 0) {
      this.__setClass_e__(collapser, false)
    }
    if(!nocheck && node.parent === tree.root) {
      var first = tree.root.children, len = first.length, i = 0;
      for(;i < len;i++) {
        if(first[i]._collapsed) {
          return
        }
      }
      this.__setClass_e__(this.__master_c__, tree.root._collapsed = false)
    }
  };
  prototype.__setClass_e__ = function(ob, collapsed) {
    if(Util.isNull(ob)) {
      return
    }
    var opt = this._options;
    if(collapsed) {
      ob.addClass(opt.__classCollapsed_k__).removeClass(opt.__classExpanded_l__)
    }else {
      ob.addClass(opt.__classExpanded_l__).removeClass(opt.__classCollapsed_k__)
    }
  };
  prototype.toggleMaster = function() {
    var root = this.__tree_a__.root, first = root.children, len = first.length, i = 0;
    if(root._collapsed) {
      for(;i < len;i++) {
        this.expand(first[i], true)
      }
      this.__setClass_e__(this.__master_c__, root._collapsed = false)
    }else {
      for(;i < len;i++) {
        this.collapse(first[i], true)
      }
      this.__setClass_e__(this.__master_c__, root._collapsed = true)
    }
    this.__filterRefresh_g__()
  };
  prototype.toggleCollapse = function(node) {
    var res;
    if(node._collapsed) {
      res = this.expand(node)
    }else {
      res = this.collapse(node)
    }
    this.__filterRefresh_g__();
    return res
  };
  prototype.__onCheckChange_f__ = function(datarow, check) {
    var node = this.__tree_a__.getNode(datarow), checkMgr = this.checkMgr, inputs = [], input;
    if(check) {
      node.traverseChildren({fn:function(args) {
        if(checkMgr.isChecked(this.data)) {
          args.propagate = false
        }else {
          checkMgr.__add_f__(this.data);
          if(Util.isNotNull(input = checkMgr.getCheckbox(this.data))) {
            inputs.push(input)
          }
        }
      }});
      node.traverseParent({up:true, fn:function(args) {
        if(Util.isNull(this.data) || checkMgr.isChecked(this.data)) {
          args.stop = true
        }else {
          checkMgr.__add_f__(this.data);
          if(Util.isNotNull(input = checkMgr.getCheckbox(this.data))) {
            inputs.push(input)
          }
        }
      }});
      JGM.CheckManager.__check_a__($(inputs));
      checkMgr.__updateMaster_e__()
    }else {
      node.traverseChildren({fn:function(args) {
        if(!checkMgr.isChecked(this.data)) {
          args.propagate = false
        }else {
          checkMgr.__remove_g__(this.data);
          if(Util.isNotNull(input = checkMgr.getCheckbox(this.data))) {
            inputs.push(input)
          }
        }
      }});
      node.traverseParent({up:true, fn:function(args) {
        if(Util.isNull(this.data) || !checkMgr.isChecked(this.data)) {
          args.stop = true
        }else {
          var i = 0, children = this.children, clen = children.length;
          for(;i < clen;i++) {
            if(checkMgr.isChecked(children[i].data)) {
              args.stop = true;
              return
            }
          }
          checkMgr.__remove_g__(this.data);
          if(Util.isNotNull(input = checkMgr.getCheckbox(this.data))) {
            inputs.push(input)
          }
        }
      }});
      JGM.CheckManager.__uncheck_b__($(inputs))
    }
  };
  prototype.__filterRefresh_g__ = function() {
    this.__filter_b__(this.grid.dataMgr.datalist, this.grid.dataMgr.failed);
    this.grid.dataMgr.__finish_k__()
  };
  prototype.__getCollapser_i__ = function(datarow) {
    if(Util.isNull(datarow)) {
      return $([])
    }
    var found = Util.findFirstByTagAndClass(this.grid.view.getCell(this.grid.dataMgr.getIdx(datarow), this.grid.colDefMgr.getIdxByKey(this.key)), "DIV", this._options.__classCollapser_j__);
    if(found === undefined) {
      return $([])
    }else {
      return $(found)
    }
  };
  prototype.__getMaster_h__ = function() {
    this.__master_c__ = $(document.getElementById(this.mid + "h"))
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.ColumnManager");
goog.require("jx.grid.CheckManager");
goog.require("jx.grid.Collapser");
goog.require("jx.data.DataManager");
goog.require("jx.data.Tree");
goog.require("jx.data.TreeNode");
goog.provide("jx.grid.ColumnGroup");
(function() {
  goog.exportSymbol("jx.grid.ColumnGroup", ColGroup);
  JGM._add("ColGroup", ColGroup);
  function ColGroup(args) {
    this.mid = args.mid;
    this.grid = args.grid;
    this.grid.colGroup = this;
    var options = {__key_a__:undefined, __padColKeys_b__:[], __sumColKeys_c__:[], prefix:": ", Collapser:{indentSize:0}};
    this._options = JGM.__extend_e__(options, args.options, {key:"__key_a__", padColKeys:"__padColKeys_b__", sumColKeys:"__sumColKeys_c__"});
    this._options.Collapser.key = this._options.__key_a__;
    this.collapser;
    this.__parentMap_a__ = {};
    this.__init()
  }
  ColGroup.getInstance = function(args) {
    return new ColGroup(args)
  };
  var prototype = ColGroup.prototype;
  prototype.__init = function() {
    var grid = this.grid, datam = grid.dataMgr, collapser, opt = this._options;
    this.bindEvents();
    collapser = this.collapser = JGM.create("Collapser", {grid:grid, options:opt.Collapser});
    delete opt.Collapser;
    this.__processData_b__(datam.all);
    collapser.__init();
    datam.refresh()
  };
  prototype.bindEvents = function() {
    var events;
    events = {onBeforeSetDatalist:this.__removeAll_f__, "onAfterSetDatalist onAddDatalist":this.__processData_b__, onAddDatarow:this.__onAddDatarow_ac__, onUpdateDatarow:this.__onUpdateDatarow_ae__, onUpdateDatalist:this.__onUpdateDatalist_ah__, onRemoveDatarow:this.__onRemoveDatarow_af__, onRemoveDatalist:this.__onRemoveDatalist_ag__, onDestroy:this.__destroy_aA__};
    if(this._options.__sumColKeys_c__.length !== 0) {
      var mid = this.mid, notReal = this.grid.dataMgr.__consts_n__.__notReal_d__, i = 0, sumfn, sumkeys = this._options.__sumColKeys_c__, prefix = this._options.prefix, len = sumkeys.length;
      sumfn = function(rowIdx, colIdx, datarow, colDef, cellHtml) {
        if(datarow[notReal] === mid) {
          cellHtml.push(prefix)
        }
      };
      for(;i < len;i++) {
        events["onRenderCell_" + sumkeys[i] + "_prepend"] = sumfn
      }
      events.onCollapserTreeChange = this.__onCollapserTreeChange_g__
    }
    this.grid.event.bind(events, this)
  };
  prototype.__destroy_aA__ = function() {
    JGM._destroy(this, {name:"ColGroup", path:"colGroup", property:"collapser", map:"__parentMap_a__ _options"})
  };
  prototype.__processData_b__ = function(datalist) {
    var len = datalist.length, key = this._options.__key_a__, padColKeys = this._options.__padColKeys_b__, datam = this.grid.dataMgr, notReal = datam.__consts_n__.__notReal_d__, idKey = datam.idKey, collapser = this.collapser, nodeKey = collapser.__tree_a__._options.nodeKey, parentKey = collapser.__tree_a__._options.parentKey, newParents = [], i = 0;
    for(;i < len;i++) {
      this.__addData_c__(datalist[i], key, idKey, notReal, nodeKey, parentKey, padColKeys, newParents)
    }
    if(newParents.length !== 0) {
      datam.all.pushList(newParents);
      datam.makeCompositeKeyList(newParents, true);
      datam.addListToIdMap(newParents);
      if(Util.isNotNull(collapser)) {
        collapser.__onAddDatalist_ad__(newParents)
      }
    }
    return newParents
  };
  prototype.__addData_c__ = function(data, key, idKey, notReal, nodeKey, parentKey, padColKeys, newParents) {
    var keyVal = data[key], parent, map = this.__parentMap_a__;
    if(!map.hasOwnProperty(keyVal)) {
      parent = this.__makeParent_d__(data, key, idKey, keyVal, notReal, nodeKey, padColKeys);
      newParents.push(parent);
      map[keyVal] = parent
    }else {
      parent = map[keyVal]
    }
    data[nodeKey] = data[idKey];
    data[parentKey] = this.mid + keyVal
  };
  prototype.__makeParent_d__ = function(data, key, idKey, keyVal, notReal, nodeKey, padColKeys) {
    var parent = {}, j = 0, len = padColKeys.length;
    parent[notReal] = this.mid;
    parent[nodeKey] = this.mid + keyVal;
    parent[key] = keyVal;
    parent[idKey] = (this.grid.colDefMgr.getByKey(key).name || key) + ": " + keyVal;
    for(;j < len;j++) {
      parent[padColKeys[j]] = data[padColKeys[j]]
    }
    return parent
  };
  prototype.__isParent_e__ = function(datarow) {
    return datarow[this.grid.dataMgr.__consts_n__.__notReal_d__] === this.mid
  };
  prototype.__removeAll_f__ = function(datalist) {
    this.__parentMap_a__ = {}
  };
  prototype.__onAddDatarow_ac__ = function(datarow) {
    var newParents = [], opt = this._options, datam = this.grid.dataMgr, collapser = this.collapser, ctopt = collapser.__tree_a__._options;
    this.__addData_c__(datarow, opt.__key_a__, datam.idKey, datam.__consts_n__.__notReal_d__, ctopt.nodeKey, ctopt.parentKey, opt.__padColKeys_b__, newParents);
    if(newParents.length !== 0) {
      var parent = newParents[0];
      datam.all.push(parent);
      datam.makeCompositeKey(parent, true);
      datam.addToIdMap(parent);
      collapser.__onAddDatarow_ac__(parent)
    }
  };
  prototype.__onUpdateDatarow_ae__ = function(datarow, change, before) {
    if(change.hasOwnProperty(this._options.__key_a__)) {
      var key = this._options.__key_a__, newkey = change[key], oldkey = before[key], mid = this.mid, collapser = this.collapser, tree = collapser.__tree_a__, tpkey = tree._options.parentKey, parKey = {}, oldParKey = {}, pmap = this.__parentMap_a__, oldp;
      if(!pmap.hasOwnProperty(newkey)) {
        this.__onAddDatarow_ac__(datarow)
      }
      parKey[tpkey] = mid + newkey;
      oldParKey[tpkey] = mid + oldkey;
      collapser.__onUpdateDatarow_ae__(datarow, parKey, oldParKey);
      oldp = tree.getNode(pmap[oldkey]);
      if(oldp.children.length === 0) {
        this.grid.dataMgr.all.remove(oldp.data);
        delete pmap[oldkey];
        collapser.__onRemoveDatarow_A__(oldp.data)
      }
    }
  };
  prototype.__onUpdateDatalist_ah__ = function(datalist, changes, befores) {
    var key = this._options.__key_a__, mid = this.mid, collapser = this.collapser, tree = collapser.__tree_a__, tpkey = tree._options.parentKey, change, parKey = {}, oldParKey = {}, parKeys = [], oldParKeys = [], list = [], i = 0, len = datalist.length;
    for(;i < len;i++) {
      change = changes[i];
      if(change.hasOwnProperty(key)) {
        parKey = {};
        parKey[tpkey] = mid + change[key];
        parKeys.push(parKey);
        oldParKey = {};
        oldParKey[tpkey] = mid + befores[i][key];
        oldParKeys.push(oldParKey);
        list.push(datalist[i])
      }
    }
    if(list.length !== 0) {
      var oldkey, pmap = this.__parentMap_a__, oldp, removeList = [];
      this.__processData_b__(list);
      collapser.__onUpdateDatalist_ah__(list, parKeys, oldParKeys);
      i = 0;
      len = oldParKeys.length;
      for(;i < len;i++) {
        oldkey = oldParKeys[i][tpkey];
        if(pmap.hasOwnProperty(oldkey)) {
          oldp = tree.getNode(pmap[oldkey]);
          if(oldp.children.length === 0) {
            delete pmap[oldkey];
            removeList.push(oldp.data)
          }
        }
      }
      if(removeList.length !== 0) {
        collapser.__onRemoveDatalist_ag__(removeList);
        this.grid.dataMgr.all.removeList(removeList)
      }
    }
  };
  prototype.__onRemoveDatarow_af__ = function(datarow) {
    if(this.__isParent_e__(datarow)) {
      delete this.__parentMap_a__[datarow[this._options.__key_a__]]
    }else {
      var parentNode = this.collapser.__tree_a__.getNode(datarow).parent;
      if(parentNode.children.length === 1) {
        this.grid.dataMgr.remove(parentNode.data)
      }
    }
  };
  prototype.__onRemoveDatalist_ag__ = function(datalist) {
    var i = 0, len = datalist.length;
    for(;i < len;i++) {
      this.__onRemoveDatarow_af__(datalist[i])
    }
  };
  prototype.__onCollapserTreeChange_g__ = function() {
    var sums = {}, sumKeys = this._options.__sumColKeys_c__, len = sumKeys.length, i = 0, notReal = this.grid.dataMgr.__consts_n__.__notReal_d__, mid = this.mid, data, curKey, tmp;
    for(;i < len;i++) {
      sums[sumKeys[i]] = 0
    }
    this.collapser.__tree_a__.root.traverseChildren({post:true, fn:function(args, index) {
      data = this.data;
      i = 0;
      if(data[notReal] === mid) {
        for(;i < len;i++) {
          curKey = sumKeys[i];
          data[curKey] = sums[curKey];
          sums[curKey] = 0
        }
      }else {
        if(!data.hasOwnProperty(notReal)) {
          for(;i < len;i++) {
            if(typeof(tmp = data[sumKeys[i]]) === "string") {
              tmp = tmp.toFloat()
            }
            sums[sumKeys[i]] += isNaN(tmp) ? 0 : tmp
          }
        }
      }
    }})
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.grid.Cell");
goog.require("jx.grid.ColumnManager");
goog.require("jx.data.DataManager");
goog.provide("jx.grid.ViewportManager");
(function() {
  goog.exportSymbol("jx.grid.ViewportManager", ViewportManager);
  JGM._add("ViewportManager", ViewportManager);
  function ViewportManager(args) {
    this.mid = args.mid;
    this._ctnr = args.container;
    this.__mask_a__;
    this.__canvas_c__;
    this.grid = args.grid;
    this.grid.view = this;
    var options = {__attrRowIdx_a__:"r", __appendThreshold_b__:3, __renderThreshold_c__:10, __bufferSize_d__:6, __rowsPerPage_e__:10, __rowH_f__:21, __borderThickness_g__:1, __border_h__:"solid #D0D7E5", __padding_i__:1, __evenOddRows_j__:false, __oddRowsBackground_k__:"#F4F4F4", __style_q__:"", __canvasStyle_r__:"", __rowStyle_s__:"", __cellStyle_t__:"", __classRow_l__:"jgrid-row", __classCell_m__:"jgrid-cell", __classView_n__:"jgrid-viewport", __classCanvas_o__:"jgrid-canvas", __focusBackground_u__:"#FFF", 
    __focusOutline_v__:"2px solid #f1ca7f", __autoHeight_w__:false, __autoWidth_x__:false};
    this._options = JGM.__extend_e__(options, args.options, {attrRowIdx:"__attrRowIdx_a__", appendThreshold:"__appendThreshold_b__", renderThreshold:"__renderThreshold_c__", bufferSize:"__bufferSize_d__", rowsPerPage:"__rowsPerPage_e__", rowH:"__rowH_f__", borderThickness:"__borderThickness_g__", border:"__border_h__", padding:"__padding_i__", evenOddRows:"__evenOddRows_j__", oddRowsBackground:"__oddRowsBackground_k__", classRow:"__classRow_l__", classCell:"__classCell_m__", classView:"__classView_n__", 
    classCanvas:"__classCanvas_o__", style:"__style_q__", canvasStyle:"__canvasStyle_r__", rowStyle:"__rowStyle_s__", cellStyle:"__cellStyle_t__", focusBackground:"__focusBackground_u__", focusOutline:"__focusOutline_v__", autoHeight:"__autoHeight_w__", autoWidth:"__autoWidth_x__"});
    this._vars = {drag:false, __lastScrollTop_d__:0, __lastScrollLeft_e__:0, __lastRowLen_l__:0};
    this.__renderedRows_A__ = {};
    this.__lockedRows_B__ = {};
    this.__colLefts_Bd__ = [0];
    this.__init()
  }
  ViewportManager.getInstance = function(args) {
    return new ViewportManager(args)
  };
  var prototype = ViewportManager.prototype;
  prototype.__init = function() {
    this.__mask_a__ = $("<div class='" + this._options.__classView_n__ + "' tabIndex='0' onscroll='JGM.m.ViewportManager." + this.mid + ".__scroll_As__()'>").appendTo(this._ctnr);
    this.__canvas_c__ = $("<div class='" + this._options.__classCanvas_o__ + "'>").appendTo(this.__mask_a__);
    this.__mask_a__.bind("selectstart.ui", function(event) {
      return $(event.target).is("input, textarea")
    });
    this.__setColLefts_Be__();
    this._vars.__lastRowLen_l__ = this.grid.dataMgr.datalist.length;
    this.grid.event.bind({canvasFind:this.__canvasFind_AC__, onCreateCss:this.__onCreateCss_V__, onCreateDynamicCss:this.__onCreateDynamicCss_C__, onDestroy:this.__onDestroy_e__, keydown:this._keydown, keyup:this._keyup, keypress:this._keypress, mousein:this._mousein, mouseout:this._mouseout, mouseenter:this._mouseenter, mouseleave:this._mouseleave, mousemove:this._mousemove, mouseover:this._mouseover, mousedown:this._mousedown, mouseup:this._mouseup, click:this._click, dblclick:this._dblclick, resizeWidth:this.__setWidth_AV__, 
    "resizeWidth onResizeCol onResizeCanvasHeight":this.__resizeWidth_AZ__, onAfterRefresh:this.onAfterRefresh, onRenderModules:this.__render_w__, onReorderCols:this.__onReorderCols_Bf__, onResizeCanvasWidth:this.__scroll_As__, onUpdateDatarow:this.onUpdateDatarow, onUpdateDatalist:this.onUpdateDatalist, onRemoveDatarow:this.onRemoveDatarow, onRemoveDatalist:this.onRemoveDatalist, onIdChange:this.onIdChange, onIdListChange:this.onIdListChange, unsetDrag:this.unsetDrag}, this)
  };
  prototype.unsetDrag = function() {
    this._vars.drag = false
  };
  prototype.__onDestroy_e__ = function() {
    JGM._destroy(this, {name:"ViewportManager", path:"view", "$":"__canvas_c__ __mask_a__", property:"_ctnr", map:"_vars __lockedRows_B__ __renderedRows_A__ _options"})
  };
  prototype.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, cellSel = gridId + o.__classCell_m__, rowSel = gridId + o.__classRow_l__, border = o.__borderThickness_g__ + "px " + o.__border_h__, attrRowIdx = rowSel + "[" + o.__attrRowIdx_a__, colDefs = this.grid.colDefMgr.get(), clen = colDefs.length, i = 0, rules = [];
    rules.push(gridId + o.__classView_n__ + "{height:" + this.__calHeight_AP__() + "px;outline:0;position:relative;white-space:nowrap;overflow:auto;line-height:" + o.__rowH_f__ + "px;cursor:default;-moz-user-select:none;-webkit-user-select:none;" + o.__style_q__ + "}");
    rules.push(gridId + o.__classView_n__ + ":focus{background:" + o.__focusBackground_u__ + ";outline:" + o.__focusOutline_v__ + "}");
    rules.push(gridId + o.__classCanvas_o__ + "{height:" + this.__calCanvasHeight_AR__() + "px;" + o.__canvasStyle_r__ + ";background:#fff}");
    rules.push(rowSel + "{position:absolute;" + o.__rowStyle_s__ + "}");
    rules.push(cellSel + "{height:" + o.__rowH_f__ + "px;border-bottom:" + border + ";display:inline-block;white-space:nowrap;overflow:hidden;float:left;text-overflow:ellipsis;padding-left:" + o.__padding_i__ + "px;border-right:" + border + ";" + o.__cellStyle_t__ + "}");
    if(o.__evenOddRows_j__) {
      rules.push(attrRowIdx + "$='1']," + attrRowIdx + "$='3']," + attrRowIdx + "$='5']," + attrRowIdx + "$='7']," + attrRowIdx + "$='9']{background:" + o.__oddRowsBackground_k__ + "}")
    }
    for(;i < clen;i++) {
      rules.push(cellSel + ".k_" + colDefs[i].key + "{" + colDefs[i].style + "}")
    }
    return rules.join("")
  };
  prototype.__onCreateDynamicCss_C__ = function() {
    var cellSel = "#" + this.grid.mid + " ." + this._options.__classCell_m__, str = this.__getRowSelector_AH__() + "{width:" + this.__calCanvasWidth_AT__() + "px}", colDefs = this.grid.colDefMgr.get(), clen = colDefs.length, i = 0;
    for(;i < clen;i++) {
      str += cellSel + ".k_" + colDefs[i].key + "{width:" + colDefs[i].width + "px}"
    }
    return str
  };
  prototype.onUpdateDatarow = function(datarow, change, before) {
    if(this.isRendered(datarow)) {
      this.rerenderRow(datarow)
    }
  };
  prototype.onUpdateDatalist = function(datalist, changes, befores) {
    var datarow, len = datalist.length, i = 0;
    for(;i < len;i++) {
      datarow = datalist[i];
      if(this.isRendered(datarow)) {
        this.rerenderRow(datarow)
      }
    }
  };
  prototype.onRemoveDatarow = function(datarow) {
    this.destroyRow(datarow)
  };
  prototype.onRemoveDatalist = function(datalist) {
    var len = datalist.length, i = 0;
    for(;i < len;i++) {
      this.destroyRow(datalist[i])
    }
  };
  prototype.onIdChange = function(datarow, before, after) {
    var attrChanged = false, node;
    if(this.isRowLockedById(before)) {
      this.__lockedRows_B__[after] = this.__lockedRows_B__[before];
      delete this.__lockedRows_B__[before]
    }
    if(this.isRenderedById(before)) {
      (this.__renderedRows_A__[after] = this.__renderedRows_A__[before]).setAttribute("i", after);
      attrChanged = true;
      delete this.__renderedRows_A__[before]
    }
  };
  prototype.onIdListChange = function(datalist, befores, idKey) {
    var len = datalist.length, i = 0, locked = this.__lockedRows_B__, rendered = this.__renderedRows_A__, before, after, attrChanged, node;
    for(;i < len;i++) {
      before = befores[i];
      after = datalist[i][idKey];
      attrChanged = false;
      if(locked.hasOwnProperty(before)) {
        locked[after] = locked[before];
        delete locked[before]
      }
      if(rendered.hasOwnProperty(before)) {
        (rendered[after] = rendered[before]).setAttribute("i", after);
        attrChanged = true;
        delete rendered[before]
      }
    }
  };
  prototype.__getCellSelector_AG__ = function() {
    return"#" + this.grid.mid + " ." + this._options.__classCell_m__
  };
  prototype.__getRowSelector_AH__ = function() {
    return"#" + this.grid.mid + " ." + this._options.__classRow_l__
  };
  prototype.scrollTo = function(row, col) {
    this.scrollToRow(row);
    this.scrollToCol(col)
  };
  prototype.scrollToRowLazy = function(row) {
    var scrollTop = this.getScrollTop();
    if(Util.isNull(row)) {
      return scrollTop
    }
    if(this.__getLastSafeVisibleRow_n__() < row) {
      return this.scrollToRow(this.__getFirstRowForSafe_o__(row))
    }
    if(this.__getFirstSafeVisibleRow_l__() > row) {
      return this.scrollToRow(row)
    }
    return scrollTop
  };
  prototype.scrollToColLazy = function(col) {
    var scrollLeft = this.getScrollLeft();
    if(Util.isNull(col)) {
      return scrollLeft
    }
    if(this.__getLastSafeVisibleCol_s__() < col) {
      return this.setScrollLeft(this.getScrollHForSafe(col))
    }else {
      if(this.__getFirstSafeVisibleCol_q__() > col) {
        return this.scrollToCol(col)
      }
    }
    return scrollLeft
  };
  prototype.scrollToLazy = function(row, col) {
    this.scrollToRowLazy(row);
    this.scrollToColLazy(col)
  };
  prototype.scrollToRow = function(i) {
    if(Util.isNotNull(i)) {
      return this.setScrollTop(this.__getRowOuterHeight_AN__() * i)
    }
    return this.getScrollTop()
  };
  prototype.scrollToCol = function(i) {
    return this.setScrollLeft(this.getColLeft(i))
  };
  prototype.__getColInnerWidth_AI__ = function(i) {
    return this.grid.colDefMgr.get(i).width
  };
  prototype.__getColInnerWidthByKey_AJ__ = function(i) {
    return this.grid.colDefMgr.getByKey(i).width
  };
  prototype.getColWidth = function(i) {
    return this.grid.colDefMgr.get(i).width + this._options.__padding_i__
  };
  prototype.getColWidthByKey = function(i) {
    return this.grid.colDefMgr.getByKey(i).width + this._options.__padding_i__
  };
  prototype.__getColOuterWidth_AK__ = function(i) {
    return this.grid.colDefMgr.get(i).width + this._options.__padding_i__ + this._options.__borderThickness_g__
  };
  prototype.__getColOuterWidthByKey_AL__ = function(i) {
    return this.grid.colDefMgr.getByKey(i).width + this._options.__padding_i__ + this._options.__borderThickness_g__
  };
  prototype.__getPadding_AM__ = function() {
    return this._options.__padding_i__
  };
  prototype.__colWidthPlus_f__ = function() {
    return this._options.__padding_i__ + this._options.__borderThickness_g__
  };
  prototype.__getRowOuterHeight_AN__ = function() {
    return this._options.__rowH_f__ + this._options.__borderThickness_g__
  };
  prototype.__getRowInnerHeight_AO__ = function() {
    return this._options.__rowH_f__
  };
  prototype.__calHeight_AP__ = function() {
    if(this._options.__autoHeight_w__) {
      return this.__calCanvasHeight_AR__() + (this.grid.width() < this.__calCanvasWidth_AT__() ? this.grid._vars.scrollbarDim.h : 0)
    }
    return this.__getRowOuterHeight_AN__() * this._options.__rowsPerPage_e__
  };
  prototype.getHeight = function() {
    return this.__mask_a__[0].offsetHeight
  };
  prototype.getInnerHeight = function() {
    return this.__mask_a__[0].clientHeight
  };
  prototype.__getWidth_AQ__ = function() {
    return this.__mask_a__[0].offsetWidth
  };
  prototype.getInnerWidth = function() {
    return this.__mask_a__[0].clientWidth
  };
  prototype.__calCanvasHeight_AR__ = function() {
    return this.__getRowOuterHeight_AN__() * this.grid.dataMgr.datalist.length
  };
  prototype.getCanvasHeight = function() {
    return this.__canvas_c__[0].clientHeight
  };
  prototype.__setCanvasHeight_AS__ = function(h) {
    h = parseInt(h);
    if(isNaN(h) || h < 1) {
      return
    }
    var old = this.getCanvasHeight();
    if(h != old) {
      this.__canvas_c__[0].style.height = h + "px";
      this.grid.event.trigger("onResizeCanvasHeight", [h, old])
    }
  };
  prototype.__calCanvasWidth_AT__ = function() {
    return this.__colLefts_Bd__[this.grid.colDefMgr.length()]
  };
  prototype.getCanvasWidth = function() {
    return this.__canvas_c__[0].clientWidth
  };
  prototype.__setCanvasWidth_AU__ = function(w) {
    w = parseInt(w);
    if(isNaN(w) || w < 1) {
      return
    }
    var old = this.getCanvasWidth();
    if(w != old) {
      this.__canvas_c__[0].style.width = w + "px";
      this.grid.event.trigger("onResizeCanvasWidth", [w, old])
    }
  };
  prototype.getColLeft = function(i) {
    return this.__colLefts_Bd__[i]
  };
  prototype.__getColLefts_Bh__ = function() {
    return this.__colLefts_Bd__
  };
  prototype.__setColLefts_Be__ = function(from, to) {
    if(Util.isNull(from)) {
      from = 0
    }
    var colDefs = this.grid.colDefMgr.get(), widthPlus = this.__colWidthPlus_f__();
    if(Util.isNull(to)) {
      to = colDefs.length
    }
    for(;from < to;from++) {
      this.__colLefts_Bd__[from + 1] = this.__colLefts_Bd__[from] + colDefs[from].width + widthPlus
    }
    return this.__colLefts_Bd__
  };
  prototype.__onReorderCols_Bf__ = function() {
    this.__setColLefts_Be__();
    this.__rerender_Ba__()
  };
  prototype.setWidthByKey = function(key, w) {
    var colDef = this.grid.colDefMgr.getByKey(key);
    w = Util.bound(w, colDef.minW, colDef.maxW);
    if(w === colDef.width) {
      return
    }
    var old = colDef.width;
    colDef.width = w;
    this.__setCanvasWidth_AU__(this.__setColLefts_Be__(this.grid.colDefMgr.getIdxByKey(key))[this.grid.colDefMgr.length()]);
    this.grid._recreateDynamicCss();
    this.grid.event.trigger("onResizeCol_" + key + " onResizeCol", [key, w, old])
  };
  prototype.__autoColWidth_Bg__ = function(key) {
    var res = this.__canvasFind_AC__(".k_" + key), max = Number.MIN_VALUE, len = res.length, i = 0;
    for(;i < len;i++) {
      if(max < res[i].scrollWidth) {
        max = res[i].scrollWidth
      }
    }
    max -= this.__getPadding_AM__();
    this.setWidthByKey(key, max)
  };
  prototype.__setWidth_AV__ = function(w) {
    w = parseInt(w);
    if(isNaN(w) || w < 1) {
      return
    }
    this.__mask_a__[0].style.width = w + "px"
  };
  prototype.getScrollTop = function() {
    return this.__mask_a__[0].scrollTop
  };
  prototype.getScrollLeft = function() {
    return this.__mask_a__[0].scrollLeft
  };
  prototype.setScrollTop = function(t) {
    var scrollTop = this.getScrollTop();
    if(Util.isNotNull(t) && scrollTop != t) {
      return this.__mask_a__[0].scrollTop = t
    }
    return scrollTop
  };
  prototype.setScrollLeft = function(left) {
    var scrollLeft = this.getScrollLeft();
    if(Util.isNotNull(left) && scrollLeft != left) {
      return this.__mask_a__[0].scrollLeft = left
    }
    return scrollLeft
  };
  prototype.__hasHScrollbar_i__ = function() {
    return this.__mask_a__[0].offsetHeight > this.__mask_a__[0].clientHeight
  };
  prototype.__hasVScrollbar_j__ = function() {
    return this.__mask_a__[0].offsetWidth > this.__mask_a__[0].clientWidth
  };
  prototype.__heightPlus_AW__ = function() {
    return this.__mask_a__[0].offsetHeight - this.__mask_a__[0].clientHeight
  };
  prototype.__widthPlus_AX__ = function() {
    return this.__mask_a__[0].offsetWidth - this.__mask_a__[0].clientWidth
  };
  prototype.__getFirstVisibleRow_k__ = function() {
    return Math.floor(this.getScrollTop() / this.__getRowOuterHeight_AN__())
  };
  prototype.__getFirstSafeVisibleRow_l__ = function() {
    return Math.ceil(this.getScrollTop() / this.__getRowOuterHeight_AN__())
  };
  prototype.__getLastVisibleRow_m__ = function() {
    return Math.ceil((this.getScrollTop() + this.__mask_a__[0].clientHeight) / this.__getRowOuterHeight_AN__()) - 1
  };
  prototype.__getLastSafeVisibleRow_n__ = function() {
    return Math.floor((this.getScrollTop() + this.__mask_a__[0].clientHeight) / this.__getRowOuterHeight_AN__()) - 1
  };
  prototype.__getFirstRowForSafe_o__ = function(row) {
    return row - Math.floor(this.__mask_a__[0].clientHeight / this.__getRowOuterHeight_AN__()) + 1
  };
  prototype.__getFirstVisibleCol_p__ = function() {
    var scrollLeft = this.getScrollLeft(), colLefts = this.__colLefts_Bd__, i = 0, len = colLefts.length;
    for(;i < len;i++) {
      if(colLefts[i] > scrollLeft) {
        return i - 1
      }
      if(colLefts[i] === scrollLeft) {
        return i
      }
    }
    return len - 2
  };
  prototype.__getFirstSafeVisibleCol_q__ = function() {
    var scrollLeft = this.getScrollLeft(), colLefts = this.__colLefts_Bd__, i = 0, len = colLefts.length;
    for(;i < len;i++) {
      if(colLefts[i] >= scrollLeft) {
        return i
      }
    }
    return len - 2
  };
  prototype.__getLastVisibleCol_r__ = function() {
    var scrollLeft = this.getScrollLeft() + this.__mask_a__[0].clientWidth, colLefts = this.__colLefts_Bd__, i = 0, len = colLefts.length;
    for(;i < len;i++) {
      if(colLefts[i] >= scrollLeft) {
        return i - 1
      }
    }
    return len - 2
  };
  prototype.__getLastSafeVisibleCol_s__ = function() {
    var scrollLeft = this.getScrollLeft() + this.__mask_a__[0].clientWidth, colLefts = this.__colLefts_Bd__, i = 0, len = colLefts.length;
    for(;i < len;i++) {
      if(colLefts[i] > scrollLeft) {
        return i - 2
      }
    }
    return len - 2
  };
  prototype.__getFirstColForSafe_t__ = function(col) {
    var colLefts = this.__colLefts_Bd__, left = colLefts[col + 1] - this.__mask_a__[0].clientWidth, i = col;
    if(left <= 0) {
      return 0
    }
    for(;i >= 0;i--) {
      if(i === col && colLefts[i] <= left || colLefts[i] === left) {
        return i
      }
      if(colLefts[i] < left) {
        return i + 1
      }
    }
    return 0
  };
  prototype.getScrollHForSafe = function(col) {
    var colLefts = this.__colLefts_Bd__, left = colLefts[col + 1] - this.__mask_a__[0].clientWidth;
    if(colLefts[col] <= left) {
      return colLefts[col]
    }
    return left
  };
  prototype.__getRenderRange_u__ = function() {
    if(this._options.__autoHeight_w__) {
      return{start:0, end:this.grid.dataMgr.datalist.length - 1}
    }
    var tmp, max = this.grid.dataMgr.datalist.length - 1;
    return{start:(tmp = this.__getFirstVisibleRow_k__() - this._options.__bufferSize_d__) < 0 ? 0 : tmp, end:(tmp = this.__getLastVisibleRow_m__() + this._options.__bufferSize_d__) > max ? max : tmp}
  };
  prototype.__fitHeight_AY__ = function() {
    this.__mask_a__[0].style.height = this.getCanvasHeight() + this.__heightPlus_AW__() + "px"
  };
  prototype.__resizeWidth_AZ__ = function(e) {
    if(this._options.__autoHeight_w__) {
      this.__fitHeight_AY__()
    }
  };
  prototype.onAfterRefresh = function(args) {
    if(args !== undefined && args.noRerender === true) {
      return
    }
    this.__rerender_Ba__()
  };
  prototype.__rerender_Ba__ = function() {
    var st = this.getScrollTop(), sl = this.getScrollLeft();
    this.grid.event.trigger("onBeforeRerender");
    this.unlockAllRows();
    this.__removeRows_y__();
    var rowLen = this.grid.dataMgr.datalist.length;
    if(this._vars.__lastRowLen_l__ !== rowLen) {
      this._vars.__lastRowLen_l__ = rowLen;
      this.__setCanvasHeight_AS__(this.__calCanvasHeight_AR__())
    }
    this.__render_w__();
    this.setScrollTop(st);
    this.setScrollLeft(sl);
    this.grid.event.trigger("onAfterRerender")
  };
  prototype.__render_w__ = function(range) {
    this.__removeAndRenderRows_Am__(range)
  };
  prototype.__renderShift_x__ = function(range) {
    if(Util.isNull(range)) {
      range = this.__getRenderRange_u__()
    }
    this.__removeRowsExcept_z__(range);
    this.__appendRows_Al__(range)
  };
  prototype.__removeRows_y__ = function(range) {
    var canvas = this.__canvas_c__[0], rendered = this.__renderedRows_A__, locked = this.__lockedRows_B__, id;
    if(Util.isNull(range)) {
      if(this.__lockExist_Ad__()) {
        for(id in rendered) {
          if(rendered.hasOwnProperty(id)) {
            if(locked.hasOwnProperty(id)) {
              canvas.removeChild(rendered[id]);
              delete rendered[id]
            }
          }
        }
      }else {
        this.__renderedRows_A__ = {};
        canvas.innerHTML = ""
      }
    }else {
      var i = range.start, end = range.end, dataMgr = this.grid.dataMgr;
      for(;i <= end;i++) {
        if(!locked.hasOwnProperty(id = dataMgr.getIdByIdx(i)) && rendered.hasOwnProperty(id)) {
          canvas.removeChild(rendered[id]);
          delete rendered[id]
        }
      }
    }
  };
  prototype.__removeRowsExcept_z__ = function(range) {
    var canvas = this.__canvas_c__[0], rendered = this.__renderedRows_A__, locked = this.__lockedRows_B__, id;
    if(Util.isNull(range)) {
      if(this.__lockExist_Ad__()) {
        for(id in rendered) {
          if(rendered.hasOwnProperty(id) && locked.hasOwnProperty(id) === false) {
            canvas.removeChild(rendered[id]);
            delete rendered[id]
          }
        }
      }else {
        this.__renderedRows_A__ = {};
        canvas.innerHTML = ""
      }
    }else {
      var start = range.start, end = range.end, dataMgr = this.grid.dataMgr, i;
      for(id in rendered) {
        if(rendered.hasOwnProperty(id)) {
          if(locked.hasOwnProperty(id) || start <= (i = dataMgr.getIdxById(id)) && i <= end) {
            continue
          }
          canvas.removeChild(rendered[id]);
          delete rendered[id]
        }
      }
    }
  };
  prototype.destroyRow = function(datarow) {
    return this.destroyRowById(this.grid.dataMgr.getId(datarow))
  };
  prototype.destroyRowById = function(id) {
    if(Util.isNotNull(id)) {
      this.unlockRowById(id);
      if(this.__renderedRows_A__.hasOwnProperty(id)) {
        this.__canvas_c__[0].removeChild(this.__renderedRows_A__[id]);
        delete this.__renderedRows_A__[id]
      }
    }
  };
  prototype.destroyRowByIdx = function(i) {
    return this.destroyRowById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.__lockExist_Ad__ = function() {
    return Util.isNotEmptyObj(this.__lockedRows_B__)
  };
  prototype.isRowLockedById = function(id) {
    if(Util.isNotNull(id)) {
      return this.__lockedRows_B__.hasOwnProperty(id)
    }
    return false
  };
  prototype.isRowLocked = function(datarow) {
    return this.isRowLockedById(this.grid.dataMgr.getId(datarow))
  };
  prototype.isRowLockedByIdx = function(i) {
    return this.isRowLockedById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.lockRowById = function(id) {
    if(Util.isNotNull(id) && this.grid.dataMgr.hasById(id)) {
      this.__lockedRows_B__[id] = true
    }
  };
  prototype.lockRow = function(datarow) {
    return this.lockRowById(this.grid.dataMgr.getId(datarow))
  };
  prototype.lockRowByIdx = function(i) {
    return this.lockRowById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.unlockRowById = function(id) {
    if(this.isRowLockedById(id)) {
      delete this.__lockedRows_B__[id]
    }
  };
  prototype.unlockRow = function(datarow) {
    return this.unlockRowById(this.grid.dataMgr.getId(datarow))
  };
  prototype.unlockRowByIdx = function(i) {
    return this.unlockRowById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.unlockAllRows = function() {
    this.__lockedRows_B__ = {}
  };
  prototype.rerenderRowById = function(id) {
    if(!this.grid.dataMgr.containsById(id)) {
      return
    }
    var rmap = this.__renderedRows_A__, canvas = this.__canvas_c__[0], datam = this.grid.dataMgr, i = datam.getIdxById(id), datarow = datam.getById(id), colDefs = this.grid.colDefMgr.get(), colCommon = this.__getColCellClasses_An__(colDefs), rowH = this.__getRowOuterHeight_AN__(), html = [], newNodes;
    if(rmap.hasOwnProperty(id)) {
      canvas.removeChild(rmap[id]);
      this.grid.event.trigger("onBeforeRenderRows", [[i]]);
      this.__renderRow_Ap__(html, i, datarow, colDefs, colCommon, rowH);
      rmap[id] = Util.appendHTML(canvas, html.join(""))[0];
      this.grid.event.trigger("onAppendRows", [[i]])
    }
  };
  prototype.rerenderRow = function(datarow) {
    return this.rerenderRowById(this.grid.dataMgr.getId(datarow))
  };
  prototype.rerenderRowByIdx = function(i) {
    return this.rerenderRowById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.rerenderCellByIdAndKey = function(id, key) {
    var cellnode = this.getCellByIdAndKey(id, key);
    if(cellnode !== undefined) {
      var datam = this.grid.dataMgr, colm = this.grid.colDefMgr, datarow = datam.getById(id), colDef = colm.getByKey(key), row = datam.getIdxById(id), col = colm.getIdxByKey(key);
      cellnode.innerHTML = this.__renderCell_Aq__([], row, col, datarow, colDef).join("")
    }
  };
  prototype.rerenderCellByIdx = function(row, col) {
    return this.rerenderCellByIdAndKey(this.grid.dataMgr.getIdByIdx(row), this.grid.colDefMgr.getKeyByIdx(col))
  };
  prototype.__appendRows_Al__ = function(range) {
    this.grid.event.trigger("onBeforeRenderRows", [range]);
    var html = [], i = range.start, end = range.end, datalist = this.grid.dataMgr.datalist, idKey = this.grid.dataMgr.idKey, colDefs = this.grid.colDefMgr.get(), collen = colDefs.length, colCommon = this.__getColCellClasses_An__(colDefs), rendered = this.__renderedRows_A__, rowH = this.__getRowOuterHeight_AN__(), canvas = this.__canvas_c__[0], datarow, id, added = [], node, newNodes, len;
    for(;i <= end;i++) {
      datarow = datalist[i];
      if(rendered.hasOwnProperty(id = datarow[idKey])) {
        continue
      }
      this.__renderRow_Ap__(html, i, datarow, colDefs, colCommon, rowH);
      added.push(id)
    }
    newNodes = Util.appendHTML(canvas, html.join(""));
    for(i = 0, len = added.length;i < len;i++) {
      rendered[added[i]] = newNodes[i]
    }
    this.grid.event.trigger("onAppendRows", [range])
  };
  prototype.__removeAndRenderRows_Am__ = function(range) {
    if(Util.isNull(range)) {
      range = this.__getRenderRange_u__()
    }
    this.grid.event.trigger("onBeforeRenderRows", [range]);
    var html = [], i = range.start, end = range.end, dataMgr = this.grid.dataMgr, datalist = dataMgr.datalist, idKey = dataMgr.idKey, colDefs = this.grid.colDefMgr.get(), collen = colDefs.length, colCommon = this.__getColCellClasses_An__(colDefs), canvas = this.__canvas_c__[0], rowH = this.__getRowOuterHeight_AN__(), datarow, added = [], newRendered = {}, len;
    for(;i <= end;i++) {
      datarow = datalist[i];
      this.__renderRow_Ap__(html, i, datarow, colDefs, colCommon, rowH);
      added.push(datarow[idKey])
    }
    canvas.innerHTML = html.join("");
    for(i = 0, len = added.length;i < len;i++) {
      newRendered[added[i]] = canvas.childNodes[i]
    }
    this.__renderedRows_A__ = newRendered;
    this.grid.event.trigger("onAppendRows", [range])
  };
  prototype.__getColCellClass_Ao__ = function(colDef) {
    var cssClass = this._options.__classCell_m__ + " " + "k_" + colDef.key;
    if(Util.isNotNull(colDef.colClass)) {
      cssClass += " " + colDef.colClass
    }
    cssClass += " " + this.grid.event.trigger("onGetColCellClass", [colDef]).join(" ");
    return cssClass
  };
  prototype.__getColCellClasses_An__ = function(colDefs) {
    var cssClasses = [], i = 0, len = colDefs.length;
    if(Util.isNull(colDefs)) {
      colDefs = this.grid.colDefMgr.get()
    }
    for(;i < len;i++) {
      cssClasses.push(this.__getColCellClass_Ao__(colDefs[i]))
    }
    return cssClasses
  };
  prototype.__renderRow_Ap__ = function(html, rowIdx, datarow, colDefs, colCommon, rowH) {
    html.push("<div class='" + this._options.__classRow_l__ + "' i='" + datarow[this.grid.dataMgr.idKey] + "' " + this._options.__attrRowIdx_a__ + "='" + rowIdx + "' style='top:" + rowH * rowIdx + "px'>");
    var i = 0, collen = colDefs.length;
    for(;i < collen;i++) {
      html.push("<div class='" + colCommon[i] + " " + this.grid.event.trigger("onGetCellClass", [rowIdx, i, datarow, colDefs[i]]).join(" ") + "'>");
      this.__renderCell_Aq__(html, rowIdx, i, datarow, colDefs[i]);
      html.push("</div>")
    }
    html.push("</div>");
    return html
  };
  prototype.__renderCell_Aq__ = function(html, rowIdx, colIdx, datarow, colDef) {
    this.grid.event.trigger("onRenderCell_" + colDef.key + "_prepend", [rowIdx, colIdx, datarow, colDef, html]);
    var val = datarow[colDef.key];
    if(typeof val !== "string" || val.substring(0, 3) !== "J@H") {
      if(colDef.rendererInput) {
        html.push(colDef.renderer(JGM.create("Cell", {grid:this.grid, row:rowIdx, col:colIdx, datarow:datarow, colDef:colDef})))
      }else {
        html.push(colDef.renderer(val, rowIdx, colIdx, datarow, colDef, this))
      }
    }
    this.grid.event.trigger("onRenderCell_" + colDef.key + "_append", [rowIdx, colIdx, datarow, colDef, html]);
    return html
  };
  JGM.Cell.prototype.rerender = function() {
    return this.grid.view.rerenderCellByIdAndKey(this.getId(), this.getKey())
  };
  JGM.Cell.prototype.scrollTo = function() {
    this.grid.view.scrollTo(this.getRowIdx(), this.getColIdx())
  };
  prototype._keydown = function(e) {
    if(!Util.contains(this.__mask_a__[0], document.activeElement, this._ctnr[0])) {
      return
    }
    this.grid.event.trigger("keydownCanvas_" + e.which + " keydownCanvas", [e])
  };
  prototype._keyup = function(e) {
    if(!Util.contains(this.__mask_a__[0], document.activeElement, this._ctnr[0])) {
      return
    }
    this.grid.event.trigger("keyupCanvas_" + e.which + " keyupCanvas", [e])
  };
  prototype._keypress = function(e) {
    if(!Util.contains(this.__mask_a__[0], document.activeElement, this._ctnr[0])) {
      return
    }
    this.grid.event.trigger("keypressCanvas_" + e.which + " keypressCanvas", [e])
  };
  prototype._mousein = function(e) {
    if(this._vars.drag) {
      this.__triggerMouseEvent_Ar__(e, {event:"draginCanvas mouseinCanvas"})
    }else {
      this.__triggerMouseEvent_Ar__(e, {event:"mouseinCanvas"})
    }
  };
  prototype._mouseout = function(e) {
    if(this._vars.drag) {
      this.__triggerMouseEvent_Ar__(e, {event:"dragoutCanvas mouseoutCanvas"})
    }else {
      this.__triggerMouseEvent_Ar__(e, {event:"mouseoutCanvas"})
    }
  };
  prototype._mouseenter = function(e) {
    if(this._vars.drag) {
      this.__triggerMouseEvent_Ar__(e, {event:"dragenterCanvas mouseenterCanvas"})
    }else {
      this.__triggerMouseEvent_Ar__(e, {event:"mouseenterCanvas"})
    }
  };
  prototype._mouseleave = function(e) {
    if(this._vars.drag) {
      this.__triggerMouseEvent_Ar__(e, {event:"dragleaveCanvas mouseleaveCanvas"})
    }else {
      this.__triggerMouseEvent_Ar__(e, {event:"mouseleaveCanvas"})
    }
  };
  prototype._mousemove = function(e) {
    if(this._vars.drag) {
      this.__triggerMouseEvent_Ar__(e, {event:"dragmoveCanvas mousemoveCanvas"})
    }else {
      this.__triggerMouseEvent_Ar__(e, {event:"mousemoveCanvas"})
    }
  };
  prototype._mouseover = function(e) {
    if(this._vars.drag) {
      this.__triggerMouseEvent_Ar__(e, {event:"dragoverCanvas mouseoverCanvas"})
    }else {
      this.__triggerMouseEvent_Ar__(e, {event:"mouseoverCanvas"})
    }
  };
  prototype._mousedown = function(e) {
    if(this.__triggerMouseEvent_Ar__(e, {event:"mousedownCanvas"})) {
      this._vars.drag = true;
      this.focus(e)
    }
  };
  prototype._mouseup = function(e) {
    this._vars.drag = false;
    if(this.__triggerMouseEvent_Ar__(e, {event:"mouseupCanvas"})) {
      this.focus(e)
    }
  };
  prototype._click = function(e) {
    this.__triggerMouseEvent_Ar__(e, {event:"clickCanvas"})
  };
  prototype._dblclick = function(e) {
    this.__triggerMouseEvent_Ar__(e, {event:"dblclickCanvas"})
  };
  prototype.__triggerMouseEvent_Ar__ = function(e, args) {
    var node = this.__getClosestCell_Az__(e.target), arr, earr, i, len;
    if(node === undefined) {
      return false
    }
    args.cell = JGM.create("Cell", {grid:this.grid, node:node});
    arr = Util.split(args.event);
    len = arr.length;
    earr = [];
    for(i = 0;i < len;i++) {
      earr.push(arr[i] + "_" + args.cell.getKey());
      earr.push(arr[i])
    }
    this.grid.event.trigger(earr.join(" "), [e, args.cell]);
    return true
  };
  prototype.__scroll_As__ = function() {
    var scrollTop = this.getScrollTop(), scrollVDist = scrollTop - this._vars.__lastScrollTop_d__, scrollLeft = this.getScrollLeft(), scrollHDist = scrollLeft - this._vars.__lastScrollLeft_e__;
    if(scrollVDist === 0 && scrollHDist === 0) {
      return
    }
    this.grid.event.trigger("onScrollViewport");
    if(scrollHDist !== 0) {
      this._vars.__lastScrollLeft_e__ = scrollLeft;
      this.grid.event.trigger("onScrollViewportH", [scrollLeft])
    }
    var numDiff = Math.abs(scrollVDist / this.__getRowOuterHeight_AN__());
    if(numDiff < this._options.__appendThreshold_b__) {
      return
    }
    this._vars.__lastScrollTop_d__ = scrollTop;
    this.__render_w__();
    this.grid.event.trigger("onScrollViewportV")
  };
  prototype.focus = function(e) {
    if(Util.isNotNull(e) && this.grid.event.triggerInvalid("onBeforeFocusCanvas", [e])) {
      return
    }
    if(this.__mask_a__[0] !== document.activeElement) {
      if(Util.isFunction(this.__mask_a__[0].setActive)) {
        try {
          this.__mask_a__[0].setActive()
        }catch(exp) {
        }
      }
      this.__mask_a__[0].focus();
      if(document.activeElement !== this.__mask_a__[0]) {
        this.__mask_a__.focus()
      }
    }
  };
  prototype.isRenderedById = function(id) {
    if(Util.isNotNull(id)) {
      return this.__renderedRows_A__.hasOwnProperty(id)
    }
    return false
  };
  prototype.isRendered = function(datarow) {
    return this.isRenderedById(this.grid.dataMgr.getId(datarow))
  };
  prototype.isRenderedByIdx = function(rowIdx) {
    return this.isRenderedById(this.grid.dataMgr.getIdByIdx(rowIdx))
  };
  prototype.getRowById = function(id) {
    if(this.isRenderedById(id)) {
      return this.__renderedRows_A__[id]
    }
  };
  prototype.getRow = function(datarow) {
    return this.getRowById(this.grid.dataMgr.getId(datarow))
  };
  prototype.getRowByIdx = function(i) {
    return this.getRowById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.getRenderedRowById = function(id) {
    if(this.isRenderedById(id)) {
      return this.__renderedRows_A__[id]
    }
  };
  prototype.getRenderedRow = function(datarow) {
    return this.getRenderedRowById(this.grid.dataMgr.getId(datarow))
  };
  prototype.getRenderedRowByIdx = function(i) {
    return this.getRenderedRowById(this.grid.dataMgr.getIdByIdx(i))
  };
  prototype.getRenderedRows = function() {
    return Util.toArray(this.__renderedRows_A__);
    return Array.prototype.slice.call(this.__canvas_c__[0].childNodes)
  };
  prototype.getCell = function(rowIdx, colIdx) {
    var rowNode = this.getRowByIdx(rowIdx);
    if(Util.isNotNull(rowNode, colIdx)) {
      return rowNode.childNodes[colIdx]
    }
  };
  prototype.getCellByIdAndKey = function(id, key) {
    var rowNode = this.getRowById(id), colIdx = this.grid.colDefMgr.getIdxByKey(key);
    if(Util.isNotNullAnd(rowNode, colIdx)) {
      return rowNode.childNodes[colIdx]
    }
  };
  prototype.getRenderedCell = function(rowIdx, colIdx) {
    var rowNode = this.getRenderedRowByIdx(rowIdx);
    if(Util.isNotNull(rowNode)) {
      return rowNode.childNodes[colIdx]
    }
  };
  prototype.getRenderedCellByIdAndKey = function(id, key) {
    var rowNode = this.getRenderedRowById(id), colIdx = this.grid.colDefMgr.getIdxByKey(key);
    if(Util.isNotNullAnd(rowNode, colIdx)) {
      return rowNode.childNodes[colIdx]
    }
  };
  prototype.__getClosestCell_Az__ = function(obj) {
    return Util.closestWithTag(obj, "DIV", this._options.__classCell_m__, this.__canvas_c__[0])
  };
  prototype.__getClosestRow_AA__ = function(obj) {
    return Util.closestWithTag(obj, "DIV", this._options.__classRow_l__, this.__canvas_c__[0])
  };
  prototype.__getClosestRowIdx_AB__ = function(obj) {
    return this.grid.dataMgr.getIdxByNode(this.__getClosestRow_AA__(obj))
  };
  prototype.__canvasFind_AC__ = function(selector) {
    return this.__canvas_c__.find(selector)
  };
  ViewportManager.__renderer_AD__ = function(value, rowIdx, colIdx, datarow, colDef, viewMgr) {
    return Util.ifNull(value, "")
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.provide("jx.grid.DataCreator");
(function() {
  goog.exportSymbol("jx.grid.DataCreator", DataCreator);
  JGM._add("DataCreator", DataCreator);
  function DataCreator(args) {
    this.mid = args.mid;
    this._ctnr = args.container;
    this.__creator_a__;
    this.grid = args.grid;
    this.grid.creator = this;
    var options = {__background_a__:"#dfdfdf", __borderThickness_b__:0, __border_c__:"solid #D6D6D6", __inputBorder_d__:"solid #A7A7A7", __inputBorderThickness_e__:1, __inputHeight_f__:18, __inputMargin_g__:8, __nameMargin_h__:2, __font_i__:"12px Arial,Helvetica,sans-serif", __height_j__:28, __padding_k__:3, __classCreatorIcon_l__:"creator-icon", __creatorIconUrl_m__:this.grid._options.imageUrl + "data-creator-icon.png", __creatorIconWidth_n__:13, __creatorIconHeight_o__:13, __classCreator_p__:"data-creator", 
    __classColName_q__:"data-creator-name", __inputBorderRadius_r__:3};
    this._options = JGM.__extend_e__(options, args.options, {background:"__background_a__", borderThickness:"__borderThickness_b__", border:"__border_c__", inputBorder:"__inputBorder_d__", inputBorderThickness:"__inputBorderThickness_e__", inputHeight:"__inputHeight_f__", inputMargin:"__inputMargin_g__", nameMargin:"__nameMargin_h__", font:"__font_i__", height:"__height_j__", padding:"__padding_k__", classCreatorIcon:"__classCreatorIcon_l__", creatorIconUrl:"__creatorIconUrl_m__", creatorIconWidth:"__creatorIconWidth_n__", 
    creatorIconHeight:"__creatorIconHeight_o__", classCreator:"__classCreator_p__", classColName:"__classColName_q__", inputBorderRadius:"__inputBorderRadius_r__"});
    this.__inputMap_c__ = {};
    this.__init()
  }
  DataCreator.getInstance = function(args) {
    return new DataCreator(args)
  };
  var prototype = DataCreator.prototype;
  prototype.__init = function() {
    this.__creator_a__ = $("<div class='" + this._options.__classCreator_p__ + "'>").appendTo(this._ctnr);
    this.bindEvents()
  };
  prototype.bindEvents = function() {
    var events = {onRenderModules:this.__onRenderModules_aE__, onCreateCss:this.__onCreateCss_V__, onDestroy:this.__destroy_aA__};
    this.grid.event.bind(events, this)
  };
  prototype.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, border = o.__borderThickness_b__ + "px " + o.__border_c__, rules = [];
    rules.push(gridId + o.__classCreator_p__ + "{" + JGM.__CONST_g__.__cssUnselectable_a__ + "float:left;width:100%;padding-left:8px;background:" + o.__background_a__ + ";border-top:" + border + ";font:" + o.__font_i__ + "}");
    rules.push(gridId + o.__classCreator_p__ + " button{float:left;margin:" + o.__padding_k__ + "px " + o.__padding_k__ + "px 0 0;height:" + (o.__height_j__ - 2 * o.__padding_k__) + "px}");
    rules.push(gridId + o.__classCreator_p__ + " input{float:left;padding:0;margin-top:" + (o.__height_j__ - o.__inputHeight_f__ - 2 * o.__inputBorderThickness_e__) / 2 + "px;height:" + o.__inputHeight_f__ + "px;border:" + o.__inputBorderThickness_e__ + "px " + o.__inputBorder_d__ + ";border-radius:" + o.__inputBorderRadius_r__ + "px;-moz-border-radius:" + o.__inputBorderRadius_r__ + "px}");
    rules.push(gridId + o.classCol + "{float:left;overflow:hidden;white-space:nowrap;line-height:" + o.__height_j__ + "px;margin-right:" + o.__inputMargin_g__ + "px}");
    rules.push(gridId + o.__classColName_q__ + "{float:left;margin-right:" + o.__nameMargin_h__ + "px}");
    rules.push(gridId + o.__classCreatorIcon_l__ + "{background:url(" + o.__creatorIconUrl_m__ + ") no-repeat center;width:" + o.__creatorIconWidth_n__ + "px;height:" + o.__creatorIconHeight_o__ + "px}");
    return rules.join("")
  };
  prototype.__onRenderModules_aE__ = function() {
    var html = [], colDefs = this.grid.colDefMgr.getAll(), len = colDefs.length, colDef, opt = this._options, classCol = opt.classCol, classColName = opt.__classColName_q__, thisIns = this, creator = this.__creator_a__, imap = this.__inputMap_c__, i = 0, keyupfn = function(e) {
      if(e.which === Util.keyMapKeydown.enter) {
        thisIns.__addData_d__()
      }
    };
    for(;i < len;i++) {
      colDef = colDefs[i];
      if(colDef.inputOnCreate === true) {
        html.push("<div key='" + colDef.key + "' class='" + classCol + "'><div class='" + classColName + "'>" + colDef.name + "</div><input type='text' value='" + Util.ifNull(colDef.defaultValue, "") + "' style='width:" + colDef.width + "px'/></div>")
      }
    }
    creator[0].innerHTML = html.join("") + "<button type='button' onclick='JGM.m.DataCreator." + this.mid + ".__addData_d__()'></button><button type='button' onclick='JGM.m.DataCreator." + this.mid + ".__reset_e__()'></button>";
    for(i = 0;i < len;i++) {
      colDef = colDefs[i];
      if(colDef.inputOnCreate === true) {
        imap[colDef.key] = creator.find("div[key='" + colDef.key + "'] input").keyup(keyupfn)
      }
    }
    if(Util.isNotNull(this.grid.menubar)) {
      this.grid.menubar.addIcon(opt.__classCreatorIcon_l__, "  .", opt.__creatorIconWidth_n__, opt.__creatorIconHeight_o__, function() {
        creator.toggle("fast")
      });
      creator.hide()
    }
  };
  prototype.__addData_d__ = function() {
    var key, imap = this.__inputMap_c__, cmgr = this.grid.colDefMgr, colDef, input, newData = {}, colDefs = cmgr.getAll(), len = colDefs.length, i = 0;
    for(key in imap) {
      if(imap.hasOwnProperty(key)) {
        colDef = cmgr.getByKey(key);
        input = imap[key]
      }
    }
    for(;i < len;i++) {
      colDef = colDefs[i];
      key = colDef.key;
      if(imap.hasOwnProperty(key)) {
        newData[key] = imap[key][0].value
      }else {
        if(colDef.defaultValue !== undefined) {
          newData[key] = colDef.defaultValue
        }
      }
    }
    this.grid.event.trigger("onAfterDataCreate", [newData]);
    this.grid.dataMgr.add(newData, {isNew:true})
  };
  prototype.__reset_e__ = function() {
    var key, cmgr = this.grid.colDefMgr, colDef, imap = this.__inputMap_c__;
    for(key in imap) {
      if(imap.hasOwnProperty(key)) {
        colDef = cmgr.getByKey(key);
        if(colDef.defaultValue !== undefined) {
          imap[key][0].value = colDef.defaultValue
        }
      }
    }
  };
  prototype.__destroy_aA__ = function() {
    var i, imap = this.__inputMap_c__;
    for(i in imap) {
      if(imap.hasOwnProperty(i)) {
        JGM.__delete$_n__(imap, i)
      }
    }
    JGM._destroy(this, {name:"DataCreator", path:"creator", "$":"__creator_a__", map:"__inputMap_c__ _options"})
  }
})();
goog.require("jx.util");
goog.require("jx.grid");
goog.require("jx.grid.BaseModule");
goog.require("jx.grid.Grid");
goog.require("jx.data.DataManager");
goog.provide("jx.grid.SearchManager");
(function() {
  goog.exportSymbol("jx.grid.SearchManager", SearchManager);
  JGM._add("SearchManager", SearchManager);
  function SearchManager(args) {
    this.mid = args.mid;
    this._ctnr = args.container;
    this.__mask_a__;
    this.__search_c__;
    this.__masterInput_p__;
    this.__tag_d__;
    this.__advButton_q__;
    this.__adv_e__;
    this.grid = args.grid;
    this.grid.search = this;
    var options = {__background_a__:"#f0f0f0", __borderThickness_b__:1, __border_c__:"solid #d6d6d6", __inputBorder_d__:"1px solid #A7A7A7", __inputPadding_e__:0, __searchbarAlign_f__:"center", __searchbarMargin_g__:3, __searchbarWidth_h__:"99%", __searchbarHeight_i__:20, __tagsHeight_j__:26, __tagsPadding_k__:2, __tagsBorderRadius_l__:3, __advButtonColor_m__:"#123272", __advButtonFont_n__:"bold 12px Arial,Helvetica,sans-serif", __advButtonPadding_o__:5, __advButtonBg_p__:"", __advButtonBgHover_q__:"url(" + 
    this.grid._options.imageUrl + "more-options-bg-hover.png) repeat-x scroll center", __advButtonBgActive_r__:"url(" + this.grid._options.imageUrl + "more-options-bg-active.png) repeat-x scroll center", __advButtonBgOpened_s__:"url(" + this.grid._options.imageUrl + "more-options-bg-opened.png) repeat-x scroll center", __advButtonBorderThickness_t__:1, __advButtonBorder_u__:"solid transparent", __advButtonBorderHover_v__:"solid #a4a4a4", __advButtonBorderActive_w__:"solid #c5c5c5", __advButtonBorderOpened_x__:"solid #bfbfbf", 
    __advButtonIconWidth_y__:9, __advButtonIconMargin_z__:2, __advButtonIconUrl_A__:this.grid._options.imageUrl + "more-options.png", __advButtonIconCloseUrl_B__:this.grid._options.imageUrl + "more-options-close.png", __tagPadding_C__:2, __tagBorder_D__:"solid #93979D", __tagBorderThickness_E__:1, __tagFont_F__:"bold 13px Arial", __tagColor_G__:"#282853", __tagBackground_H__:"url(" + this.grid._options.imageUrl + "tag-background.png) repeat-x scroll center", __tagRemoveIconWidth_I__:12, __tagRemoveIconUrl_J__:this.grid._options.imageUrl + 
    "tag-close.png", __tagRemoveIconHoverUrl_K__:this.grid._options.imageUrl + "tag-close-hover.png", __advFont_L__:"11px Arial", __advInputWidth_M__:30, __classMask_N__:"search-mask", __classSearchbar_O__:"search-bar", __classAdvButtonName_P__:"more-option-name", __classAdvButton_Q__:"more-options", __classAdvButtonIcon_R__:"more-icon", __classClearTags_S__:"clear-tags", __classTagbar_T__:"search-tags", __classTag_U__:"search-tag", __classTagName_V__:"search-tag-name", __classRemoveTag_W__:"search-tag-remove", 
    __classAdvanced_X__:"search-advanced", __classOptionCol_Y__:"search-option-col", __classOption_Z__:"search-option", __classSearchIcon_aa__:"search-icon", __searchIconUrl_ab__:this.grid._options.imageUrl + "search-icon.png", __searchIconWidth_ac__:15, __searchIconHeight_ad__:15, __keyMap_ae__:undefined, __tagRemoveIconActiveUrl_af__:this.grid._options.imageUrl + "tag-close-active.png", __syncMaster_ag__:false};
    this._options = JGM.__extend_e__(options, args.options, {background:"__background_a__", borderThickness:"__borderThickness_b__", border:"__border_c__", inputBorder:"__inputBorder_d__", inputPadding:"__inputPadding_e__", searchbarAlign:"__searchbarAlign_f__", searchbarMargin:"__searchbarMargin_g__", searchbarWidth:"__searchbarWidth_h__", searchbarHeight:"__searchbarHeight_i__", tagsHeight:"__tagsHeight_j__", tagsPadding:"__tagsPadding_k__", tagsBorderRadius:"__tagsBorderRadius_l__", advButtonColor:"__advButtonColor_m__", 
    advButtonFont:"__advButtonFont_n__", advButtonPadding:"__advButtonPadding_o__", advButtonBg:"__advButtonBg_p__", advButtonBgHover:"__advButtonBgHover_q__", advButtonBgActive:"__advButtonBgActive_r__", advButtonBgOpened:"__advButtonBgOpened_s__", advButtonBorderThickness:"__advButtonBorderThickness_t__", advButtonBorder:"__advButtonBorder_u__", advButtonBorderHover:"__advButtonBorderHover_v__", advButtonBorderActive:"__advButtonBorderActive_w__", advButtonBorderOpened:"__advButtonBorderOpened_x__", 
    advButtonIconWidth:"__advButtonIconWidth_y__", advButtonIconMargin:"__advButtonIconMargin_z__", advButtonIconUrl:"__advButtonIconUrl_A__", advButtonIconCloseUrl:"__advButtonIconCloseUrl_B__", tagPadding:"__tagPadding_C__", tagBorder:"__tagBorder_D__", tagBorderThickness:"__tagBorderThickness_E__", tagFont:"__tagFont_F__", tagColor:"__tagColor_G__", tagBackground:"__tagBackground_H__", tagRemoveIconWidth:"__tagRemoveIconWidth_I__", tagRemoveIconUrl:"__tagRemoveIconUrl_J__", tagRemoveIconHoverUrl:"__tagRemoveIconHoverUrl_K__", 
    advFont:"__advFont_L__", advInputWidth:"__advInputWidth_M__", classMask:"__classMask_N__", classSearchbar:"__classSearchbar_O__", classAdvButtonName:"__classAdvButtonName_P__", classAdvButton:"__classAdvButton_Q__", classAdvButtonIcon:"__classAdvButtonIcon_R__", classClearTags:"__classClearTags_S__", classTagbar:"__classTagbar_T__", classTag:"__classTag_U__", classTagName:"__classTagName_V__", classRemoveTag:"__classRemoveTag_W__", classAdvanced:"__classAdvanced_X__", classOptionCol:"__classOptionCol_Y__", 
    classOption:"__classOption_Z__", classSearchIcon:"__classSearchIcon_aa__", searchIconUrl:"__searchIconUrl_ab__", searchIconWidth:"__searchIconWidth_ac__", searchIconHeight:"__searchIconHeight_ad__", keyMap:"__keyMap_ae__", tagRemoveIconActiveUrl:"__tagRemoveIconActiveUrl_af__", syncMaster:"__syncMaster_ag__"});
    this.__filterMap_f__ = {};
    this.__tagMap_g__ = {};
    this.__nameMap_h__ = {};
    this.__codeMap_i__ = {};
    this.__global_r__ = [];
    this.__globalMap_s__ = {};
    this.__hasFilter_x__;
    this.__keyToName_y__ = {};
    this.__init()
  }
  var prototype = SearchManager.prototype;
  prototype.__onCreateCss_V__ = function() {
    var gridId = "#" + this.grid.mid + " .", o = this._options, border = o.__borderThickness_b__ + "px " + o.__border_c__, tagsBorderRadius = "border-radius:" + o.__tagsBorderRadius_l__ + "px;-moz-border-radius:" + o.__tagsBorderRadius_l__ + "px", advButtonBorder = o.__advButtonBorderThickness_t__ + "px " + o.__advButtonBorder_u__, advButtonBorderHover = o.__advButtonBorderThickness_t__ + "px " + o.__advButtonBorderHover_v__, advButtonBorderActive = o.__advButtonBorderThickness_t__ + "px " + o.__advButtonBorderActive_w__, 
    advButtonBorderOpened = o.__advButtonBorderThickness_t__ + "px " + o.__advButtonBorderOpened_x__, tagsInnerHeight = o.__tagsHeight_j__ - 2 * o.__tagsPadding_k__, advButtonHeight = tagsInnerHeight - 2 * o.__advButtonBorderThickness_t__, tagHeight = tagsInnerHeight - 2 * o.__tagBorderThickness_E__, classMask = gridId + o.__classMask_N__, classSearchar = gridId + o.__classSearchbar_O__, classAdvButton = gridId + o.__classAdvButton_Q__, classRemoveTag = gridId + o.__classRemoveTag_W__, rules = [];
    rules.push(classMask + "{" + JGM.__CONST_g__.__cssUnselectable_a__ + "overflow:hidden;width:100%;background:" + o.__background_a__ + "}");
    rules.push(classMask + " button{margin:0;padding:0 3px}");
    rules.push(classMask + " input{border:" + o.__inputBorder_d__ + ";padding:" + o.__inputPadding_e__ + "}");
    rules.push(classSearchar + "{text-align:" + o.__searchbarAlign_f__ + ";border-bottom:" + border + "}");
    rules.push(classSearchar + " input{width:" + o.__searchbarWidth_h__ + ";margin:" + o.__searchbarMargin_g__ + "px 0;height:" + o.__searchbarHeight_i__ + "px;" + tagsBorderRadius + "}");
    rules.push(gridId + o.__classTagbar_T__ + "{cursor:default;height:" + (o.__tagsHeight_j__ - o.__tagsPadding_k__) + "px;padding:" + o.__tagsPadding_k__ + "px 0 0 " + o.__tagsPadding_k__ + "px;border-bottom:" + border + "}");
    rules.push(classAdvButton + "{float:left;margin-right:" + o.__tagsPadding_k__ + "px;background:" + o.__advButtonBg_p__ + ";border:" + advButtonBorder + ";padding:0 " + o.__advButtonPadding_o__ + "px;" + tagsBorderRadius + "}");
    rules.push(classAdvButton + ":hover{background:" + o.__advButtonBgHover_q__ + ";border:" + advButtonBorderHover + "}");
    rules.push(classAdvButton + ".opened{background:" + o.__advButtonBgOpened_s__ + ";border:" + advButtonBorderOpened + "}");
    rules.push(classAdvButton + ":active{background:" + o.__advButtonBgActive_r__ + ";border:" + advButtonBorderActive + "}");
    rules.push(gridId + o.__classAdvButtonName_P__ + "{float:left;color:" + o.__advButtonColor_m__ + ";font:" + o.__advButtonFont_n__ + ";line-height:" + advButtonHeight + "px}");
    rules.push(gridId + o.__classAdvButtonIcon_R__ + "{float:left;height:" + advButtonHeight + "px;margin-left:" + o.__advButtonIconMargin_z__ + "px;background:url(" + o.__advButtonIconUrl_A__ + ") no-repeat center;width:" + o.__advButtonIconWidth_y__ + "px}");
    rules.push(classAdvButton + ".opened ." + o.__classAdvButtonIcon_R__ + "{background:url(" + o.__advButtonIconCloseUrl_B__ + ") no-repeat center}");
    rules.push(gridId + o.__classTag_U__ + "{float:left;border:" + o.__tagBorderThickness_E__ + "px " + o.__tagBorder_D__ + ";margin:0 " + o.__tagsPadding_k__ + "px " + o.__tagsPadding_k__ + "px 0;padding:0 " + o.__tagPadding_C__ + "px;background:" + o.__tagBackground_H__ + ";" + tagsBorderRadius + "}");
    rules.push(gridId + o.__classTagName_V__ + "{float:left;color:" + o.__tagColor_G__ + ";font:" + o.__tagFont_F__ + ";line-height:" + tagHeight + "px}");
    rules.push(classRemoveTag + "{float:left;margin-left:" + o.__tagPadding_C__ + "px;background:url(" + o.__tagRemoveIconUrl_J__ + ") no-repeat center;width:" + o.__tagRemoveIconWidth_I__ + "px;height:" + tagHeight + "px}");
    rules.push(classRemoveTag + ":hover{background:url(" + o.__tagRemoveIconHoverUrl_K__ + ") no-repeat center}");
    rules.push(classRemoveTag + ":active{background:url(" + o.__tagRemoveIconActiveUrl_af__ + ") no-repeat center}");
    rules.push(gridId + o.__classClearTags_S__ + "{height:" + tagsInnerHeight + "px}");
    rules.push(gridId + o.__classAdvanced_X__ + "{cursor:default;font:" + o.__advFont_L__ + ";border-bottom:" + border + "}");
    rules.push(gridId + o.__classOptionCol_Y__ + "{display:inline-block;vertical-align:top}");
    rules.push(gridId + o.__classOptionCol_Y__ + " input{width:" + o.__advInputWidth_M__ + "px;margin-right:2px;" + tagsBorderRadius + "}");
    rules.push(gridId + o.__classSearchIcon_aa__ + "{background:url(" + o.__searchIconUrl_ab__ + ") no-repeat center;width:" + o.__searchIconWidth_ac__ + "px;height:" + o.__searchIconHeight_ad__ + "px}");
    return rules.join("")
  };
  SearchManager.getInstance = function(args) {
    return new SearchManager(args)
  };
  prototype.__init = function() {
    var opt = this._options, thisIns = this, mask, hasFilter, tag;
    mask = this.__mask_a__ = $("<div class='" + opt.__classMask_N__ + "'>").prependTo(this._ctnr);
    this.__search_c__ = $("<div class='" + opt.__classSearchbar_O__ + "'><input type='text'/></div>").appendTo(mask);
    this.__masterInput_p__ = this.__search_c__.children(":eq(0)").keyup(function(e) {
      if(e.which === Util.keyMapKeydown.enter) {
        thisIns.__parse_k__($(this)[0].value)
      }else {
        if(e.which === Util.keyMapKeydown.esc) {
          thisIns.__removeAllOptions_n__()
        }
      }
    });
    hasFilter = this.__hasFilter_x__ = this.grid.colDefMgr.get().some(function(a) {
      return Util.isNotNull(a.filter)
    });
    tag = this.__tag_d__ = $("<div class='" + opt.__classTagbar_T__ + "'>" + (hasFilter ? "<div class='" + opt.__classAdvButton_Q__ + "'><div class='" + opt.__classAdvButtonName_P__ + "'> </div><div class='" + opt.__classAdvButtonIcon_R__ + "'></div></div>" : "") + "<button type='button' class='" + opt.__classClearTags_S__ + "' onclick='JGM.m.SearchManager." + this.mid + ".__removeAllOptions_n__()'>  </button></div>").appendTo(mask);
    if(hasFilter) {
      var adv = this.__adv_e__ = $("<div class='" + opt.__classAdvanced_X__ + "'>").appendTo(mask).hide().keyup(function(e) {
        if(e.which === Util.keyMapKeydown.enter) {
          var key = e.target.getAttribute("key");
          thisIns.__registerOption_l__(key, thisIns.__keyToName_y__[key], e.target.getAttribute("tag"), e.target.value);
          e.target.value = ""
        }
      });
      this.__advButton_q__ = tag.children(":eq(0)").click(function() {
        $(this).toggleClass("opened");
        adv.toggle("fast")
      })
    }
    this.grid.event.bind({onRenderModules:this.__onRenderModules_aE__, onCreateCss:this.__onCreateCss_V__, onFilter:this.__onFilter_ar__, onDestroy:this.__destroy_aA__, onAfterRenderModules:this.__onAfterRenderModules_aF__}, this)
  };
  prototype.__onRenderModules_aE__ = function() {
    var html = [], opt = this._options, mask = this.__mask_a__;
    if(this.__hasFilter_x__) {
      var colDefs = this.grid.colDefMgr.get(), len = colDefs.length, keymap = opt.__keyMap_ae__, nmap = this.__nameMap_h__, kmap = this.__keyToName_y__, colDef, nick, key, i = 0;
      for(;i < len;i++) {
        colDef = colDefs[i];
        if(Util.isNotNull(colDef.filter)) {
          key = colDef.key;
          if(Util.isNull(keymap) || !keymap.hasOwnProperty(key)) {
            nick = colDef.name || key
          }else {
            nick = keymap[key]
          }
          nmap[nick] = key;
          kmap[key] = nick;
          html.push("<div class='" + opt.__classOptionCol_Y__ + "'>");
          this.__registerFilter_j__(key, nick, colDef.name, colDef.filter, html);
          html.push("</div>")
        }
      }
      this.__adv_e__[0].innerHTML = html.join("")
    }
    if(Util.isNotNull(this.grid.menubar)) {
      this.grid.menubar.addIcon(opt.__classSearchIcon_aa__, "  .", opt.__searchIconWidth_ac__, opt.__searchIconHeight_ad__, function() {
        mask.toggle("fast")
      });
      mask.hide()
    }
  };
  prototype.__onAfterRenderModules_aF__ = function() {
    var map = this.__filterMap_f__, keymap, key, tag, item, adv = this.__adv_e__;
    for(key in map) {
      if(map.hasOwnProperty(key)) {
        keymap = map[key];
        for(tag in keymap) {
          if(keymap.hasOwnProperty(tag)) {
            if(tag !== "andor" && tag !== "parser" && tag !== "validator") {
              (item = keymap[tag]).input = adv.find("#" + key + item.option.name)
            }
          }
        }
      }
    }
  };
  prototype.__destroy_aA__ = function() {
    var key, tag, base, gmap = this.__globalMap_s__, fmap = this.__filterMap_f__, ftmap, tmap = this.__tagMap_g__, ttmap, ttbmap;
    for(key in gmap) {
      if(gmap.hasOwnProperty(key)) {
        JGM.__delete$_n__(gmap[key], "tag");
        JGM.__deleteArray_r__(gmap[key], "list")
      }
    }
    for(key in fmap) {
      if(fmap.hasOwnProperty(key)) {
        ftmap = fmap[key];
        for(tag in ftmap) {
          if(ftmap.hasOwnProperty(tag)) {
            if(tag !== "andor" && tag !== "parser" && tag !== "validator") {
              JGM.__delete$_n__(ftmap[tag], "input")
            }
            JGM.__deleteMap_l__(ftmap, tag)
          }
        }
        JGM.__deleteMap_l__(fmap, key)
      }
    }
    for(key in tmap) {
      if(tmap.hasOwnProperty(key)) {
        ttmap = tmap[key];
        for(tag in ttmap) {
          if(ttmap.hasOwnProperty(tag)) {
            ttbmap = ttmap[tag];
            for(base in ttbmap) {
              if(ttbmap.hasOwnProperty(base)) {
                JGM.__delete$_n__(ttbmap[base], "tag");
                JGM.__deleteMap_l__(ttbmap, base)
              }
            }
            JGM.__deleteMap_l__(ttmap, tag)
          }
        }
        JGM.__deleteMap_l__(tmap, key)
      }
    }
    JGM._destroy(this, {name:"SearchManager", path:"search", "$":"__masterInput_p__ __advButton_q__ __mask_a__ __search_c__ __tag_d__ __adv_e__", property:"_ctnr __hasFilter_x__", array:"__global_r__", map:"__globalMap_s__ __filterMap_f__ __tagMap_g__ __codeMap_i__ __nameMap_h__ _options __keyToName_y__"})
  };
  prototype.__onFilter_ar__ = function(success, failed) {
    if(this.__global_r__.length === 0 && Util.isEmptyObj(this.__codeMap_i__)) {
      return
    }
    var options, tagMap = this.__tagMap_g__, key, tag, len = success.length, data, value, andor, filterMap = this.__filterMap_f__, and = this.constructor.CONST.and, base, hasGlobal = this.__global_r__.length > 0, i, keymap;
    if(hasGlobal) {
      var global = this.__global_r__, globalToFind, j, k, val, cols = this.grid.colDefMgr.get().filter(function(c) {
        return!c.noSearch
      }), keylen = cols.length, keys = [];
      for(i = 0;i < keylen;i++) {
        keys.push(cols[i].key)
      }
    }
    data_loop:for(i = len - 1;i >= 0;i--) {
      data = success[i];
      if(hasGlobal) {
        globalToFind = global.slice();
        k = 0;
        key_loop:for(;globalToFind.length !== 0 && k < keylen;k++) {
          if(Util.isNull(val = data[keys[k]])) {
            continue
          }
          if(!Util.isString(val)) {
            val = val.toString()
          }
          for(j = globalToFind.length - 1;j >= 0;j--) {
            if(val.indexOf(globalToFind[j]) !== -1) {
              globalToFind.removeAt(j)
            }
          }
        }
        if(globalToFind.length !== 0) {
          success.removeAt(i);
          failed.push(data);
          continue data_loop
        }
      }
      for(key in tagMap) {
        if(tagMap.hasOwnProperty(key)) {
          keymap = tagMap[key];
          andor = filterMap[key].andor;
          value = data[key];
          if(andor === and) {
            for(tag in keymap) {
              if(keymap.hasOwnProperty(tag)) {
                options = keymap[tag];
                for(base in options) {
                  if(options.hasOwnProperty(base)) {
                    if(!options[base].fn(value)) {
                      success.removeAt(i);
                      failed.push(data);
                      continue data_loop
                    }
                  }
                }
              }
            }
          }else {
            for(tag in keymap) {
              if(keymap.hasOwnProperty(tag)) {
                options = keymap[tag];
                for(base in options) {
                  if(options.hasOwnProperty(base)) {
                    if(options[base].fn(value)) {
                      continue data_loop
                    }
                  }
                }
              }
            }
            success.removeAt(i);
            failed.push(data);
            continue data_loop
          }
        }
      }
    }
  };
  prototype.__registerFilter_j__ = function(key, nick, name, filter, html) {
    if(this.__filterMap_f__.hasOwnProperty(key)) {
      return
    }
    if(filter === "number") {
      filter = this.constructor.__numberFilter_d__
    }else {
      if(filter === "string") {
        filter = this.constructor.__stringFilter_e__
      }
    }
    var option, len = filter.length, i = 0, mid = this.mid, classOpt = this._options.__classOption_Z__, fkmap, tmap, tag, oname;
    fkmap = this.__filterMap_f__[key] = {andor:this.constructor.CONST.and};
    tmap = this.__tagMap_g__[key] = {};
    html.push("<table>");
    for(;i < len;i++) {
      option = filter[i];
      oname = option.name;
      if(oname === "parser") {
        fkmap.parser = option.fn;
        continue
      }
      if(oname === "validator") {
        fkmap.validator = option.fn;
        continue
      }
      tag = option.tag;
      fkmap[tag] = {option:option};
      tmap[tag] = {};
      html.push("<tr title='" + option.comment(name, "") + "'><td><div class='" + classOpt + "'>" + name + " " + tag + "</td><td><input id='" + key + oname + "' key='" + key + "' tag='" + tag + "' type='text'><button type='button' onclick=\"JGM.m.SearchManager." + mid + ".__registerOption_l__('" + key + "','" + nick + "','" + tag + "',this.previousSibling.value)\"></button></div></td></tr>")
    }
    html.push("</table>")
  };
  prototype.__parse_k__ = function(str) {
    var arg, key, name, tag, base, args = Util.split(str), len = args.length, status = 2, change = false, global = [], nmap = this.__nameMap_h__, fmap = this.__filterMap_f__, i = 0;
    for(;i < len;i++) {
      arg = args[i];
      if(arg === "") {
        continue
      }
      switch(status) {
        case 0:
          if(fmap[key].hasOwnProperty(arg)) {
            tag = arg;
            status = 1
          }
          break;
        case 1:
          base = arg;
          status = 2;
          break;
        case 2:
          if(arg.charAt(0) === "@") {
            arg = arg.substring(1);
            if(nmap.hasOwnProperty(arg)) {
              if(Util.isNotNullAnd(key, name, tag, base)) {
                if(this.__registerOption_l__(key, name, tag, base, true)) {
                  change = true
                }
              }
              key = nmap[arg];
              name = arg;
              tag = undefined;
              base = undefined;
              status = 0
            }else {
              if(Util.isNull(key)) {
                global.push(arg)
              }else {
                base += " " + arg
              }
            }
          }else {
            if(Util.isNull(key)) {
              global.push(arg)
            }else {
              base += " " + arg
            }
          }
          break;
        default:
      }
    }
    if(Util.isNotNullAnd(key, name, tag, base)) {
      if(this.__registerOption_l__(key, name, tag, base, true)) {
        change = true
      }
    }
    if(this.__registerGlobal_v__(global)) {
      change = true
    }
    this.__syncMasterInput_u__();
    if(change) {
      this.grid.dataMgr.refresh()
    }
  };
  prototype.__syncMasterInput_u__ = function() {
    if(this._options.__syncMaster_ag__) {
      var inputStr = this.__global_r__.join(" "), tagMap = this.__tagMap_g__, keyToName = this.__keyToName_y__, key, tag, base, keymap, basemap;
      for(key in tagMap) {
        if(tagMap.hasOwnProperty(key)) {
          keymap = tagMap[key];
          for(tag in keymap) {
            if(keymap.hasOwnProperty(tag)) {
              basemap = keymap[tag];
              for(base in basemap) {
                if(basemap.hasOwnProperty(base)) {
                  inputStr += " @" + keyToName[key] + " " + tag + " " + base
                }
              }
            }
          }
        }
      }
      this.__masterInput_p__[0].value = $.trim(inputStr)
    }else {
      this.__masterInput_p__[0].value = ""
    }
  };
  prototype.__registerGlobal_v__ = function(toAdd) {
    var i = 0, len = toAdd.length, global = this.__global_r__;
    for(;i < len;i++) {
      if(global.indexOf(toAdd[i]) !== -1) {
        toAdd.removeAt(i--)
      }else {
        global.push(toAdd[i])
      }
    }
    if(toAdd.length === 0) {
      return false
    }
    var opt = this._options;
    this.__globalMap_s__[toAdd[0]] = {tag:$("<div class='" + opt.__classTag_U__ + "' title='" + toAdd.join(", ") + "  '><div class='" + opt.__classTagName_V__ + "'>" + toAdd.join(" ") + "</div><div class='" + opt.__classRemoveTag_W__ + "' title=' ' onclick=\"JGM.m.SearchManager." + this.mid + ".__removeGlobal_w__('" + toAdd[0] + "')\"></div></div>").appendTo(this.__tag_d__), list:toAdd};
    return true
  };
  prototype.__removeGlobal_w__ = function(index) {
    var gmap = this.__globalMap_s__;
    if(gmap.hasOwnProperty(index)) {
      var item = gmap[index];
      item.tag.remove();
      delete item.tag;
      this.__global_r__.removeList(item.list);
      item.list.length = 0;
      delete item.list;
      delete gmap[index];
      this.__syncMasterInput_u__();
      this.grid.dataMgr.refresh()
    }
  };
  prototype.__registerOption_l__ = function(key, nick, optionTag, base, norefresh) {
    var fmap = this.__filterMap_f__, fkmap, fkomap, cmap = this.__codeMap_i__;
    if(fmap.hasOwnProperty(key) && (fkmap = fmap[key]).hasOwnProperty(optionTag)) {
      fkomap = fkmap[optionTag];
      if(Util.isNull(base)) {
        var input = fkomap.input;
        base = $.trim(input.val());
        input.val("")
      }else {
        base = $.trim(base)
      }
      if(base.length === 0) {
        return false
      }
      if(Util.isNotNull(fkmap.parser)) {
        base = fkmap.parser(base)
      }
      if(cmap.hasOwnProperty(key + "@T" + optionTag + "@B" + base)) {
        return false
      }
      if(Util.isNotNull(fkmap.validator)) {
        if(!fkmap.validator(base)) {
          return false
        }
      }
      var option = fkomap.option, andor = fkmap.andor
    }else {
      return false
    }
    var tagmap = this.__tagMap_g__[key];
    if(tagmap[optionTag].hasOwnProperty(base)) {
      return false
    }
    var options, parsedOther, tag, otherbase, filtermap = this.__filterMap_f__[key], oomap;
    for(tag in tagmap) {
      if(tagmap.hasOwnProperty(tag)) {
        options = tagmap[tag];
        for(otherbase in options) {
          if(options.hasOwnProperty(otherbase)) {
            oomap = options[otherbase];
            if(Util.isNotNull(filtermap.parser)) {
              parsedOther = filtermap.parser(otherbase)
            }else {
              parsedOther = otherbase
            }
            if(SearchManager.__checkDisable_c__(option.type, oomap.option.type, andor, base, parsedOther)) {
              delete cmap[key + "@T" + oomap.option.tag + "@B" + parsedOther];
              oomap.tag.remove();
              delete oomap.tag;
              delete oomap.option;
              delete oomap.fn;
              delete options[otherbase]
            }
          }
        }
      }
    }
    cmap[key + "@T" + optionTag + "@B" + base] = true;
    this.__createTag_o__(key, option, base, nick);
    if(!norefresh) {
      this.__syncMasterInput_u__();
      this.grid.dataMgr.refresh()
    }
    return true
  };
  prototype.__removeOption_m__ = function(key, tag, base) {
    var tmap = this.__tagMap_g__, tkmap, tktmap;
    if(tmap.hasOwnProperty(key) && (tkmap = tmap[key]).hasOwnProperty(tag) && (tktmap = tkmap[tag]).hasOwnProperty(base)) {
      var option = tktmap[base];
      option.tag.remove();
      delete option.tag;
      delete option.option;
      delete option.fn;
      delete tktmap[base];
      delete this.__codeMap_i__[key + "@T" + tag + "@B" + base];
      this.__syncMasterInput_u__();
      this.grid.dataMgr.refresh()
    }
  };
  prototype.__removeAllOptions_n__ = function() {
    var key, global = this.__globalMap_s__, item, map = this.__tagMap_g__, tag, base, tagmap, basemap, bb;
    for(key in global) {
      if(global.hasOwnProperty(key)) {
        item = global[key];
        item.tag.remove();
        delete item.tag;
        item.list.length = 0;
        delete item.list;
        delete global[key]
      }
    }
    this.__global_r__.length = 0;
    for(key in map) {
      if(map.hasOwnProperty(key)) {
        tagmap = map[key];
        for(tag in tagmap) {
          if(tagmap.hasOwnProperty(tag)) {
            basemap = tagmap[tag];
            for(base in basemap) {
              if(basemap.hasOwnProperty(base)) {
                bb = basemap[base];
                bb.tag.remove();
                delete bb.tag;
                delete bb.option;
                delete bb.fn;
                delete basemap[base]
              }
            }
          }
        }
      }
    }
    this.__codeMap_i__ = {};
    this.__syncMasterInput_u__();
    this.grid.dataMgr.refresh()
  };
  prototype.__createTag_o__ = function(key, option, base, nick) {
    var opt = this._options;
    return this.__tagMap_g__[key][option.tag][base] = {tag:$("<div class='" + opt.__classTag_U__ + "' title='" + option.comment(nick, base) + "'><div class='" + opt.__classTagName_V__ + "'>@" + nick + " " + option.tag + " " + base + "</div><div class='" + opt.__classRemoveTag_W__ + "' title=' ' onclick=\"JGM.m.SearchManager." + this.mid + ".__removeOption_m__('" + key + "','" + option.tag + "','" + base + "')\"></div></div>").appendTo(this.__tag_d__), option:option, fn:option.fn(base)}
  };
  var con = SearchManager.CONST = {lt:0, lte:1, eq:2, neq:3, gt:4, gte:5, and:6, or:7, T:8, F:9}, lt = con.lt, gt = con.gt, eq = con.eq, neq = con.neq, and = con.and, or = con.or, T = con.T, F = con.F, comp = SearchManager.__comparator_a__ = {}, complt = comp[lt] = function(a, b) {
    return a <= b
  }, compgt = comp[gt] = function(a, b) {
    return a >= b
  }, compeq = comp[eq] = function(a, b) {
    return a === b
  }, compT = comp[T] = function() {
    return true
  }, dmap = SearchManager.__disableMap_b__ = {}, dmaplt = dmap[lt] = {}, dmapgt = dmap[gt] = {}, dmapeq = dmap[eq] = {}, dmapneq = dmap[neq] = {};
  comp[F] = function() {
    return false
  };
  dmaplt[lt] = {};
  dmaplt[lt][and] = compT;
  dmaplt[lt][or] = compT;
  dmaplt[gt] = {};
  dmaplt[gt][and] = complt;
  dmaplt[gt][or] = compgt;
  dmaplt[eq] = {};
  dmaplt[eq][and] = compT;
  dmaplt[eq][or] = compgt;
  dmaplt[neq] = {};
  dmaplt[neq][and] = complt;
  dmaplt[neq][or] = compT;
  dmapgt[lt] = {};
  dmapgt[lt][and] = compgt;
  dmapgt[lt][or] = complt;
  dmapgt[gt] = {};
  dmapgt[gt][and] = compT;
  dmapgt[gt][or] = compT;
  dmapgt[eq] = {};
  dmapgt[eq][and] = compT;
  dmapgt[eq][or] = complt;
  dmapgt[neq] = {};
  dmapgt[neq][and] = compgt;
  dmapgt[neq][or] = compT;
  dmapeq[lt] = {};
  dmapeq[lt][and] = compT;
  dmapeq[lt][or] = complt;
  dmapeq[gt] = {};
  dmapeq[gt][and] = compT;
  dmapeq[gt][or] = compgt;
  dmapeq[eq] = {};
  dmapeq[eq][and] = compT;
  dmapeq[eq][or] = compeq;
  dmapeq[neq] = {};
  dmapeq[neq][and] = compT;
  dmapeq[neq][or] = compT;
  dmapneq[lt] = {};
  dmapneq[lt][and] = compgt;
  dmapneq[lt][or] = compT;
  dmapneq[gt] = {};
  dmapneq[gt][and] = complt;
  dmapneq[gt][or] = compT;
  dmapneq[eq] = {};
  dmapneq[eq][and] = compT;
  dmapneq[eq][or] = compT;
  dmapneq[neq] = {};
  dmapneq[neq][and] = compeq;
  dmapneq[neq][or] = compT;
  SearchManager.__checkDisable_c__ = function(toEnable, other, andor, base, otherbase) {
    try {
      return this.__disableMap_b__[toEnable][other][andor](base, otherbase)
    }catch(e) {
      return false
    }
  };
  SearchManager.__numberFilter_d__ = [{name:"gt", tag:">", type:gt, comment:function(name, base) {
    return name + " () " + base + " "
  }, fn:function(base) {
    if(Util.isString(base)) {
      base = base.toFloat()
    }
    return function(value) {
      return value > base
    }
  }}, {name:"gte", tag:">=", type:gt, comment:function(name, base) {
    return name + " () " + base + "  "
  }, fn:function(base) {
    if(Util.isString(base)) {
      base = base.toFloat()
    }
    return function(value) {
      return value >= base
    }
  }}, {name:"lt", tag:"<", type:lt, comment:function(name, base) {
    return name + " () " + base + " "
  }, fn:function(base) {
    if(Util.isString(base)) {
      base = base.toFloat()
    }
    return function(value) {
      return value < base
    }
  }}, {name:"lte", tag:"<=", type:lt, comment:function(name, base) {
    return name + " () " + base + "  "
  }, fn:function(base) {
    if(Util.isString(base)) {
      base = base.toFloat()
    }
    return function(value) {
      return value <= base
    }
  }}, {name:"eq", tag:"=", type:eq, comment:function(name, base) {
    return name + " () " + base + ""
  }, fn:function(base) {
    if(Util.isString(base)) {
      base = base.toFloat()
    }
    return function(value) {
      return value === base
    }
  }}, {name:"neq", tag:"!=", type:neq, comment:function(name, base) {
    return name + " () " + base + "() "
  }, fn:function(base) {
    if(Util.isString(base)) {
      base = base.toFloat()
    }
    return function(value) {
      return value !== base
    }
  }}, {name:"contains", tag:"*=", comment:function(name, base) {
    return name + " ()  " + base + " "
  }, fn:function(base) {
    if(Util.isNumber(base)) {
      base = base.toString()
    }else {
      base = $.trim(base)
    }
    return function(value) {
      return value.toString().indexOf(base) !== -1
    }
  }}, {name:"parser", fn:function(str) {
    return str.toFloat()
  }}, {name:"validator", fn:function(val) {
    return!isNaN(val)
  }}];
  SearchManager.__stringFilter_e__ = [{name:"to", tag:"<=", type:lt, comment:function(name, base) {
    return name + " () " + base + "  "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    return function(value) {
      return value.toLowerCase() <= base
    }
  }}, {name:"from", tag:">=", type:gt, comment:function(name, base) {
    return name + " () " + base + "  "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    return function(value) {
      return value.toLowerCase() >= base
    }
  }}, {name:"equals", tag:"=", type:eq, comment:function(name, base) {
    return name + " () " + base + "() "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    return function(value) {
      return value.toLowerCase() === base
    }
  }}, {name:"notEquals", tag:"!=", type:neq, comment:function(name, base) {
    return name + " () " + base + "() "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    return function(value) {
      return value.toLowerCase() !== base
    }
  }}, {name:"startsWith", tag:"^=", comment:function(name, base) {
    return name + " () " + base + "() "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    var baselen = base.length;
    return function(value) {
      return value.substr(0, baselen).toLowerCase() === base
    }
  }}, {name:"endsWith", tag:"$=", comment:function(name, base) {
    return name + " () " + base + "() "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    var baselen = base.length;
    return function(value) {
      return value.substr(value.length - baselen, value.length).toLowerCase() === base
    }
  }}, {name:"contains", tag:"*=", comment:function(name, base) {
    return name + " () " + base + "() "
  }, fn:function(base) {
    base = $.trim(base).toLowerCase();
    return function(value) {
      return value.toLowerCase().indexOf(base) !== -1
    }
  }}, {name:"containsAny", tag:"|=", comment:function(name, base) {
    return name + " () " + base + "    "
  }, fn:function(base) {
    base = base.toLowerCase();
    var baseArr = Util.split(base), baseArrlen = baseArr.length;
    if(baseArrlen <= 1) {
      return function(value) {
        return value.toLowerCase().indexOf(base) !== -1
      }
    }
    return function(value) {
      value = value.toLowerCase();
      var i = 0;
      for(;i < baseArrlen;i++) {
        if(value.indexOf(baseArr[i]) !== -1) {
          return true
        }
      }
      return false
    }
  }}, {name:"containsAll", tag:"&=", comment:function(name, base) {
    return name + " () " + base + "  "
  }, fn:function(base) {
    base = base.toLowerCase();
    var baseArr = Util.split(base), baseArrlen = baseArr.length;
    if(baseArrlen <= 1) {
      return function(value) {
        return value.toLowerCase().indexOf(base) !== -1
      }
    }
    return function(value) {
      value = value.toLowerCase();
      var i = 0;
      for(;i < baseArrlen;i++) {
        if(value.indexOf(baseArr[i]) === -1) {
          return false
        }
      }
      return true
    }
  }}]
})();
})();
